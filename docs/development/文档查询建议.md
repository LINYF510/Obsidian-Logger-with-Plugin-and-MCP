# 📚 项目开发参考文档汇总

你好 LINYF510！这是项目开发过程中的文档查询指南，帮助你快速找到需要的信息。

**更新时间**: 2025-11-05

---

## 🎯 按开发阶段查阅的文档

### 第一阶段：项目启动（现在）

#### 必读文档

| 文档 | 位置 | 用途 | 阅读时间 |
|------|------|------|---------|
| **README.md** | 项目根目录 | 快速了解项目总体情况 | 5 分钟 |
| **开发方案文档** | `docs/Obsidian Logger 项目开发方案.md` | 理解架构、设计理念 | 20 分钟 |
| **开发计划** | `docs/development/DEVELOPMENT_PLAN.md` | 了解时间规划和任务分解 | 15 分钟 |

#### 参考文档

```
Obsidian 官方文档
├─ Obsidian 插件 API 文档
│  ├─ 地址：https://docs.obsidian.md/Plugins/Getting+started/Build+a+plugin
│  ├─ 用途：学习 Plugin 基础 API
│  └─ 重点：App、Vault、PluginSettingTab
│
└─ Obsidian 中文开发文档
   ├─ 地址：https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/
   ├─ 用途：中文版本参考
   └─ 重点：快速入门、API 参考
```

---

### 第二阶段：Global Logger 插件开发

#### 必读文档

| 文档 | 内容 | 优先级 |
|------|------|--------|
| **开发方案 - 全局日志插件部分** | 第 2.1-2.3 节 | ⭐⭐⭐⭐⭐ |
| **TypeScript 基础** | `tsconfig.json` 注释 | ⭐⭐⭐⭐ |
| **.cursorrules** | 项目规则和规范 | ⭐⭐⭐⭐ |

#### 关键设计文档

**在开发方案文档中查阅**：

```
第 2 节：Global Logger 插件开发方案
├─ 2.1 日志拦截模块
│  ├─ Console 劫持原理
│  ├─ 防死循环机制
│  └─ 参数序列化
│
├─ 2.2 日志收集模块
│  ├─ 缓冲区设计
│  ├─ 刷新机制
│  └─ 时间戳格式
│
└─ 2.3 文件管理模块
   ├─ 日志文件路径
   ├─ 批量写入
   ├─ 文件轮转
   └─ 异常处理
```

#### 参考代码示例

**查看位置**：
- `src/logger/console-interceptor.ts` - 拦截器实现
- `src/logger/log-collector.ts` - 收集器实现
- `src/logger/file-manager.ts` - 文件管理实现

---

### 第三阶段：Auto-Reload 模块开发

#### 必读文档

| 文档 | 内容 | 优先级 |
|------|------|--------|
| **Auto-Reload 架构设计** | `docs/architecture/Auto-Reload架构设计.md` | ⭐⭐⭐⭐⭐ |
| **开发方案 - Auto-Reload 部分** | 第 3 节 | ⭐⭐⭐⭐⭐ |
| **性能优化指南** | 开发方案第 5.5 节 | ⭐⭐⭐⭐ |

#### 核心算法和机制

**智能识别算法**（参考架构设计文档）：

```
特征检测系统
├─ 特征 1：Source Map 检测 (权重: 5)
│  └─ 检查是否包含 sourceMappingURL
│
├─ 特征 2：最近修改检测 (权重: 3)
│  └─ 判断文件是否在 24 小时内修改
│
└─ 特征 3：文件大小检测 (权重: 2)
   └─ 判断文件是否大于 50KB

评分阈值：总分 >= 5 即为开发插件
```

**文件监听机制**（参考开发方案 3.3 节）：

```
定时轮询方案
├─ 间隔：1000ms (默认)
├─ 检查：main.js 文件的 mtime
├─ 缓存：lastModifiedTimes Map
└─ 触发：mtime 变化时重载插件
```

#### 参考代码示例

**查看位置**：
- `src/auto-reload/file-watcher.ts` - 文件监听器
- `src/auto-reload/smart-identifier.ts` - 智能识别器
- `src/auto-reload/plugin-reloader.ts` - 插件重载器
- `src/auto-reload/mode-manager.ts` - 模式管理器

---

### 第四阶段：MCP Server 开发

#### 必读文档

| 文档 | 内容 | 优先级 |
|------|------|--------|
| **MCP Tools API 文档** | `docs/api/MCP-Tools-API.md` | ⭐⭐⭐⭐⭐ |
| **开发方案 - MCP Server 部分** | 第 4 节 | ⭐⭐⭐⭐⭐ |
| **MCP 官方文档** | https://modelcontextprotocol.io | ⭐⭐⭐⭐ |

#### MCP Server 工具列表

**6 个日志工具**：

```
日志管理工具
├─ read_logs - 读取日志内容
├─ get_log_summary - 获取统计摘要
├─ get_recent_errors - 获取最近错误
├─ analyze_errors - 深度错误分析
├─ get_log_file_path - 获取日志路径
└─ clear_logs - 清空日志
```

**6 个 Auto-Reload 工具**：

```
Auto-Reload 管理工具
├─ get_auto_reload_status - 获取完整状态
├─ get_auto_reload_mode - 获取当前模式
├─ set_auto_reload_mode - 切换监控模式
├─ manage_watched_plugins - 管理监控列表
├─ trigger_plugin_reload - 手动重载插件
└─ get_reload_statistics - 获取重载统计
```

#### 参考代码示例

**查看位置**：
- `mcp-server/src/mcp_obsidian_logger.py` - 主程序
- `mcp-server/src/cache.py` - 缓存系统
- `mcp-server/src/config_manager.py` - 配置管理
- `mcp-server/src/log_manager.py` - 日志管理

---

## 📖 按问题类型查阅文档

### 问题 1：不知道如何实现某个功能

**查阅步骤**：
1. 先查看 `docs/Obsidian Logger 项目开发方案.md` 对应章节
2. 查看架构设计文档（如有）
3. 参考现有代码实现
4. 查阅 Obsidian 官方文档

**示例**：

```
问题：如何拦截 console.log？
↓
查阅：开发方案 2.1 节 "日志拦截模块"
↓
了解：函数劫持原理
↓
参考：src/logger/console-interceptor.ts 实现
↓
解决：编写自己的拦截器代码
```

---

### 问题 2：不确定性能是否达标

**查阅步骤**：
1. 查看开发方案第 5 节 "性能要求"
2. 查看性能测试指南
3. 使用开发者工具进行性能分析

**性能指标（开发方案 5.1 节）**：

```
硬性指标
├─ CPU 占用：< 5%
├─ 内存占用：< 60MB
├─ 响应时间：< 500ms
├─ 日志写入延迟：< 100ms
└─ 可用性：99.9%
```

---

### 问题 3：代码规范不确定

**查阅文档**：
- `.cursorrules` - 完整的代码规范
- `docs/development/文档管理规范.md` - 文档规范

**快速参考**：

```
TypeScript 规范
├─ 变量/函数：camelCase
├─ 类名：PascalCase
├─ 常量：UPPER_SNAKE_CASE
├─ 私有方法：_prefix
└─ 文件名：kebab-case

Python 规范
├─ 变量/函数：snake_case
├─ 类名：PascalCase
├─ 常量：UPPER_SNAKE_CASE
├─ 私有方法：_prefix
└─ 遵循 PEP 8
```

---

### 问题 4：不知道测试怎么写

**查阅步骤**：
1. 查看 `docs/testing/单元测试指南.md`
2. 参考现有测试用例
3. 查看测试覆盖率要求

**测试文件位置**：
- `global-logger/src/**/__tests__/*.test.ts` - TypeScript 测试
- `mcp-server/tests/test_*.py` - Python 测试

**测试覆盖率要求**：> 80%

---

## 🔧 开发工具和环境

### 推荐工具

| 工具 | 用途 | 文档 |
|------|------|------|
| **Cursor IDE** | 主要开发环境 | 内置 AI 助手 |
| **Obsidian** | 测试环境 | https://obsidian.md |
| **Chrome DevTools** | 调试工具 | Cmd/Ctrl+Shift+I |
| **Git** | 版本控制 | - |

### 环境要求

**参考文档**：`DEVELOPMENT.md` 或开发计划第 1.1 节

```
必需环境
├─ Node.js 16+
├─ Python 3.10+
├─ Obsidian 0.13.0+
└─ Git

可选工具
├─ Cursor IDE（推荐）
├─ VSCode
└─ Postman（测试 MCP）
```

---

## 📝 常见开发流程

### 流程 1：添加新功能

```
1. 查阅开发方案，确认功能设计
   ↓
2. 在对应模块创建文件
   ↓
3. 编写代码，参考现有实现
   ↓
4. 编写单元测试
   ↓
5. 运行测试，确保通过
   ↓
6. 更新文档（如需要）
   ↓
7. 提交代码
```

### 流程 2：修复 Bug

```
1. 复现问题，记录日志
   ↓
2. 查看相关代码和文档
   ↓
3. 定位问题根源
   ↓
4. 修复代码
   ↓
5. 编写测试用例（防止回归）
   ↓
6. 验证修复
   ↓
7. 提交代码
```

### 流程 3：优化性能

```
1. 使用开发者工具分析性能
   ↓
2. 查看性能优化建议（开发方案 5.5 节）
   ↓
3. 实施优化
   ↓
4. 测试验证效果
   ↓
5. 确认不引入新问题
   ↓
6. 提交代码
```

---

## 🎓 学习资源

### Obsidian 插件开发

**官方资源**：
- [Obsidian Plugin API](https://github.com/obsidianmd/obsidian-api)
- [Sample Plugin](https://github.com/obsidianmd/obsidian-sample-plugin)
- [Plugin Developer Docs](https://docs.obsidian.md/Plugins)

**社区资源**：
- [Obsidian 中文开发文档](https://luhaifeng666.github.io/obsidian-plugin-docs-zh/)
- [Obsidian 论坛](https://forum.obsidian.md/c/developers-co-op/14)

### TypeScript

**推荐资源**：
- [TypeScript 官方文档](https://www.typescriptlang.org/)
- [TypeScript 深入理解](https://basarat.gitbook.io/typescript/)

### Python & MCP

**推荐资源**：
- [MCP 官方文档](https://modelcontextprotocol.io)
- [Python asyncio 文档](https://docs.python.org/3/library/asyncio.html)

---

## 💡 开发技巧

### 技巧 1：充分利用 Cursor AI

```
在 Cursor 中使用：
- @docs 引用项目文档
- @codebase 搜索代码
- 询问具体实现问题
- 请求代码审查
```

### 技巧 2：保持文档同步

```
每次修改代码时：
1. 检查是否需要更新文档
2. 如创建新文件，更新目录结构文档
3. 如修改 API，更新 API 文档
```

### 技巧 3：善用日志调试

```
开发时：
- 使用 console.log 输出关键信息
- 查看 Obsidian 控制台（Cmd/Ctrl+Shift+I）
- 使用日志模块记录详细信息
```

---

## 🔍 快速查找表

| 我想... | 应该查看... |
|---------|------------|
| 了解项目整体架构 | `docs/Obsidian Logger 项目开发方案.md` |
| 了解 Auto-Reload 设计 | `docs/architecture/Auto-Reload架构设计.md` |
| 查看开发时间规划 | `docs/development/DEVELOPMENT_PLAN.md` |
| 了解 MCP 工具 API | `docs/api/MCP-Tools-API.md` |
| 学习代码规范 | `.cursorrules` |
| 学习文档规范 | `docs/development/文档管理规范.md` |
| 快速开始开发 | `README.md` + `DEVELOPMENT.md` |
| 编写测试 | `docs/testing/单元测试指南.md` |
| 排查问题 | `docs/testing/Auto-Reload故障排查.md` |

---

## ✅ 文档更新检查清单

在修改代码后，检查是否需要更新：

- [ ] 功能文档（如果添加/修改功能）
- [ ] API 文档（如果修改接口）
- [ ] 架构文档（如果修改架构）
- [ ] 目录结构文档（如果创建/删除文件）
- [ ] README（如果影响用户使用）
- [ ] CHANGELOG（如果是重要变更）

---

**文档版本**: v1.0  
**最后更新**: 2025-11-05  
**维护者**: LINYF510

💡 **提示**：遇到问题时，优先查阅项目文档。如文档不清楚或有遗漏，请及时反馈！
