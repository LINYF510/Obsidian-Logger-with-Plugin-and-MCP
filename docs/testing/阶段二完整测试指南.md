# 阶段二完整测试指南

**测试日期**: 2025-11-02  
**测试范围**: 阶段二所有功能  
**预计时间**: 20-30 分钟

---

## 📋 测试准备

### 前提条件

1. ✅ 代码已编译（main.js 76.5 KB）
2. ✅ 插件已通过符号链接安装
3. ⏳ Obsidian 需要重新加载插件

### 重新加载插件

**方式 1**: 禁用再启用
```
设置 → 第三方插件 → Obsidian Cursor Logger
→ 关闭 → 等待1秒 → 开启
```

**方式 2**: 控制台命令
```javascript
await app.plugins.disablePlugin('obsidian-cursor-logger');
await new Promise(r => setTimeout(r, 100));
await app.plugins.enablePlugin('obsidian-cursor-logger');
```

---

## ✅ 基础功能测试（5分钟）

### 测试 1：设置页面可以打开

1. 打开设置 → 第三方插件
2. 找到 Obsidian Cursor Logger
3. 点击设置图标

**预期**: 设置页面正常打开，显示所有配置区域

**验收点**:
- [ ] 页面正常渲染
- [ ] 显示日志模块设置
- [ ] 显示 Auto-Reload 模块设置
- [ ] 显示运行状态
- [ ] 显示高级选项

### 测试 2：日志统计命令

1. 按 `Ctrl+P` 打开命令面板
2. 搜索 "日志统计"
3. 执行 `📊 显示日志统计`

**预期**: 显示统计通知，包含文件大小、行数、错误数等

**验收点**:
- [ ] 通知正常显示
- [ ] 统计信息准确
- [ ] 格式清晰易读

### 测试 3：Auto-Reload 状态命令

1. 打开命令面板
2. 执行 `🤖 显示 Auto-Reload 状态`

**预期**: 显示当前监控模式、插件数量、监控列表

**验收点**:
- [ ] 状态信息正确
- [ ] 监控列表准确

---

## 🎯 文件类型配置测试（10分钟）

### 测试 4：全局文件类型配置

#### 4.1 测试 manifest.json 监控

**步骤**:
1. 打开设置页面
2. 确认 manifest.json 已勾选
3. 修改 test-reload/manifest.json（改版本号）
4. 保存
5. 等待 1-2 秒

**预期**:
```
[Auto-Reload] 🔄 检测到文件变化: test-reload (manifest.json)
[Auto-Reload] ✅ 插件已重载: test-reload
```

**验收点**:
- [ ] 检测到 manifest.json 变化
- [ ] 自动触发重载

#### 4.2 测试取消 manifest.json 监控

**步骤**:
1. 打开设置页面
2. 取消勾选 manifest.json
3. 修改 test-reload/manifest.json
4. 保存
5. 等待 2 秒

**预期**: 不触发重载

**验收点**:
- [ ] 没有检测到变化
- [ ] 没有重载日志

#### 4.3 测试自定义文件

**步骤**:
1. 创建 `test-reload/data.json`，内容：`{"version": 1}`
2. 在设置页面的"自定义文件"中添加：`data.json`
3. 修改 data.json 的内容
4. 保存
5. 等待 1-2 秒

**预期**:
```
[Auto-Reload] 🔄 检测到文件变化: test-reload (data.json)
[Auto-Reload] ✅ 插件已重载: test-reload
```

**验收点**:
- [ ] 检测到自定义文件变化
- [ ] 自动触发重载

### 测试 5：通配符匹配

#### 5.1 测试 *.json 通配符

**步骤**:
1. 在自定义文件中添加：`*.json`
2. 创建 `test-reload/config.json`
3. 修改 config.json
4. 保存

**预期**: 检测到 config.json 变化并重载

**验收点**:
- [ ] 通配符匹配成功
- [ ] 自动重载

#### 5.2 测试目录通配符

**步骤**:
1. 创建 `test-reload/lang/` 目录
2. 创建 `test-reload/lang/en.json`
3. 在自定义文件中添加：`lang/*.json`
4. 修改 lang/en.json
5. 保存

**预期**: 检测到 lang/en.json 变化并重载

**验收点**:
- [ ] 目录通配符匹配成功
- [ ] 自动重载

### 测试 6：插件特定配置

**步骤**:
1. 切换到"插件特定配置"模式
2. 为 test-reload 启用特定配置
3. 取消勾选 manifest.json
4. 添加自定义文件：`mydata.json`
5. 创建 `test-reload/mydata.json`
6. 修改并保存

**预期**:
- mydata.json 变化触发重载
- manifest.json 变化不触发重载（因为被取消）

**验收点**:
- [ ] 插件特定配置生效
- [ ] 覆盖全局配置

---

## 🔧 命令面板测试（5分钟）

### 测试 7：所有新命令

#### 7.1 打开日志文件夹
```
命令: 📂 打开日志文件夹
```
**预期**: 文件管理器打开日志目录

#### 7.2 显示日志统计
```
命令: 📊 显示日志统计
```
**预期**: 显示统计通知

#### 7.3 显示 Auto-Reload 状态
```
命令: 🤖 显示 Auto-Reload 状态
```
**预期**: 显示状态通知

#### 7.4 模式切换命令
```
命令: 🧠 切换到智能监控模式
命令: 🤖 切换到自动监控模式
命令: ✋ 切换到手动监控模式
```
**预期**: 模式切换，监控列表更新

#### 7.5 刷新监控列表
```
命令: 🔄 刷新监控列表
```
**预期**: 重新获取监控列表

**验收点**:
- [ ] 所有命令都能执行
- [ ] 无错误
- [ ] 功能正常

---

## 📊 状态显示测试（5分钟）

### 测试 8：实时状态更新

**步骤**:
1. 打开设置页面
2. 查看运行状态区域
3. 触发几次插件重载
4. 刷新设置页面（关闭再打开）

**预期**:
- 日志统计更新
- 重载统计更新
- 今日重载次数增加

**验收点**:
- [ ] 状态信息准确
- [ ] 统计数字正确
- [ ] 更新及时

---

## 🧪 边界情况测试（5分钟）

### 测试 9：无效通配符

**步骤**:
1. 在自定义文件中添加：`[invalid`
2. 保存配置
3. 观察是否有错误

**预期**: 不匹配任何文件，不报错

### 测试 10：不存在的文件

**步骤**:
1. 在自定义文件中添加：`nonexistent.json`
2. 保存配置

**预期**: 不报错，只是不触发重载（因为文件不存在）

### 测试 11：快速连续修改

**步骤**:
1. 快速连续修改 3-4 个不同文件
2. 观察重载行为

**预期**: 合并为一次重载，或短时间内多次重载

---

## 📈 性能测试（5分钟）

### 测试 12：CPU 占用

**步骤**:
1. 打开任务管理器
2. 观察 Obsidian CPU 占用
3. 运行 10 分钟

**目标**: CPU < 5%

### 测试 13：内存占用

**步骤**:
1. 记录启动时内存
2. 运行 30 分钟，触发多次重载
3. 记录当前内存

**目标**: 内存增长 < 20MB

### 测试 14：设置页面性能

**步骤**:
1. 打开设置页面
2. 观察渲染时间
3. 切换模式观察响应速度

**目标**: 无明显卡顿，响应 < 500ms

---

## ✅ 完整验收清单

### 核心功能
- [ ] 日志收集正常工作
- [ ] Auto-Reload 正常工作
- [ ] 设置页面可以打开
- [ ] 所有配置项可以修改

### 文件类型功能
- [ ] main.js 监控工作
- [ ] manifest.json 监控工作
- [ ] styles.css 监控工作
- [ ] 自定义文件监控工作
- [ ] 通配符匹配正确
- [ ] 全局配置工作
- [ ] 插件特定配置工作

### 用户界面
- [ ] 设置界面渲染正常
- [ ] 模式切换立即生效
- [ ] 插件列表正确显示
- [ ] 状态实时更新
- [ ] 统计信息准确
- [ ] 快捷按钮工作

### 命令面板
- [ ] 10 个命令都显示
- [ ] 所有命令都能执行
- [ ] 无错误

### 性能指标
- [ ] CPU 占用 < 5%
- [ ] 内存占用合理
- [ ] 无明显卡顿
- [ ] 长时间运行稳定

---

## 🎉 测试完成后

如果所有测试通过，恭喜！🎊

**阶段二已完全完成**！

您现在拥有：
- ✅ 完整的日志收集系统
- ✅ 智能自动重载系统
- ✅ 可视化配置界面
- ✅ 灵活的文件类型配置
- ✅ 通配符支持
- ✅ 完整的统计功能
- ✅ 10 倍开发效率提升

### 下一步

可以：
1. 开始**阶段三**：MCP Server 开发
2. 或继续优化和完善
3. 或开始实际项目开发

---

**维护者**: LINYF510  
**测试日期**: 2025-11-02

