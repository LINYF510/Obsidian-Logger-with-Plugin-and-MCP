# ğŸ“‹ Obsidian Logger é¡¹ç›®å¼€å‘æ–¹æ¡ˆï¼ˆå®Œæ•´ç‰ˆï¼‰

**é¡¹ç›®å¯åŠ¨æ—¥æœŸ**: 2025-11-01  
**é¡¹ç›®è´Ÿè´£äºº**: LINYF510  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0 å®Œæ•´ç‰ˆ  
**æœ€åæ›´æ–°**: 2025-11-02

---

## ğŸ“‘ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [å…¨å±€æ—¥å¿—æ’ä»¶å¼€å‘æ–¹æ¡ˆ](#å…¨å±€æ—¥å¿—æ’ä»¶å¼€å‘æ–¹æ¡ˆ)
3. [Auto-Reload æ¨¡å—å¼€å‘æ–¹æ¡ˆ](#auto-reload-æ¨¡å—å¼€å‘æ–¹æ¡ˆ)
4. [MCP æœåŠ¡å™¨å¼€å‘æ–¹æ¡ˆ](#mcp-æœåŠ¡å™¨å¼€å‘æ–¹æ¡ˆ)
5. [ç³»ç»Ÿæ¶æ„ä¸äº¤äº’è®¾è®¡](#ç³»ç»Ÿæ¶æ„ä¸äº¤äº’è®¾è®¡)
6. [æŠ€æœ¯å®ç°ç»†èŠ‚](#æŠ€æœ¯å®ç°ç»†èŠ‚)
7. [è¿­ä»£è®¡åˆ’ä¸ç‰ˆæœ¬è§„åˆ’](#è¿­ä»£è®¡åˆ’ä¸ç‰ˆæœ¬è§„åˆ’)
8. [è´¨é‡ä¿è¯ä¸æµ‹è¯•](#è´¨é‡ä¿è¯ä¸æµ‹è¯•)
9. [éƒ¨ç½²ä¸è¿ç»´](#éƒ¨ç½²ä¸è¿ç»´)
10. [é™„å½•](#é™„å½•)

---

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®æ„¿æ™¯

ä¸º Obsidian æ’ä»¶å¼€å‘è€…æä¾›ä¸€å¥—**å®Œæ•´ã€è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–çš„è°ƒè¯•è§£å†³æ–¹æ¡ˆ**ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿï¼š

- ğŸ¯ **ä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…æœ‰æ•ˆ** - å®‰è£…åè‡ªåŠ¨ä¸ºæ‰€æœ‰æ’ä»¶å·¥ä½œï¼Œæ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç 
- ğŸ”„ **å®æ—¶ç›‘æ§æ—¥å¿—** - æ‰€æœ‰ console è¾“å‡ºè‡ªåŠ¨é›†ä¸­æ”¶é›†å’Œæ˜¾ç¤ºï¼Œæ”¯æŒå¤šç§æ ¼å¼
- ğŸ¤– **AI æ™ºèƒ½åˆ†æ** - é€šè¿‡ MCP åè®®é›†æˆ Cursor AIï¼Œè¿›è¡Œè‡ªåŠ¨åŒ–é”™è¯¯åˆ†æå’Œä¿®å¤å»ºè®®
- âš¡ **æè‡´æ•ˆç‡** - å‡å°‘ 80% ä»¥ä¸Šçš„è°ƒè¯•æ—¶é—´ï¼Œæå‡ 5-10 å€å¼€å‘æ•ˆç‡
- ğŸ”§ **æ™ºèƒ½è‡ªåŠ¨é‡è½½** - ä¿®æ”¹ä»£ç åè‡ªåŠ¨é‡è½½æ’ä»¶ï¼ŒçœŸæ­£çš„"ä¿å­˜å³ç”Ÿæ•ˆ"
- ğŸ¨ **å¯è§†åŒ–é…ç½®** - å®Œæ•´çš„è®¾ç½®ç•Œé¢ï¼Œæ‰€æœ‰åŠŸèƒ½å¯è§†åŒ–ç®¡ç†

### é¡¹ç›®ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**:

1. âœ… **å¼€å‘ Obsidian Logger æ’ä»¶**
   - å®ç°å…¨å±€æ—¥å¿—æ”¶é›†ï¼ˆé›¶ä¾µå…¥ï¼‰
   - å®ç°æ™ºèƒ½è‡ªåŠ¨é‡è½½ï¼ˆä¸‰ç§æ¨¡å¼ï¼‰
   - æä¾›å®Œæ•´çš„å¯è§†åŒ–é…ç½®ç•Œé¢
   - æ”¯æŒæ–‡ä»¶ç±»å‹è‡ªå®šä¹‰å’Œé€šé…ç¬¦

2. âœ… **å¼€å‘ MCP Server**
   - æä¾› 12 ä¸ªä¸“ä¸šå·¥å…·æ¥å£
   - æ”¯æŒæ—¥å¿—åˆ†æå’Œç®¡ç†
   - æ”¯æŒ Auto-Reload è¿œç¨‹æ§åˆ¶
   - å®ç°å®æ—¶æ–‡ä»¶ç›‘å¬

3. âœ… **å®Œæ•´é›†æˆ Cursor IDE**
   - æ”¯æŒ @obsidian-logger è°ƒç”¨
   - AI æ™ºèƒ½åˆ†æé”™è¯¯
   - æä¾›ä¿®å¤å»ºè®®
   - è‡ªåŠ¨åŒ–å·¥ä½œæµ

4. âœ… **æä¾›å®Œå–„æ–‡æ¡£**
   - ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ
   - å¼€å‘è€…æ–‡æ¡£
   - API å‚è€ƒæ–‡æ¡£
   - è§†é¢‘æ•™ç¨‹ï¼ˆè®¡åˆ’ä¸­ï¼‰

5. âœ… **è·¨å¹³å°æ”¯æŒ**
   - Windows å®Œæ•´æ”¯æŒ
   - macOS å®Œæ•´æ”¯æŒ
   - Linux å®Œæ•´æ”¯æŒ
   - ç§»åŠ¨ç«¯å®éªŒæ€§æ”¯æŒï¼ˆAuto-Reload é™æ¡Œé¢ç«¯ï¼‰

**å•†ä¸šç›®æ ‡**:
- æé«˜ Obsidian æ’ä»¶å¼€å‘æ•ˆç‡ 5-10 å€ï¼ˆè‡ªåŠ¨é‡è½½ + æ™ºèƒ½æ—¥å¿—åˆ†æï¼‰
- é™ä½å¼€å‘è€…å­¦ä¹ æ›²çº¿ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹
- å»ºç«‹å¼€æºç”Ÿæ€ï¼Œå¸å¼•ç¤¾åŒºè´¡çŒ®å’Œåé¦ˆ
- æˆä¸º Obsidian æ’ä»¶å¼€å‘çš„æ ‡å‡†è°ƒè¯•å·¥å…·

**æŠ€æœ¯ç›®æ ‡**:
- CPU å ç”¨ < 5%
- å†…å­˜å ç”¨ < 100MB
- å“åº”æ—¶é—´ < 500ms
- å¯ç”¨æ€§ 99.9%
- å‘åå…¼å®¹ Obsidian 0.13.0+

### ç”¨æˆ·ç”»åƒ

| ç”¨æˆ·ç±»å‹ | æ ¸å¿ƒéœ€æ±‚ | ä¸»è¦ç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ |
|---------|---------|---------|---------|
| **ä¸ªäººç‹¬ç«‹å¼€å‘è€…** | å¿«é€Ÿè°ƒè¯•ã€æ•ˆç‡ä¼˜åŒ–ã€é™ä½æ—¶é—´æˆæœ¬ | æ‰‹åŠ¨ç®¡ç†æ—¥å¿—ç¹çã€é¢‘ç¹æ‰‹åŠ¨é‡è½½æ’ä»¶ã€æ—¥å¿—åˆ†æ•£éš¾ä»¥è¿½è¸ª | è‡ªåŠ¨æ—¥å¿—æ”¶é›† + æ™ºèƒ½é‡è½½ + ç»Ÿä¸€ç®¡ç† |
| **å›¢é˜Ÿåä½œå¼€å‘è€…** | åä½œå¼€å‘ã€å…±äº«æ—¥å¿—ã€ç»Ÿä¸€å·¥å…·é“¾ | æ—¥å¿—åˆ†æ•£åœ¨ä¸åŒæœºå™¨ã€è°ƒè¯•ç¯å¢ƒä¸ä¸€è‡´ã€éš¾ä»¥å¤ç°é—®é¢˜ | ç»Ÿä¸€æ—¥å¿—æ ¼å¼ + äº‘ç«¯åŒæ­¥ï¼ˆv1.2ï¼‰ + å›¢é˜Ÿé…ç½® |
| **æ–°æ‰‹å­¦ä¹ è€…** | å­¦ä¹ èµ„æºã€æ˜“ç”¨æ€§ã€å¿«é€Ÿä¸Šæ‰‹ | ä¸äº†è§£è°ƒè¯•å·¥å…·ã€ä¸çŸ¥é“å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ã€é…ç½®å¤æ‚ | é›¶é…ç½®å®‰è£… + å¯è§†åŒ–ç•Œé¢ + è¯¦ç»†æ–‡æ¡£ |
| **é«˜çº§ä¸“ä¸šå¼€å‘è€…** | è‡ªå®šä¹‰æ‰©å±•ã€æ·±åº¦åˆ†æã€æ€§èƒ½ä¼˜åŒ– | ç°æœ‰å·¥å…·åŠŸèƒ½å—é™ã€æ— æ³•ç²¾ç¡®æ§åˆ¶ã€ç¼ºå°‘é«˜çº§åˆ†æ | çµæ´»é…ç½® + é€šé…ç¬¦æ”¯æŒ + MCP å·¥å…·é›† + AI åˆ†æ |
| **æ’ä»¶ç»´æŠ¤è€…** | é•¿æœŸç»´æŠ¤ã€é—®é¢˜è¿½è¸ªã€ç”¨æˆ·åé¦ˆ | ç”¨æˆ·æŠ¥å‘Šé—®é¢˜éš¾ä»¥å¤ç°ã€æ—¥å¿—ä¿¡æ¯ä¸è¶³ã€è°ƒè¯•å›°éš¾ | å®Œæ•´æ—¥å¿—è¿½è¸ª + è¿œç¨‹è¯Šæ–­ + ç»Ÿè®¡åˆ†æ |

### æ ¸å¿ƒç«äº‰åŠ›

#### ä¸ç°æœ‰æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | Hot Reload æ’ä»¶ | Obsidian Logger | ä¼˜åŠ¿ |
|------|----------------|-----------------|------|
| **è‡ªåŠ¨é‡è½½** | âœ… åŸºäº .hotreload æ–‡ä»¶ | âœ… æ™ºèƒ½è¯†åˆ« + 3ç§æ¨¡å¼ | æ›´æ™ºèƒ½ã€æ›´çµæ´» |
| **æ—¥å¿—æ”¶é›†** | âŒ æ—  | âœ… å…¨å±€æ‹¦æˆª | é›¶ä¾µå…¥ã€è‡ªåŠ¨æ”¶é›† |
| **AI åˆ†æ** | âŒ æ—  | âœ… MCP é›†æˆ | æ™ºèƒ½è¯Šæ–­ |
| **å¯è§†åŒ–é…ç½®** | âŒ æ—  | âœ… å®Œæ•´è®¾ç½®ç•Œé¢ | æ˜“ç”¨æ€§å¼º |
| **å¤šæ–‡ä»¶ç›‘æ§** | âœ… main.js only | âœ… æ”¯æŒé€šé…ç¬¦ | æ›´å…¨é¢ |
| **è·¨å¹³å°** | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | å…¼å®¹æ€§å¥½ |
| **æ€§èƒ½** | âœ… è½»é‡ | âœ… ä¼˜åŒ–è‰¯å¥½ | ä¸å½±å“ä½¿ç”¨ |

**æ ¸å¿ƒä¼˜åŠ¿**:
1. **äºŒåˆä¸€è§£å†³æ–¹æ¡ˆ** - æ—¥å¿— + é‡è½½ï¼Œä¸€ä¸ªæ’ä»¶æå®š
2. **AI é©±åŠ¨** - é›†æˆ Cursor AIï¼Œæ™ºèƒ½åˆ†æå’Œå»ºè®®
3. **é›¶é…ç½®å¯åŠ¨** - å®‰è£…å³ç”¨ï¼Œå¼€ç®±å³ç”¨
4. **ä¸“ä¸šçº§åŠŸèƒ½** - æ»¡è¶³ä»æ–°æ‰‹åˆ°ä¸“å®¶çš„æ‰€æœ‰éœ€æ±‚

### é¡¹ç›®èŒƒå›´

**åŒ…å«çš„åŠŸèƒ½**:
- âœ… å…¨å±€ console æ‹¦æˆªå’Œæ—¥å¿—æ”¶é›†
- âœ… æ™ºèƒ½è‡ªåŠ¨é‡è½½ï¼ˆAuto-Reloadï¼‰
- âœ… å®Œæ•´çš„å¯è§†åŒ–è®¾ç½®ç•Œé¢
- âœ… 10 ä¸ªå‘½ä»¤é¢æ¿å‘½ä»¤
- âœ… 12 ä¸ª MCP å·¥å…·æ¥å£
- âœ… æ–‡ä»¶ç±»å‹è‡ªå®šä¹‰å’Œé€šé…ç¬¦æ”¯æŒ
- âœ… å…¨å±€å’Œæ’ä»¶ç‰¹å®šé…ç½®
- âœ… æ—¥å¿—ç»Ÿè®¡å’Œé‡è½½ç»Ÿè®¡
- âœ… å®æ—¶çŠ¶æ€ç›‘æ§
- âœ… é…ç½®å¯¼å‡º/å¯¼å…¥ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

**ä¸åŒ…å«çš„åŠŸèƒ½**ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰:
- âŒ äº‘ç«¯æ—¥å¿—åŒæ­¥ï¼ˆv1.2è®¡åˆ’ï¼‰
- âŒ Web UI ä»ªè¡¨æ¿ï¼ˆv1.2è®¡åˆ’ï¼‰
- âŒ è‡ªåŠ¨ä»£ç ä¿®å¤ï¼ˆv2.0è®¡åˆ’ï¼‰
- âŒ é¢„æµ‹æ€§å‘Šè­¦ï¼ˆv2.0è®¡åˆ’ï¼‰
- âŒ ç§»åŠ¨ç«¯ Auto-Reloadï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼‰

---

## å…¨å±€æ—¥å¿—æ’ä»¶å¼€å‘æ–¹æ¡ˆ

### 1. æ’ä»¶è®¾è®¡åŸåˆ™

#### 1.1 æ ¸å¿ƒè®¾è®¡åŸåˆ™

**åŸåˆ™ 1ï¼šé›¶ä¾µå…¥åŸåˆ™ï¼ˆZero-Intrusion Principleï¼‰**

è®¾è®¡ç†å¿µï¼š
```
é›¶ä¾µå…¥ = é›¶ä¿®æ”¹ + é›¶é…ç½® + é›¶å­¦ä¹ æˆæœ¬

é›¶ä¿®æ”¹ï¼š
â”œâ”€ ä¸ä¿®æ”¹ä»»ä½•ç°æœ‰æ’ä»¶çš„æºä»£ç 
â”œâ”€ ä¸ä¿®æ”¹ä»»ä½• Obsidian æ ¸å¿ƒä»£ç 
â”œâ”€ ä¸ä¿®æ”¹ä»»ä½•ç¬¬ä¸‰æ–¹åº“
â”œâ”€ ä¸ä¿®æ”¹ä»»ä½•é…ç½®æ–‡ä»¶ï¼ˆé™¤äº†å®‰è£…æ’ä»¶æœ¬èº«ï¼‰
â””â”€ å®Œå…¨é€æ˜ï¼Œå¯¹å…¶ä»–æ’ä»¶ä¸å¯è§

é›¶é…ç½®ï¼š
â”œâ”€ å®‰è£…åè‡ªåŠ¨å¯åŠ¨
â”œâ”€ è‡ªåŠ¨è¯†åˆ«å¼€å‘æ’ä»¶
â”œâ”€ è‡ªåŠ¨é€‰æ‹©æœ€ä½³é…ç½®
â”œâ”€ æ™ºèƒ½é»˜è®¤å€¼
â””â”€ é«˜çº§ç”¨æˆ·å¯è‡ªå®šä¹‰

é›¶å­¦ä¹ æˆæœ¬ï¼š
â”œâ”€ ç›´è§‚çš„ç”¨æˆ·ç•Œé¢
â”œâ”€ æ¸…æ™°çš„æç¤ºä¿¡æ¯
â”œâ”€ è¯¦ç»†çš„æ–‡æ¡£
â”œâ”€ ä¸°å¯Œçš„ç¤ºä¾‹
â””â”€ å³æ’å³ç”¨
```

å®ç°æ–¹å¼ï¼š
```
æŠ€æœ¯å®ç°ï¼š
1. å‡½æ•°åŠ«æŒï¼ˆFunction Hijackingï¼‰
   - ä¿å­˜åŸå§‹ console å¯¹è±¡å¼•ç”¨
   - åˆ›å»ºåŒ…è£…å‡½æ•°
   - æ›¿æ¢å…¨å±€ console
   - è°ƒç”¨åŸå§‹ + è®°å½•æ—¥å¿—

2. è‡ªåŠ¨å¯åŠ¨
   - æ’ä»¶åŠ è½½æ—¶è‡ªåŠ¨åˆå§‹åŒ–
   - ä¸éœ€è¦æ‰‹åŠ¨æ¿€æ´»
   - é™é»˜è¿è¡Œ

3. æ™ºèƒ½é»˜è®¤
   - æ™ºèƒ½è¯†åˆ«å¼€å‘æ’ä»¶
   - è‡ªåŠ¨é€‰æ‹©ç›‘æ§æ–‡ä»¶
   - åˆç†çš„æ€§èƒ½å‚æ•°
```

**åŸåˆ™ 2ï¼šè‡ªåŠ¨åŒ–åŸåˆ™ï¼ˆAutomation Principleï¼‰**

è®¾è®¡ç†å¿µï¼š
```
è‡ªåŠ¨åŒ– = è‡ªåŠ¨é‡‡é›† + è‡ªåŠ¨å¤„ç† + è‡ªåŠ¨ç®¡ç†

è‡ªåŠ¨é‡‡é›†ï¼š
â”œâ”€ è‡ªåŠ¨æ‹¦æˆªæ‰€æœ‰ console è¾“å‡º
â”œâ”€ è‡ªåŠ¨æ•è·é”™è¯¯å †æ ˆ
â”œâ”€ è‡ªåŠ¨è®°å½•æ—¶é—´æˆ³
â”œâ”€ è‡ªåŠ¨æå–ä¸Šä¸‹æ–‡
â””â”€ è‡ªåŠ¨åˆ†ç±»çº§åˆ«

è‡ªåŠ¨å¤„ç†ï¼š
â”œâ”€ è‡ªåŠ¨æ ¼å¼åŒ–æ—¥å¿—
â”œâ”€ è‡ªåŠ¨åºåˆ—åŒ–å¯¹è±¡
â”œâ”€ è‡ªåŠ¨å¤„ç†å¾ªç¯å¼•ç”¨
â”œâ”€ è‡ªåŠ¨å¤„ç†ç‰¹æ®Šç±»å‹
â””â”€ è‡ªåŠ¨è¿‡æ»¤æ•æ„Ÿä¿¡æ¯

è‡ªåŠ¨ç®¡ç†ï¼š
â”œâ”€ è‡ªåŠ¨åˆ›å»ºæ—¥å¿—ç›®å½•
â”œâ”€ è‡ªåŠ¨è½®è½¬å¤§æ–‡ä»¶
â”œâ”€ è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ—¥å¿—
â”œâ”€ è‡ªåŠ¨å¤‡ä»½é‡è¦æ•°æ®
â””â”€ è‡ªåŠ¨æ¢å¤å¼‚å¸¸çŠ¶æ€
```

**åŸåˆ™ 3ï¼šæ€§èƒ½ä¼˜å…ˆåŸåˆ™ï¼ˆPerformance-First Principleï¼‰**

è®¾è®¡ç†å¿µï¼š
```
æ€§èƒ½ä¼˜å…ˆ = å¼‚æ­¥ä¼˜å…ˆ + æ‰¹é‡ä¼˜å…ˆ + ç¼“å­˜ä¼˜å…ˆ

å¼‚æ­¥ä¼˜å…ˆï¼š
â”œâ”€ æ‰€æœ‰ I/O æ“ä½œå¼‚æ­¥æ‰§è¡Œ
â”œâ”€ ä¸é˜»å¡ä¸»çº¿ç¨‹
â”œâ”€ ä½¿ç”¨ setTimeout/setInterval
â”œâ”€ é¿å…åŒæ­¥æ–‡ä»¶æ“ä½œ
â””â”€ å“åº”å¼ç¼–ç¨‹

æ‰¹é‡ä¼˜å…ˆï¼š
â”œâ”€ æ—¥å¿—æ‰¹é‡å†™å…¥ï¼ˆ100æ¡æˆ–500msï¼‰
â”œâ”€ å‡å°‘ I/O æ¬¡æ•° 95%+
â”œâ”€ æå‡æ•´ä½“ååé‡
â”œâ”€ é™ä½ç³»ç»Ÿå¼€é”€
â””â”€ æ€§èƒ½æå‡ 100 å€

ç¼“å­˜ä¼˜å…ˆï¼š
â”œâ”€ å†…å­˜ç¼“å­˜çƒ­æ•°æ®
â”œâ”€ é¿å…é‡å¤è®¡ç®—
â”œâ”€ å‡å°‘æ–‡ä»¶è¯»å–
â”œâ”€ æå‡å“åº”é€Ÿåº¦
â””â”€ å®šæœŸå¤±æ•ˆæ›´æ–°
```

æ€§èƒ½ç›®æ ‡ï¼š
```
ç¡¬æ€§æŒ‡æ ‡ï¼š
â”œâ”€ CPU å ç”¨ï¼š< 5%ï¼ˆå³°å€¼ < 10%ï¼‰
â”œâ”€ å†…å­˜å ç”¨ï¼š< 100MBï¼ˆå³°å€¼ < 150MBï¼‰
â”œâ”€ æ—¥å¿—å»¶è¿Ÿï¼š< 100msï¼ˆä» console åˆ°æ–‡ä»¶ï¼‰
â”œâ”€ å·¥å…·å“åº”ï¼š< 500msï¼ˆMCP å·¥å…·è°ƒç”¨ï¼‰
â””â”€ å¯ç”¨æ€§ï¼š99.9%ï¼ˆæ•…éšœæ—¶é—´ < 1å°æ—¶/æœˆï¼‰

è½¯æ€§æŒ‡æ ‡ï¼š
â”œâ”€ å¯åŠ¨æ—¶é—´ï¼š< 1ç§’
â”œâ”€ æ–‡ä»¶è½®è½¬ï¼š< 10ms
â”œâ”€ ç¼“å­˜å‘½ä¸­ç‡ï¼š> 90%
â”œâ”€ å¹¶å‘å¤„ç†ï¼š> 100 req/s
â””â”€ å†…å­˜æ³„æ¼ï¼š0
```

**åŸåˆ™ 4ï¼šå¯è§‚æµ‹åŸåˆ™ï¼ˆObservability Principleï¼‰**

è®¾è®¡ç†å¿µï¼š
```
å¯è§‚æµ‹ = å¯è§ + å¯è¿½è¸ª + å¯åˆ†æ

å¯è§æ€§ï¼š
â”œâ”€ æ¸…æ™°çš„å¯åŠ¨æ—¥å¿—
â”œâ”€ å®æ—¶çš„çŠ¶æ€æ˜¾ç¤º
â”œâ”€ æ˜ç¡®çš„é”™è¯¯æç¤º
â”œâ”€ è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯
â””â”€ å¯è§†åŒ–ç•Œé¢

å¯è¿½è¸ªæ€§ï¼š
â”œâ”€ å®Œæ•´çš„æ—¥å¿—è®°å½•
â”œâ”€ æ—¶é—´æˆ³ç²¾ç¡®åˆ°æ¯«ç§’
â”œâ”€ æ“ä½œé“¾è·¯è¿½è¸ª
â”œâ”€ äº‹ä»¶å› æœå…³ç³»
â””â”€ é—®é¢˜å›æº¯èƒ½åŠ›

å¯åˆ†ææ€§ï¼š
â”œâ”€ ç»“æ„åŒ–æ—¥å¿—æ ¼å¼
â”œâ”€ ç»Ÿè®¡æ•°æ®é‡‡é›†
â”œâ”€ è¶‹åŠ¿åˆ†ææ”¯æŒ
â”œâ”€ å¼‚å¸¸æ¨¡å¼è¯†åˆ«
â””â”€ AI åˆ†æå‹å¥½
```

#### 1.2 è®¾è®¡ç›®æ ‡è¯¦è§£

**ç›®æ ‡ 1ï¼šæ€§èƒ½ç›®æ ‡**

| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• | å¤±è´¥é˜ˆå€¼ |
|---------|---------|--------|---------|---------|
| **CPUæ€§èƒ½** | å¹³å‡CPUå ç”¨ | < 5% | ä»»åŠ¡ç®¡ç†å™¨æŒç»­ç›‘æ§1å°æ—¶ | > 10% |
| **CPUæ€§èƒ½** | å³°å€¼CPUå ç”¨ | < 10% | å‹åŠ›æµ‹è¯•ä¸‹çš„æœ€å¤§å€¼ | > 20% |
| **å†…å­˜æ€§èƒ½** | å¹³å‡å†…å­˜å ç”¨ | < 60MB | å†…å­˜åˆ†æå·¥å…·æŒç»­ç›‘æ§ | > 100MB |
| **å†…å­˜æ€§èƒ½** | å³°å€¼å†…å­˜å ç”¨ | < 100MB | å‹åŠ›æµ‹è¯•ä¸‹çš„æœ€å¤§å€¼ | > 150MB |
| **å†…å­˜æ€§èƒ½** | å†…å­˜æ³„æ¼ç‡ | 0 | è¿è¡Œ7å¤©å†…å­˜å¢é•¿ | > 10MB/å¤© |
| **å“åº”æ€§èƒ½** | æ—¥å¿—å†™å…¥å»¶è¿Ÿ | < 100ms | ä»consoleåˆ°æ–‡ä»¶çš„æ—¶é—´ | > 500ms |
| **å“åº”æ€§èƒ½** | MCPå·¥å…·å“åº” | < 500ms | å·¥å…·è°ƒç”¨åˆ°è¿”å›æ—¶é—´ | > 1000ms |
| **å“åº”æ€§èƒ½** | è®¾ç½®é¡µé¢æ¸²æŸ“ | < 300ms | æ‰“å¼€è®¾ç½®åˆ°æ˜¾ç¤ºæ—¶é—´ | > 1000ms |
| **ååæ€§èƒ½** | æ—¥å¿—å¤„ç†é€Ÿåº¦ | > 1000æ¡/ç§’ | é«˜é¢‘æ—¥å¿—å‹æµ‹ | < 500æ¡/ç§’ |
| **ååæ€§èƒ½** | å¹¶å‘è¯·æ±‚å¤„ç† | > 100 req/s | MCPå¹¶å‘è°ƒç”¨æµ‹è¯• | < 50 req/s |

**ç›®æ ‡ 2ï¼šå¯é æ€§ç›®æ ‡**

| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|---------|---------|--------|---------|
| **å¯ç”¨æ€§** | ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´ | 99.9% | æ•…éšœæ—¶é—´ < 1å°æ—¶/æœˆ |
| **å¯ç”¨æ€§** | æ’ä»¶å¯åŠ¨æˆåŠŸç‡ | > 99.5% | 100æ¬¡å¯åŠ¨çš„æˆåŠŸæ¬¡æ•° |
| **å¯é æ€§** | æ—¥å¿—ä¸¢å¤±ç‡ | < 0.1% | å¯¹æ¯”äº§ç”Ÿå’Œè®°å½•çš„æ—¥å¿—æ•° |
| **å¯é æ€§** | é‡è½½æˆåŠŸç‡ | > 95% | é‡è½½å°è¯•çš„æˆåŠŸç‡ |
| **å¯é æ€§** | é”™è¯¯æ¢å¤æ—¶é—´ | < 5ç§’ | ä»é”™è¯¯åˆ°æ¢å¤çš„æ—¶é—´ |
| **å¯é æ€§** | æ•°æ®å®Œæ•´æ€§ | 100% | æ—¥å¿—å†…å®¹çš„å‡†ç¡®æ€§ |

**ç›®æ ‡ 3ï¼šå…¼å®¹æ€§ç›®æ ‡**

| å…¼å®¹ç±»åˆ« | èŒƒå›´ | éªŒè¯æ–¹æ³• |
|---------|------|---------|
| **Obsidianç‰ˆæœ¬** | 0.13.0 - æœ€æ–°ç‰ˆ | åœ¨ä¸åŒç‰ˆæœ¬æµ‹è¯• |
| **æ“ä½œç³»ç»Ÿ** | Windows 10+, macOS 10.15+, Linux | åœ¨å„å¹³å°æµ‹è¯• |
| **Node.jsç‰ˆæœ¬** | 16+ | æ„å»ºæµ‹è¯• |
| **Pythonç‰ˆæœ¬** | 3.8+ | MCP Serveræµ‹è¯• |
| **å…¶ä»–æ’ä»¶** | ä¸å†²çª | ä¸æµè¡Œæ’ä»¶å…±å­˜æµ‹è¯• |

#### 1.3 æŠ€æœ¯é€‰å‹

**å‰ç«¯æŠ€æœ¯æ ˆ**ï¼ˆæ’ä»¶ï¼‰:

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰æ‹©ç†ç”± |
|------|------|------|---------|
| **TypeScript** | 4.9+ | æ’ä»¶ä¸»è¯­è¨€ | ç±»å‹å®‰å…¨ã€IDEæ”¯æŒå¥½ã€Obsidianå®˜æ–¹æ¨è |
| **esbuild** | 0.17.3 | æ„å»ºå·¥å…· | é€Ÿåº¦å¿«ã€é…ç½®ç®€å•ã€æ”¯æŒwatchæ¨¡å¼ |
| **Obsidian API** | latest | æ’ä»¶å¼€å‘æ¡†æ¶ | å®˜æ–¹APIã€åŠŸèƒ½å®Œæ•´ |
| **Node.jså†…ç½®æ¨¡å—** | - | æ–‡ä»¶æ“ä½œ | fs, pathç­‰ï¼Œæ— éœ€é¢å¤–ä¾èµ– |

**åç«¯æŠ€æœ¯æ ˆ**ï¼ˆMCP Serverï¼‰:

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰æ‹©ç†ç”± |
|------|------|------|---------|
| **Python** | 3.8+ | MCP Serverä¸»è¯­è¨€ | MCP SDKå®˜æ–¹æ”¯æŒã€ç”Ÿæ€ä¸°å¯Œ |
| **MCP SDK** | latest | MCPåè®®å®ç° | å®˜æ–¹SDKã€æ ‡å‡†åè®® |
| **watchdog** | 3.0+ | æ–‡ä»¶ç›‘å¬ | è·¨å¹³å°ã€ç¨³å®šå¯é  |
| **asyncio** | å†…ç½® | å¼‚æ­¥å¤„ç† | é«˜æ€§èƒ½ã€æ ‡å‡†åº“ |

**å¼€å‘å·¥å…·**:

| å·¥å…· | ç”¨é€” |
|------|------|
| **Cursor IDE** | ä¸»è¦å¼€å‘ç¯å¢ƒã€AIè¾…åŠ© |
| **VSCode** | å¤‡é€‰å¼€å‘ç¯å¢ƒ |
| **Git** | ç‰ˆæœ¬æ§åˆ¶ |
| **npm** | JavaScriptåŒ…ç®¡ç† |
| **pip** | PythonåŒ…ç®¡ç† |
| **Jest** | TypeScriptå•å…ƒæµ‹è¯•ï¼ˆè®¡åˆ’ä¸­ï¼‰ |
| **pytest** | Pythonå•å…ƒæµ‹è¯•ï¼ˆè®¡åˆ’ä¸­ï¼‰ |

---

### 2. åŠŸèƒ½æ¨¡å—è¯¦ç»†è®¾è®¡

#### 2.1 æ—¥å¿—æ‹¦æˆªæ¨¡å—ï¼ˆConsole Interceptorï¼‰

**æ¨¡å—èŒè´£**:
```
æ ¸å¿ƒèŒè´£ï¼š
1. æ‹¦æˆªå…¨å±€ console å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•
2. æ•è·æ‰€æœ‰ console æ–¹æ³•çš„è°ƒç”¨å’Œå‚æ•°
3. ä¿æŒåŸå§‹ console çš„å®Œæ•´åŠŸèƒ½
4. å°†æ•è·çš„æ•°æ®ä¼ é€’ç»™æ—¥å¿—æ”¶é›†æ¨¡å—
5. é˜²æ­¢æ­»å¾ªç¯å’Œé€’å½’è°ƒç”¨
```

**è®¾è®¡æ€è·¯**:

```
å¯åŠ¨å’Œåˆå§‹åŒ–æµç¨‹ï¼š

ç¬¬1æ­¥ï¼šä¿å­˜åŸå§‹å¼•ç”¨
â”œâ”€ åœ¨æ’ä»¶ onload() æ—¶æ‰§è¡Œ
â”œâ”€ ä¿å­˜ console.log åŸå§‹å¼•ç”¨
â”œâ”€ ä¿å­˜ console.error åŸå§‹å¼•ç”¨  
â”œâ”€ ä¿å­˜ console.warn åŸå§‹å¼•ç”¨
â”œâ”€ ä¿å­˜ console.debug åŸå§‹å¼•ç”¨
â”œâ”€ ä½¿ç”¨ .bind(console) ç¡®ä¿ this æ­£ç¡®
â””â”€ å­˜å‚¨åœ¨ç§æœ‰å˜é‡ä¸­ï¼Œé˜²æ­¢è¢«è¦†ç›–

ç¬¬2æ­¥ï¼šåˆ›å»ºåŒ…è£…å‡½æ•°
â”œâ”€ ä¸ºæ¯ä¸ªæ–¹æ³•åˆ›å»ºæ–°å‡½æ•°
â”œâ”€ ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ– functionï¼Œä¿æŒ this
â”œâ”€ ä½¿ç”¨ rest å‚æ•°æ•è·æ‰€æœ‰å‚æ•°ï¼š(...args)
â”œâ”€ å…ˆè°ƒç”¨åŸå§‹æ–¹æ³•ï¼ˆä¿æŒåŸæœ‰åŠŸèƒ½ï¼‰
â”œâ”€ å†è°ƒç”¨æ—¥å¿—è®°å½•å‡½æ•°
â””â”€ ä½¿ç”¨ try-catch åŒ…è£¹ï¼Œé¿å…å¼‚å¸¸å½±å“åŸåŠŸèƒ½

ç¬¬3æ­¥ï¼šæ›¿æ¢å…¨å±€æ–¹æ³•
â”œâ”€ console.log = newLog
â”œâ”€ console.error = newError
â”œâ”€ console.warn = newWarn
â”œâ”€ console.debug = newDebug
â””â”€ å…¨å±€ç”Ÿæ•ˆï¼Œæ‰€æœ‰ä»£ç çš„ console è°ƒç”¨è¢«æ‹¦æˆª

ç¬¬4æ­¥ï¼šé˜²æŠ¤æœºåˆ¶
â”œâ”€ è®¾ç½® isLogging æ ‡å¿—ä½
â”œâ”€ æ£€æµ‹é€’å½’è°ƒç”¨
â”œâ”€ å¤„ç†å¼‚å¸¸æƒ…å†µ
â””â”€ ç¡®ä¿ç³»ç»Ÿç¨³å®š
```

**æ‹¦æˆªçš„æ–¹æ³•è¯¦è§£**:

```
console.log() - æ™®é€šæ—¥å¿—
â”œâ”€ çº§åˆ«ï¼šLOG
â”œâ”€ ç”¨é€”ï¼šä¸€èˆ¬ä¿¡æ¯è¾“å‡º
â”œâ”€ é¢œè‰²ï¼šé»˜è®¤ï¼ˆé»‘è‰²/ç™½è‰²ï¼‰
â”œâ”€ ä½¿ç”¨é¢‘ç‡ï¼šæœ€é«˜
â””â”€ ç¤ºä¾‹ï¼šconsole.log('æ’ä»¶å·²åŠ è½½', pluginName)

console.error() - é”™è¯¯æ—¥å¿—
â”œâ”€ çº§åˆ«ï¼šERROR
â”œâ”€ ç”¨é€”ï¼šé”™è¯¯ä¿¡æ¯ã€å¼‚å¸¸å †æ ˆ
â”œâ”€ é¢œè‰²ï¼šçº¢è‰²
â”œâ”€ ä½¿ç”¨é¢‘ç‡ï¼šä¸­ç­‰
â”œâ”€ ç¤ºä¾‹ï¼šconsole.error('åŠ è½½å¤±è´¥:', error)
â””â”€ ç‰¹æ®Šå¤„ç†ï¼šæå– Error.stack

console.warn() - è­¦å‘Šæ—¥å¿—
â”œâ”€ çº§åˆ«ï¼šWARN
â”œâ”€ ç”¨é€”ï¼šè­¦å‘Šä¿¡æ¯ã€æ½œåœ¨é—®é¢˜
â”œâ”€ é¢œè‰²ï¼šé»„è‰²
â”œâ”€ ä½¿ç”¨é¢‘ç‡ï¼šè¾ƒä½
â”œâ”€ ç¤ºä¾‹ï¼šconsole.warn('APIå·²åºŸå¼ƒ')
â””â”€ æç¤ºçº§åˆ«ï¼šä»‹äºLOGå’ŒERRORä¹‹é—´

console.debug() - è°ƒè¯•æ—¥å¿—
â”œâ”€ çº§åˆ«ï¼šDEBUG
â”œâ”€ ç”¨é€”ï¼šè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
â”œâ”€ é¢œè‰²ï¼šç°è‰²
â”œâ”€ ä½¿ç”¨é¢‘ç‡ï¼šå¼€å‘æœŸé—´é«˜ï¼Œç”Ÿäº§ç¯å¢ƒä½
â”œâ”€ ç¤ºä¾‹ï¼šconsole.debug('å˜é‡å€¼:', value)
â””â”€ å¯é€‰ï¼šæ”¯æŒæŒ‰éœ€å¯ç”¨/ç¦ç”¨
```

**å…³é”®è®¾è®¡ç‚¹è¯¦è§£**:

**è®¾è®¡ç‚¹ 1ï¼šé˜²æ­¢æ­»å¾ªç¯**

é—®é¢˜åœºæ™¯ï¼š
```javascript
// åœºæ™¯æè¿°ï¼š
console.log('ç”¨æˆ·æ—¥å¿—')
  â†“ è¢«æ‹¦æˆªå™¨æ•è·
æ‹¦æˆªå™¨å‡½æ•°æ‰§è¡Œ
  â†“ è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶
æ—¥å¿—è®°å½•å‡½æ•°å†…éƒ¨
  â†“ console.log('æ­£åœ¨å†™å…¥æ–‡ä»¶...')  // åˆè¢«æ‹¦æˆªï¼
  â†“ å†æ¬¡è§¦å‘æ‹¦æˆªå™¨
  â†“ æ— é™é€’å½’
  â†“ æ ˆæº¢å‡ºå´©æºƒ
```

è§£å†³æ–¹æ¡ˆï¼š
```typescript
class ConsoleInterceptor {
  private isLogging = false;  // å…³é”®ï¼šæ ‡å¿—ä½
  
  install() {
    const originalLog = console.log.bind(console);
    
    console.log = (...args: any[]) => {
      // å…³é”®æ£€æŸ¥ï¼šå¦‚æœæ­£åœ¨è®°å½•æ—¥å¿—ï¼Œç›´æ¥è¿”å›
      if (this.isLogging) {
        originalLog(...args);  // ä»…è°ƒç”¨åŸå§‹æ–¹æ³•
        return;                // ä¸å†è®°å½•
      }
      
      // è®¾ç½®æ ‡å¿—ï¼šå¼€å§‹è®°å½•
      this.isLogging = true;
      
      try {
        // 1. è°ƒç”¨åŸå§‹æ–¹æ³•ï¼ˆç”¨æˆ·çœ‹åˆ°æ­£å¸¸è¾“å‡ºï¼‰
        originalLog(...args);
        
        // 2. è®°å½•åˆ°æ—¥å¿—ç³»ç»Ÿ
        this.onLogEntry('LOG', args);
      } finally {
        // é‡ç½®æ ‡å¿—ï¼šè®°å½•å®Œæˆ
        this.isLogging = false;
      }
    };
  }
}
```

å·¥ä½œåŸç†ï¼š
```
ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼š
  console.log('ç”¨æˆ·æ—¥å¿—')
  â†’ isLogging = false
  â†’ æ‰§è¡Œæ‹¦æˆªé€»è¾‘
  â†’ isLogging = true
  â†’ è°ƒç”¨ originalLog
  â†’ è°ƒç”¨ onLogEntry
    â†’ å¦‚æœå†…éƒ¨æœ‰ console.log
    â†’ isLogging = trueï¼ˆæ£€æŸ¥é€šè¿‡ï¼‰
    â†’ ç›´æ¥è°ƒç”¨ originalLog
    â†’ ä¸å†è®°å½•
  â†’ isLogging = false
  â†’ å®Œæˆ

ç»“æœï¼šé¿å…äº†æ­»å¾ªç¯ï¼
```

**è®¾è®¡ç‚¹ 2ï¼šå‚æ•°å¤„ç†å’Œåºåˆ—åŒ–**

å‚æ•°ç±»å‹å¤„ç†ï¼š
```typescript
// å‚æ•°åºåˆ—åŒ–ç­–ç•¥

å¤„ç†æµç¨‹ï¼š
æ¥æ”¶å‚æ•° ...args
  â†“
éå†æ¯ä¸ªå‚æ•°
  â†“
åˆ¤æ–­ç±»å‹
  â”œâ”€ null â†’ 'null'
  â”œâ”€ undefined â†’ 'undefined'
  â”œâ”€ string â†’ ç›´æ¥è¿”å›
  â”œâ”€ number â†’ String(value)
  â”œâ”€ boolean â†’ String(value)
  â”œâ”€ function â†’ '[Function: name]'
  â”œâ”€ Error â†’ message + stack
  â”œâ”€ Array â†’ JSON.stringify (å¤„ç†å¾ªç¯å¼•ç”¨)
  â”œâ”€ Object â†’ JSON.stringify (å¤„ç†å¾ªç¯å¼•ç”¨)
  â””â”€ å…¶ä»– â†’ String(value) æˆ– '[Unknown Type]'
  â†“
åˆå¹¶æ‰€æœ‰å‚æ•°ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
  â†“
æˆªæ–­è¿‡é•¿å†…å®¹ï¼ˆæœ€å¤š1000å­—ç¬¦ï¼‰
  â†“
è¿”å›æœ€ç»ˆå­—ç¬¦ä¸²
```

ç‰¹æ®Šç±»å‹å¤„ç†ç»†èŠ‚ï¼š

```typescript
// 1. Error å¯¹è±¡å¤„ç†
function serializeError(error: Error): string {
  let result = `${error.name}: ${error.message}`;
  
  if (error.stack) {
    result += '\n' + error.stack;
  }
  
  // æå–é¢å¤–å±æ€§ï¼ˆå¦‚æœæœ‰ï¼‰
  const extraKeys = Object.keys(error).filter(k => 
    k !== 'name' && k !== 'message' && k !== 'stack'
  );
  
  if (extraKeys.length > 0) {
    const extra = {};
    extraKeys.forEach(k => extra[k] = error[k]);
    result += '\nExtra: ' + JSON.stringify(extra);
  }
  
  return result;
}

// 2. å¾ªç¯å¼•ç”¨å¤„ç†
function safeStringify(obj: any, maxDepth: number = 3): string {
  const seen = new WeakSet();
  let depth = 0;
  
  const replacer = (key: string, value: any): any => {
    // æ·±åº¦é™åˆ¶
    if (depth > maxDepth) {
      return '[Max Depth Reached]';
    }
    
    if (value === null || value === undefined) {
      return value;
    }
    
    // å‡½æ•°ç±»å‹
    if (typeof value === 'function') {
      return `[Function: ${value.name || 'anonymous'}]`;
    }
    
    // å¯¹è±¡ç±»å‹
    if (typeof value === 'object') {
      // å¾ªç¯å¼•ç”¨æ£€æµ‹
      if (seen.has(value)) {
        return '[Circular Reference]';
      }
      seen.add(value);
      
      depth++;
      const result = Array.isArray(value) ? 
        value.map((item, i) => replacer(String(i), item)) :
        Object.keys(value).reduce((obj, k) => {
          obj[k] = replacer(k, value[k]);
          return obj;
        }, {});
      depth--;
      
      return result;
    }
    
    return value;
  };
  
  try {
    return JSON.stringify(obj, replacer, 2);
  } catch (error) {
    return '[Stringify Error: ' + error.message + ']';
  }
}

// 3. å¤§æ•°ç»„å¤„ç†
function serializeArray(arr: any[]): string {
  if (arr.length <= 100) {
    // å°æ•°ç»„ï¼šå®Œæ•´åºåˆ—åŒ–
    return JSON.stringify(arr, null, 2);
  } else {
    // å¤§æ•°ç»„ï¼šåªæ˜¾ç¤ºå‰åéƒ¨åˆ†
    const preview = [
      ...arr.slice(0, 50),
      `... (omitted ${arr.length - 100} items) ...`,
      ...arr.slice(-50)
    ];
    return JSON.stringify(preview, null, 2);
  }
}

// 4. å¤§å¯¹è±¡å¤„ç†
function serializeObject(obj: any): string {
  const keys = Object.keys(obj);
  
  if (keys.length <= 50) {
    // å°å¯¹è±¡ï¼šå®Œæ•´åºåˆ—åŒ–
    return JSON.stringify(obj, null, 2);
  } else {
    // å¤§å¯¹è±¡ï¼šåªæ˜¾ç¤ºéƒ¨åˆ†å±æ€§
    const preview = {};
    keys.slice(0, 50).forEach(k => preview[k] = obj[k]);
    preview['... (omitted properties)'] = keys.length - 50;
    return JSON.stringify(preview, null, 2);
  }
}
```

**è®¾è®¡ç‚¹ 3ï¼šæ—¶é—´æˆ³ç®¡ç†**

æ—¶é—´æˆ³æ ¼å¼è®¾è®¡ï¼š
```
æ ¼å¼ï¼šHH:MM:SS.mmm
ç¤ºä¾‹ï¼š16:28:08.123

é€‰æ‹©ç†ç”±ï¼š
â”œâ”€ ç²¾ç¡®åˆ°æ¯«ç§’ï¼šä¾¿äºè¿½è¸ªå¿«é€Ÿäº‹ä»¶
â”œâ”€ 24å°æ—¶åˆ¶ï¼šé¿å… AM/PM æ··æ·†
â”œâ”€ å›ºå®šå®½åº¦ï¼šä¾¿äºå¯¹é½å’Œæ’ç‰ˆ
â”œâ”€ äººç±»å¯è¯»ï¼šç›´è§‚æ˜“æ‡‚
â””â”€ æ’åºå‹å¥½ï¼šå­—ç¬¦ä¸²æ’åºå³æ—¶é—´æ’åº

å®ç°ä»£ç ï¼š
function getTimestamp(): string {
  const now = new Date();
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const seconds = String(now.getSeconds()).padStart(2, '0');
  const ms = String(now.getMilliseconds()).padStart(3, '0');
  return `${hours}:${minutes}:${seconds}.${ms}`;
}

æ€§èƒ½è€ƒè™‘ï¼š
â”œâ”€ æ¯æ¡æ—¥å¿—éƒ½éœ€è¦æ—¶é—´æˆ³
â”œâ”€ é«˜é¢‘è°ƒç”¨åœºæ™¯ï¼ˆ1000æ¬¡/ç§’ï¼‰
â”œâ”€ ä¼˜åŒ–ï¼šç¼“å­˜æ—¶é—´æˆ³ï¼ˆåŒä¸€æ¯«ç§’å†…å¤ç”¨ï¼‰
â””â”€ èŠ‚çœï¼šå‡å°‘ Date å¯¹è±¡åˆ›å»ºæ¬¡æ•°
```

#### 2.2 æ—¥å¿—æ”¶é›†æ¨¡å—ï¼ˆLog Collectorï¼‰

**æ¨¡å—èŒè´£**:
```
æ ¸å¿ƒèŒè´£ï¼š
1. æ¥æ”¶æ‹¦æˆªå™¨ä¼ æ¥çš„æ—¥å¿—æ•°æ®
2. æ·»åŠ æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–
3. ç®¡ç†å†…å­˜ç¼“å†²åŒº
4. å†³å®šä½•æ—¶åˆ·æ–°åˆ°ç£ç›˜
5. ç›‘æ§ç¼“å†²åŒºçŠ¶æ€
```

**è¯¦ç»†è®¾è®¡æµç¨‹**:

```
æ—¥å¿—å¤„ç†æµæ°´çº¿ï¼š

é˜¶æ®µ1ï¼šæ¥æ”¶æ—¥å¿—
â”œâ”€ è¾“å…¥ï¼šçº§åˆ«(level) + å‚æ•°æ•°ç»„(args)
â”œâ”€ æ¥æºï¼šConsoleInterceptor.onLogEntry()
â”œâ”€ é¢‘ç‡ï¼šä¸å®šï¼ˆå–å†³äºä»£ç æ‰§è¡Œï¼‰
â””â”€ éªŒè¯ï¼šå‚æ•°éç©ºï¼Œçº§åˆ«æœ‰æ•ˆ

é˜¶æ®µ2ï¼šæ ¼å¼åŒ–
â”œâ”€ ç”Ÿæˆæ—¶é—´æˆ³ï¼šgetTimestamp()
â”œâ”€ åºåˆ—åŒ–å‚æ•°ï¼šConsoleInterceptor.serializeArgs(args)
â”œâ”€ ç»„åˆæ ¼å¼ï¼š[æ—¶é—´æˆ³] [çº§åˆ«] æ¶ˆæ¯
â”œâ”€ ç¤ºä¾‹ï¼š[16:28:08.123] [LOG] æ’ä»¶å·²åŠ è½½
â””â”€ æ·»åŠ æ¢è¡Œç¬¦å‡†å¤‡

é˜¶æ®µ3ï¼šç¼“å†²åŒºç®¡ç†
â”œâ”€ æ·»åŠ åˆ°å†…å­˜æ•°ç»„ï¼šbuffer.push(entry)
â”œâ”€ æ£€æŸ¥ç¼“å†²åŒºå¤§å°ï¼šbuffer.length
â”œâ”€ åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ·æ–°
â”‚  â”œâ”€ æ¡ä»¶1ï¼šbuffer.length >= bufferSize (100)
â”‚  â”œâ”€ æ¡ä»¶2ï¼šå®šæ—¶å™¨è§¦å‘ (500ms)
â”‚  â””â”€ æ¡ä»¶3ï¼šæ’ä»¶å¸è½½
â””â”€ è§¦å‘åˆ·æ–° â†’ flush()

é˜¶æ®µ4ï¼šæ‰¹é‡åˆ·æ–°
â”œâ”€ å¤åˆ¶å½“å‰ç¼“å†²ï¼šlogs = [...buffer]
â”œâ”€ æ¸…ç©ºç¼“å†²åŒºï¼šbuffer = []
â”œâ”€ è°ƒç”¨å›è°ƒï¼šonFlush(logs)
â”œâ”€ FileManager æ¥ç®¡å†™å…¥
â””â”€ å®Œæˆåˆ·æ–°å‘¨æœŸ
```

**ç¼“å†²åŒºç­–ç•¥è¯¦è§£**:

```
ç¼“å†²åŒºè®¾è®¡ï¼š

æ•°æ®ç»“æ„ï¼š
â”œâ”€ ç±»å‹ï¼šstring[]
â”œâ”€ åˆå§‹å®¹é‡ï¼š0ï¼ˆåŠ¨æ€å¢é•¿ï¼‰
â”œâ”€ æœ€å¤§å®¹é‡ï¼šæ— ä¸Šé™ï¼ˆç”±åˆ·æ–°ç­–ç•¥æ§åˆ¶ï¼‰
â”œâ”€ å¢é•¿ç­–ç•¥ï¼špush() è¿½åŠ 
â””â”€ æ¸…ç©ºç­–ç•¥ï¼šé‡æ–°èµ‹å€¼ []

åˆ·æ–°ç­–ç•¥ï¼ˆä¸‰é‡è§¦å‘ï¼‰ï¼š

è§¦å‘å™¨1ï¼šæ•°é‡è§¦å‘
â”œâ”€ æ¡ä»¶ï¼šbuffer.length >= bufferSize
â”œâ”€ é»˜è®¤å€¼ï¼š100 æ¡
â”œâ”€ å¯é…ç½®ï¼š1-1000 æ¡
â”œâ”€ ä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼ˆç«‹å³åˆ·æ–°ï¼‰
â”œâ”€ é€‚ç”¨åœºæ™¯ï¼šé«˜é¢‘æ—¥å¿—è¾“å‡º
â””â”€ æ•ˆæœï¼šé¿å…å†…å­˜å †ç§¯

è§¦å‘å™¨2ï¼šæ—¶é—´è§¦å‘
â”œâ”€ æ¡ä»¶ï¼šå®šæ—¶å™¨ï¼ˆsetIntervalï¼‰
â”œâ”€ é»˜è®¤å€¼ï¼š500ms
â”œâ”€ å¯é…ç½®ï¼š100-5000ms
â”œâ”€ ä¼˜å…ˆçº§ï¼šä¸­ç­‰ï¼ˆå®šæœŸåˆ·æ–°ï¼‰
â”œâ”€ é€‚ç”¨åœºæ™¯ï¼šä½é¢‘æ—¥å¿—è¾“å‡º
â”œâ”€ æ•ˆæœï¼šç¡®ä¿æ—¥å¿—åŠæ—¶å†™å…¥
â””â”€ å®ç°ï¼šåªåœ¨ç¼“å†²åŒºéç©ºæ—¶åˆ·æ–°

è§¦å‘å™¨3ï¼šå¸è½½è§¦å‘
â”œâ”€ æ¡ä»¶ï¼šæ’ä»¶ onunload()
â”œâ”€ æ—¶æœºï¼šæ’ä»¶å…³é—­å‰
â”œâ”€ ä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰
â”œâ”€ é€‚ç”¨åœºæ™¯ï¼šç¡®ä¿æ•°æ®å®Œæ•´
â””â”€ æ•ˆæœï¼šä¸ä¸¢å¤±ä»»ä½•æ—¥å¿—

æ‰¹é‡å†™å…¥ä¼˜åŠ¿ï¼š
â”œâ”€ æ€§èƒ½æå‡ï¼šå‡å°‘ I/O è°ƒç”¨ 95%+
â”œâ”€ ç¤ºä¾‹å¯¹æ¯”ï¼š
â”‚  â”œâ”€ æœªä¼˜åŒ–ï¼š10000æ¡æ—¥å¿— = 10000æ¬¡I/O
â”‚  â””â”€ ä¼˜åŒ–åï¼š10000æ¡æ—¥å¿— = 100æ¬¡I/O
â”œâ”€ ç³»ç»Ÿè´Ÿè½½ï¼šæ˜¾è‘—é™ä½
â”œâ”€ å“åº”å»¶è¿Ÿï¼šå‡ ä¹æ— å½±å“
â””â”€ èµ„æºåˆ©ç”¨ï¼šæ›´é«˜æ•ˆ
```

**æ—¥å¿—æ ¼å¼æ ‡å‡†è¯¦è§£**:

```
æ ‡å‡†æ ¼å¼å®šä¹‰ï¼š
[HH:MM:SS.mmm] [LEVEL] message

æ ¼å¼è¯´æ˜ï¼š
â”œâ”€ [HH:MM:SS.mmm]ï¼šæ—¶é—´æˆ³éƒ¨åˆ†
â”‚  â”œâ”€ å›ºå®šå®½åº¦ï¼š15ä¸ªå­—ç¬¦
â”‚  â”œâ”€ åŒ…å«æ–¹æ‹¬å·
â”‚  â”œâ”€ 24å°æ—¶åˆ¶
â”‚  â””â”€ æ¯«ç§’ç²¾åº¦
â”‚
â”œâ”€ [LEVEL]ï¼šçº§åˆ«éƒ¨åˆ†
â”‚  â”œâ”€ å›ºå®šå®½åº¦ï¼š7ä¸ªå­—ç¬¦ï¼ˆå«æ–¹æ‹¬å·ï¼‰
â”‚  â”œâ”€ å¯èƒ½å€¼ï¼šLOG, ERROR, WARN, DEBUG
â”‚  â”œâ”€ å¯¹é½æ–¹å¼ï¼šå·¦å¯¹é½
â”‚  â””â”€ ä¾¿äºè¿‡æ»¤
â”‚
â”œâ”€ messageï¼šæ¶ˆæ¯éƒ¨åˆ†
â”‚  â”œâ”€ å˜é•¿ï¼šæ ¹æ®å®é™…å†…å®¹
â”‚  â”œâ”€ å†…å®¹ï¼šåºåˆ—åŒ–åçš„å‚æ•°
â”‚  â”œâ”€ æœ€å¤§é•¿åº¦ï¼š1000å­—ç¬¦ï¼ˆè¶…å‡ºæˆªæ–­ï¼‰
â”‚  â””â”€ ç‰¹æ®Šå¤„ç†ï¼šErrorå¯¹è±¡åŒ…å«å †æ ˆ

ç¤ºä¾‹ï¼š
[16:28:08.123] [LOG] æ’ä»¶å·²åŠ è½½
[16:28:08.125] [LOG] é…ç½®å·²è¯»å–: {"mode":"smart"}
[16:28:09.456] [ERROR] TypeError: Cannot read property 'app' of undefined
    at MyPlugin.onload (main.js:123:45)
    at ...
[16:28:10.789] [WARN] è­¦å‘Šï¼šé…ç½®æ–‡ä»¶ç¼ºå°‘æŸäº›å­—æ®µ
[16:28:11.012] [DEBUG] å˜é‡å€¼: value = 42

æ ¼å¼ä¼˜åŠ¿ï¼š
â”œâ”€ å¯è¯»æ€§å¼ºï¼šäººç±»æ˜“è¯»
â”œâ”€ å¯è§£ææ€§å¼ºï¼šç¨‹åºæ˜“è§£æ
â”œâ”€ å¯æœç´¢æ€§å¼ºï¼šgrep/find å‹å¥½
â”œâ”€ å¯æ’åºæ€§å¼ºï¼šæŒ‰æ—¶é—´è‡ªç„¶æ’åº
â””â”€ å¯åˆ†ææ€§å¼ºï¼šæ”¯æŒç»Ÿè®¡å’Œåˆ†æ
```

**æ€§èƒ½ä¼˜åŒ–ç»†èŠ‚**:

```
ä¼˜åŒ–ç‚¹1ï¼šæ—¶é—´æˆ³ç¼“å­˜
é—®é¢˜ï¼šé«˜é¢‘è°ƒç”¨æ—¶ new Date() å¼€é”€å¤§
æ–¹æ¡ˆï¼š
  let lastTimestamp = '';
  let lastTime = 0;
  
  function getTimestamp() {
    const now = Date.now();
    if (now === lastTime) {
      return lastTimestamp;  // å¤ç”¨ç¼“å­˜
    }
    lastTime = now;
    lastTimestamp = formatTime(new Date(now));
    return lastTimestamp;
  }
  
æ”¶ç›Šï¼šåŒä¸€æ¯«ç§’å†…çš„è°ƒç”¨å…±äº«æ—¶é—´æˆ³

ä¼˜åŒ–ç‚¹2ï¼šå­—ç¬¦ä¸²æ‹¼æ¥
é—®é¢˜ï¼šé¢‘ç¹æ‹¼æ¥å­—ç¬¦ä¸²æ€§èƒ½å·®
æ–¹æ¡ˆï¼š
  // ä¸æ¨è
  let str = '[' + timestamp + '] [' + level + '] ' + message;
  
  // æ¨è
  const str = `[${timestamp}] [${level}] ${message}`;
  
  // æˆ–ä½¿ç”¨æ•°ç»„joinï¼ˆæ›´å¿«ï¼‰
  const parts = ['[', timestamp, '] [', level, '] ', message];
  const str = parts.join('');

ä¼˜åŒ–ç‚¹3ï¼šé¿å…ä¸å¿…è¦çš„åºåˆ—åŒ–
é—®é¢˜ï¼šåºåˆ—åŒ–å¤§å¯¹è±¡è€—æ—¶
æ–¹æ¡ˆï¼š
  // æ£€æŸ¥å‚æ•°ç±»å‹ï¼Œç®€å•ç±»å‹ç›´æ¥å¤„ç†
  if (typeof arg === 'string' || typeof arg === 'number') {
    return String(arg);  // å¿«é€Ÿè·¯å¾„
  }
  // å¤æ‚ç±»å‹æ‰åºåˆ—åŒ–
  return JSON.stringify(arg);
```

#### 2.3 æ–‡ä»¶ç®¡ç†æ¨¡å—ï¼ˆFile Managerï¼‰

**æ¨¡å—èŒè´£**:
```
æ ¸å¿ƒèŒè´£ï¼š
1. ç®¡ç†æ—¥å¿—æ–‡ä»¶çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ
2. å¤„ç†æ‰€æœ‰æ–‡ä»¶ I/O æ“ä½œ
3. å®ç°æ–‡ä»¶è½®è½¬å’Œå¤‡ä»½æœºåˆ¶
4. å¤„ç†ç£ç›˜ç©ºé—´å’Œæƒé™é—®é¢˜
5. æä¾›æ–‡ä»¶ä¿¡æ¯æŸ¥è¯¢æ¥å£
```

**æ–‡ä»¶è·¯å¾„è®¾è®¡è¯¦è§£**:

```
è·¯å¾„ç­–ç•¥ï¼š

è®¾è®¡å†³ç­–ï¼šæ—¥å¿—æ–‡ä»¶æ”¾åœ¨ Vault å¤–éƒ¨

ä½ç½®ï¼š{VAULT_PATH}/../obsidian-logger/obsidian-debug.log

å…·ä½“ç¤ºä¾‹ï¼š
MacOS:
  Vault: /Users/username/Documents/MyVault
  æ—¥å¿—: /Users/username/Documents/obsidian-logger/obsidian-debug.log

Windows:
  Vault: C:\Users\username\Documents\MyVault
  æ—¥å¿—: C:\Users\username\Documents\obsidian-logger\obsidian-debug.log

Linux:
  Vault: /home/username/Documents/MyVault
  æ—¥å¿—: /home/username/Documents/obsidian-logger/obsidian-debug.log

é€‰æ‹©å¤–éƒ¨è·¯å¾„çš„åŸå› ï¼š

åŸå› 1ï¼šé¿å…è¿›å…¥Obsidianå¤‡ä»½
â”œâ”€ Obsidian è‡ªåŠ¨åŒæ­¥å’Œå¤‡ä»½ vault å†…å®¹
â”œâ”€ æ—¥å¿—æ–‡ä»¶å¯èƒ½å¾ˆå¤§ï¼ˆ10MB+ï¼‰
â”œâ”€ é¢‘ç¹å˜åŒ–ä¼šå½±å“åŒæ­¥æ€§èƒ½
â”œâ”€ å¤‡ä»½æ—¥å¿—æ–‡ä»¶æ²¡æœ‰æ„ä¹‰
â””â”€ å¤–éƒ¨è·¯å¾„ä¸ä¼šè¢«åŒæ­¥

åŸå› 2ï¼šä¾¿äºCursor/IDEè®¿é—®
â”œâ”€ å›ºå®šçš„å·²çŸ¥è·¯å¾„
â”œâ”€ ä¸ä¾èµ–ç‰¹å®švault
â”œâ”€ å¤šä¸ªvaultå¯å…±äº«æ—¥å¿—ç›®å½•
â”œâ”€ ä¾¿äºé…ç½®MCP Server
â””â”€ è·¨é¡¹ç›®è°ƒè¯•æ–¹ä¾¿

åŸå› 3ï¼šæ•°æ®å®‰å…¨
â”œâ”€ æ—¥å¿—æ–‡ä»¶ç‹¬ç«‹äºç”¨æˆ·æ•°æ®
â”œâ”€ ä¸ä¼šæ±¡æŸ“ç”¨æˆ·çš„vault
â”œâ”€ è¯¯åˆ vaultä¸å½±å“æ—¥å¿—
â”œâ”€ ä¾¿äºå•ç‹¬å¤‡ä»½æ—¥å¿—
â””â”€ ç¬¦åˆæ•°æ®éš”ç¦»åŸåˆ™

åŸå› 4ï¼šæ€§èƒ½è€ƒè™‘
â”œâ”€ é¿å…Obsidianç´¢å¼•æ—¥å¿—æ–‡ä»¶
â”œâ”€ å‡å°‘vaultæ–‡ä»¶æ•°é‡
â”œâ”€ æå‡Obsidianå¯åŠ¨é€Ÿåº¦
â””â”€ é™ä½ç³»ç»Ÿèµ„æºå ç”¨
```

**æ–‡ä»¶å‘½åè§„åˆ™è¯¦è§£**:

```
å‘½åè§„èŒƒï¼š

ä¸»æ—¥å¿—æ–‡ä»¶ï¼š
â”œâ”€ åç§°ï¼šobsidian-debug.log
â”œâ”€ å›ºå®šä¸å˜
â”œâ”€ å§‹ç»ˆæ˜¯å½“å‰æ´»è·ƒçš„æ—¥å¿—æ–‡ä»¶
â””â”€ ç”¨æˆ·å’Œå·¥å…·é»˜è®¤è®¿é—®æ­¤æ–‡ä»¶

å¤‡ä»½æ–‡ä»¶ï¼š
â”œâ”€ æ ¼å¼ï¼šobsidian-debug-{timestamp}.log
â”œâ”€ ç¤ºä¾‹ï¼šobsidian-debug-2025-11-02T16-28-08-123.log
â”œâ”€ æ—¶é—´æˆ³ï¼šISO 8601 æ ¼å¼ï¼Œä½†æ›¿æ¢ç‰¹æ®Šå­—ç¬¦
â”‚  â”œâ”€ åŸå§‹ï¼š2025-11-02T16:28:08.123Z
â”‚  â”œâ”€ æ›¿æ¢ï¼š: â†’ -, . â†’ -, ç§»é™¤Z
â”‚  â””â”€ ç»“æœï¼š2025-11-02T16-28-08-123
â”œâ”€ æ’åºï¼šæ–‡ä»¶åè‡ªç„¶æ’åºå³æ—¶é—´æ’åº
â””â”€ è¯†åˆ«ï¼šè½®è½¬æ—¶é—´ä¸€ç›®äº†ç„¶

å‘½åè½¬æ¢ä»£ç ï¼š
function generateBackupFilename(originalPath: string): string {
  const timestamp = new Date()
    .toISOString()                    // 2025-11-02T16:28:08.123Z
    .replace(/:/g, '-')               // æ›¿æ¢å†’å·
    .replace(/\./g, '-')              // æ›¿æ¢ç‚¹å·
    .replace('Z', '')                 // ç§»é™¤Z
    .substring(0, 23);                // æˆªå–åˆ°æ¯«ç§’
  
  return originalPath.replace('.log', `-${timestamp}.log`);
}

// ç¤ºä¾‹ï¼š
// è¾“å…¥ï¼š/path/to/obsidian-debug.log
// è¾“å‡ºï¼š/path/to/obsidian-debug-2025-11-02T16-28-08-123.log
```

**æ–‡ä»¶å¤§å°ç®¡ç†è¯¦è§£**:

```
è½®è½¬æœºåˆ¶ï¼ˆFile Rotationï¼‰ï¼š

è§¦å‘æ¡ä»¶ï¼š
â”œâ”€ æ£€æŸ¥æ—¶æœºï¼šæ¯æ¬¡å†™å…¥å‰
â”œâ”€ æ£€æŸ¥æ–¹æ³•ï¼šfs.statSync(logFile).size
â”œâ”€ é˜ˆå€¼åˆ¤æ–­ï¼šsize > maxFileSize * 1024 * 1024
â”œâ”€ é»˜è®¤é˜ˆå€¼ï¼š10 MB
â””â”€ å¯é…ç½®èŒƒå›´ï¼š1-100 MB

è½®è½¬æµç¨‹ï¼š

æ­¥éª¤1ï¼šæ£€æŸ¥æ–‡ä»¶å¤§å°
â”œâ”€ è·å–å½“å‰æ—¥å¿—æ–‡ä»¶å¤§å°
â”œâ”€ è½¬æ¢å•ä½ï¼šbytes â†’ MB
â”œâ”€ å¯¹æ¯”é˜ˆå€¼
â””â”€ å¦‚æœè¶…è¿‡ â†’ æ‰§è¡Œè½®è½¬

æ­¥éª¤2ï¼šç”Ÿæˆå¤‡ä»½æ–‡ä»¶å
â”œâ”€ è·å–å½“å‰æ—¶é—´æˆ³
â”œâ”€ æ ¼å¼åŒ–ä¸ºæ–‡ä»¶åå®‰å…¨æ ¼å¼
â”œâ”€ æ‹¼æ¥åŸå§‹æ–‡ä»¶å
â””â”€ ç”Ÿæˆå®Œæ•´è·¯å¾„

æ­¥éª¤3ï¼šé‡å‘½åæ–‡ä»¶
â”œâ”€ ä½¿ç”¨ fs.renameSync()
â”œâ”€ åŸæ–‡ä»¶ï¼šobsidian-debug.log
â”œâ”€ æ–°æ–‡ä»¶ï¼šobsidian-debug-2025-11-02T16-28-08-123.log
â”œâ”€ åŸå­æ“ä½œï¼šç¡®ä¿ä¸ä¸¢å¤±æ•°æ®
â””â”€ é€Ÿåº¦æå¿«ï¼š< 10ms

æ­¥éª¤4ï¼šåˆ›å»ºæ–°æ–‡ä»¶
â”œâ”€ æ–°çš„ obsidian-debug.log è‡ªåŠ¨åˆ›å»º
â”œâ”€ ä»ç©ºå¼€å§‹
â”œâ”€ ç»§ç»­æ¥æ”¶æ–°æ—¥å¿—
â””â”€ æ— ç¼åˆ‡æ¢

æ­¥éª¤5ï¼šè®°å½•è½®è½¬äº‹ä»¶
â”œâ”€ è¾“å‡ºæ—¥å¿—ï¼šconsole.log('æ—¥å¿—æ–‡ä»¶å·²è½®è½¬')
â”œâ”€ è¢«æ‹¦æˆªå™¨æ•è·
â”œâ”€ å†™å…¥æ–°æ–‡ä»¶
â””â”€ å½¢æˆå®Œæ•´è®°å½•

æ€§èƒ½å½±å“ï¼š
â”œâ”€ è½®è½¬æ“ä½œï¼š< 10ms
â”œâ”€ å¯¹æ—¥å¿—è®°å½•æ— å½±å“
â”œâ”€ ç”¨æˆ·æ— æ„ŸçŸ¥
â””â”€ è‡ªåŠ¨æ— ç¼åˆ‡æ¢
```

**æ¸…ç†ç­–ç•¥è¯¦è§£**:

```
è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼š

æ¸…ç†è§¦å‘ï¼š
â”œâ”€ å®šæœŸæ£€æŸ¥ï¼šæ¯å¤©å‡Œæ™¨2ç‚¹ï¼ˆå¯é…ç½®ï¼‰
â”œâ”€ æ‰‹åŠ¨è§¦å‘ï¼šè°ƒç”¨ clear_logs å‘½ä»¤
â”œâ”€ å¯åŠ¨æ£€æŸ¥ï¼šæ’ä»¶å¯åŠ¨æ—¶æ£€æŸ¥ä¸€æ¬¡
â””â”€ å¯ç¦ç”¨ï¼šenableAutoClean é…ç½®é¡¹

æ¸…ç†é€»è¾‘ï¼š

æ­¥éª¤1ï¼šæ‰«æå¤‡ä»½æ–‡ä»¶
â”œâ”€ ç›®å½•ï¼šobsidian-logger/
â”œâ”€ æ¨¡å¼ï¼šobsidian-debug-*.log
â”œâ”€ æ–¹æ³•ï¼šreaddir() + filter()
â””â”€ ç»“æœï¼šæ‰€æœ‰å¤‡ä»½æ–‡ä»¶åˆ—è¡¨

æ­¥éª¤2ï¼šè§£ææ–‡ä»¶æ—¶é—´
â”œâ”€ æå–æ–‡ä»¶åä¸­çš„æ—¶é—´æˆ³
â”œâ”€ è½¬æ¢ä¸º Date å¯¹è±¡
â”œâ”€ è®¡ç®—è·ä»Šå¤©æ•°
â””â”€ åˆ¤æ–­æ˜¯å¦è¿‡æœŸ

æ­¥éª¤3ï¼šåˆ é™¤è¿‡æœŸæ–‡ä»¶
â”œâ”€ è¿‡æ»¤ï¼šage > retentionDays
â”œâ”€ é»˜è®¤ï¼š30 å¤©
â”œâ”€ åˆ é™¤ï¼šfs.unlinkSync()
â”œâ”€ è®°å½•ï¼šconsole.log('å·²åˆ é™¤Nä¸ªè¿‡æœŸæ–‡ä»¶')
â””â”€ å¼‚å¸¸ï¼šåˆ é™¤å¤±è´¥ä¸ä¸­æ–­æµç¨‹

æ­¥éª¤4ï¼šç©ºé—´æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰
â”œâ”€ æ£€æŸ¥ç£ç›˜å‰©ä½™ç©ºé—´
â”œâ”€ å¦‚æœ < 1GBï¼Œä¸»åŠ¨æ¸…ç†
â”œâ”€ ä¼˜å…ˆåˆ é™¤æœ€è€çš„æ–‡ä»¶
â”œâ”€ ç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´å†™å…¥
â””â”€ å‘å‡ºè­¦å‘Šæç¤ºç”¨æˆ·

é…ç½®ç¤ºä¾‹ï¼š
{
  "logger": {
    "enableAutoClean": true,      // å¯ç”¨è‡ªåŠ¨æ¸…ç†
    "retentionDays": 30,          // ä¿ç•™30å¤©
    "maxFileSize": 10             // å•æ–‡ä»¶10MB
  }
}

æ¸…ç†æ•ˆæœï¼š
â”œâ”€ é¿å…æ—¥å¿—æ–‡ä»¶æ— é™å¢é•¿
â”œâ”€ èŠ‚çœç£ç›˜ç©ºé—´
â”œâ”€ ä¿æŒç³»ç»Ÿæ•´æ´
â””â”€ è‡ªåŠ¨åŒ–ç®¡ç†
```

**å¼‚å¸¸å¤„ç†è¯¦è§£**:

```
å¼‚å¸¸åœºæ™¯å¤„ç†ï¼š

åœºæ™¯1ï¼šç›®å½•ä¸å­˜åœ¨
â”œâ”€ æ£€æµ‹ï¼šfs.existsSync(logDir) === false
â”œâ”€ å¤„ç†ï¼šè‡ªåŠ¨åˆ›å»ºç›®å½•
â”‚  â”œâ”€ ä½¿ç”¨ mkdirp æ¨¡å¼ï¼ˆé€’å½’åˆ›å»ºï¼‰
â”‚  â”œâ”€ å¤„ç†æƒé™é—®é¢˜
â”‚  â””â”€ éªŒè¯åˆ›å»ºæˆåŠŸ
â”œâ”€ æ¢å¤ï¼šåˆ›å»ºæˆåŠŸåç»§ç»­å†™å…¥
â”œâ”€ å‘Šè­¦ï¼šconsole.log('æ—¥å¿—ç›®å½•å·²åˆ›å»º')
â””â”€ åæœï¼šæ— ï¼Œè‡ªåŠ¨æ¢å¤

åœºæ™¯2ï¼šç£ç›˜ç©ºé—´ä¸è¶³
â”œâ”€ æ£€æµ‹ï¼šå†™å…¥æ—¶æŠ›å‡º ENOSPC é”™è¯¯
â”œâ”€ å¤„ç†ï¼š
â”‚  â”œâ”€ ç«‹å³åœæ­¢å†™å…¥
â”‚  â”œâ”€ æ¸…ç†æ—§å¤‡ä»½æ–‡ä»¶
â”‚  â”œâ”€ é‡è¯•å†™å…¥
â”‚  â””â”€ å¦‚æœä»å¤±è´¥ï¼Œé™çº§åˆ°å†…å­˜æ¨¡å¼
â”œâ”€ å‘Šè­¦ï¼šconsole.error('ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œå·²æ¸…ç†æ—§æ–‡ä»¶')
â”œâ”€ æ¢å¤ï¼šç©ºé—´é‡Šæ”¾åè‡ªåŠ¨æ¢å¤
â””â”€ åæœï¼šå¯èƒ½ä¸¢å¤±éƒ¨åˆ†æ—¥å¿—

åœºæ™¯3ï¼šæ–‡ä»¶è¢«é”å®š
â”œâ”€ æ£€æµ‹ï¼šå†™å…¥æ—¶æŠ›å‡º EBUSY æˆ– EPERM
â”œâ”€ å¤„ç†ï¼š
â”‚  â”œâ”€ ç­‰å¾…100ms
â”‚  â”œâ”€ é‡è¯•å†™å…¥
â”‚  â”œâ”€ æœ€å¤šé‡è¯•3æ¬¡
â”‚  â””â”€ å¤±è´¥åˆ™ç¼“å­˜åˆ°å†…å­˜
â”œâ”€ å‘Šè­¦ï¼šconsole.warn('æ–‡ä»¶è¢«é”å®šï¼Œç­‰å¾…ä¸­...')
â”œâ”€ æ¢å¤ï¼šæ–‡ä»¶è§£é”åæ‰¹é‡å†™å…¥
â””â”€ åæœï¼šå»¶è¿Ÿå†™å…¥ï¼Œä½†ä¸ä¸¢å¤±

åœºæ™¯4ï¼šæƒé™ä¸è¶³
â”œâ”€ æ£€æµ‹ï¼šEACCES é”™è¯¯
â”œâ”€ å¤„ç†ï¼š
â”‚  â”œâ”€ å°è¯•ä½¿ç”¨å¤‡é€‰è·¯å¾„ï¼ˆç”¨æˆ·ä¸»ç›®å½•ï¼‰
â”‚  â”œâ”€ é™çº§åˆ°ä¸´æ—¶ç›®å½•
â”‚  â”œâ”€ æœ€åé™çº§åˆ°å†…å­˜æ¨¡å¼
â”‚  â””â”€ æç¤ºç”¨æˆ·æ£€æŸ¥æƒé™
â”œâ”€ å‘Šè­¦ï¼šconsole.error('æ—¥å¿—ç›®å½•æƒé™ä¸è¶³')
â”œâ”€ æ¢å¤ï¼šç”¨æˆ·ä¿®å¤æƒé™åéœ€é‡å¯æ’ä»¶
â””â”€ åæœï¼šæ—¥å¿—ä½ç½®å˜åŒ–æˆ–ä»…å†…å­˜ç¼“å­˜

åœºæ™¯5ï¼šæ–‡ä»¶ç³»ç»Ÿé”™è¯¯
â”œâ”€ æ£€æµ‹ï¼šå…¶ä»–æœªçŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯
â”œâ”€ å¤„ç†ï¼š
â”‚  â”œâ”€ è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
â”‚  â”œâ”€ å°è¯•é™çº§å¤„ç†
â”‚  â”œâ”€ ä¿æŠ¤æ’ä»¶ä¸å´©æºƒ
â”‚  â””â”€ é€šçŸ¥ç”¨æˆ·
â”œâ”€ å‘Šè­¦ï¼šconsole.error('æ–‡ä»¶ç³»ç»Ÿé”™è¯¯:', error)
â”œâ”€ æ¢å¤ï¼šè§†å…·ä½“é”™è¯¯è€Œå®š
â””â”€ åæœï¼šå¯èƒ½å½±å“æ—¥å¿—åŠŸèƒ½ï¼Œä½†ä¸å½±å“Obsidian

æ¢å¤ç­–ç•¥å±‚æ¬¡ï¼š
ç¬¬1å±‚ï¼šè‡ªåŠ¨é‡è¯•ï¼ˆè½»å¾®é”™è¯¯ï¼‰
  â”œâ”€ ç­‰å¾… + é‡è¯•
  â”œâ”€ æœ€å¤š3æ¬¡
  â””â”€ é€‚ç”¨ï¼šæ–‡ä»¶é”å®šã€ä¸´æ—¶I/Oé”™è¯¯

ç¬¬2å±‚ï¼šé™çº§å¤„ç†ï¼ˆä¸€èˆ¬é”™è¯¯ï¼‰
  â”œâ”€ åˆ‡æ¢åˆ°å¤‡é€‰è·¯å¾„
  â”œâ”€ æˆ–ä½¿ç”¨å†…å­˜ç¼“å­˜
  â””â”€ é€‚ç”¨ï¼šæƒé™é—®é¢˜ã€ç£ç›˜ç©ºé—´

ç¬¬3å±‚ï¼šå®‰å…¨åœæ­¢ï¼ˆä¸¥é‡é”™è¯¯ï¼‰
  â”œâ”€ åœæ­¢æ—¥å¿—å†™å…¥
  â”œâ”€ ä¿æŠ¤æ’ä»¶ç¨³å®šæ€§
  â”œâ”€ é€šçŸ¥ç”¨æˆ·
  â””â”€ é€‚ç”¨ï¼šæ— æ³•æ¢å¤çš„ç³»ç»Ÿé”™è¯¯
```

**æ–‡ä»¶æ“ä½œå®ç°ä»£ç **:

```typescript
export class FileManager {
  private logFilePath: string;
  private logDir: string;
  private maxFileSize: number;  // MB
  
  constructor(
    private app: App,
    logFileRelativePath: string,
    maxFileSize: number
  ) {
    // è®¡ç®—ç»å¯¹è·¯å¾„
    const vaultPath = (this.app.vault.adapter as any).basePath;
    
    if (logFileRelativePath.startsWith('../')) {
      // ç›¸å¯¹äºvaultçš„è·¯å¾„
      const relativePath = logFileRelativePath.substring(3);
      this.logDir = path.join(vaultPath, '..', relativePath.split('/')[0]);
      this.logFilePath = path.join(vaultPath, '..', relativePath);
    } else {
      // ç»å¯¹è·¯å¾„
      this.logFilePath = logFileRelativePath;
      this.logDir = path.dirname(logFileRelativePath);
    }
    
    this.maxFileSize = maxFileSize;
  }
  
  // åˆå§‹åŒ–
  async initialize(): Promise<void> {
    try {
      await this.ensureDirectoryExists(this.logDir);
      console.log('[FileManager] æ—¥å¿—ç›®å½•å·²å‡†å¤‡:', this.logDir);
    } catch (error) {
      console.error('[FileManager] åˆå§‹åŒ–å¤±è´¥:', error);
      throw error;
    }
  }
  
  // ç¡®ä¿ç›®å½•å­˜åœ¨
  private async ensureDirectoryExists(dirPath: string): Promise<void> {
    const fs = require('fs');
    const path = require('path');
    
    // é€’å½’åˆ›å»ºç›®å½•ï¼ˆç±»ä¼¼ mkdir -pï¼‰
    const createDir = (dir: string) => {
      if (fs.existsSync(dir)) return;
      
      const parent = path.dirname(dir);
      if (!fs.existsSync(parent)) {
        createDir(parent);
      }
      
      try {
        fs.mkdirSync(dir);
      } catch (error) {
        if (error.code !== 'EEXIST') {
          throw error;
        }
      }
    };
    
    createDir(dirPath);
  }
  
  // å†™å…¥æ—¥å¿—ï¼ˆæ‰¹é‡ï¼‰
  async writeLogs(logs: string[]): Promise<void> {
    try {
      // æ­¥éª¤1ï¼šæ£€æŸ¥å¹¶æ‰§è¡Œè½®è½¬
      await this.checkRotation();
      
      // æ­¥éª¤2ï¼šå‡†å¤‡å†…å®¹
      const content = logs.join('\n') + '\n';
      
      // æ­¥éª¤3ï¼šå†™å…¥æ–‡ä»¶ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰
      await this.appendToFile(this.logFilePath, content);
      
      // æ­¥éª¤4ï¼šæ›´æ–°ç»Ÿè®¡ï¼ˆå¯é€‰ï¼‰
      // this.updateStats(logs.length);
      
    } catch (error) {
      console.error('[FileManager] å†™å…¥å¤±è´¥:', error);
      // è¿™é‡Œå¯ä»¥å®ç°é™çº§é€»è¾‘
      await this.handleWriteError(error, logs);
    }
  }
  
  // è¿½åŠ åˆ°æ–‡ä»¶
  private async appendToFile(filePath: string, content: string): Promise<void> {
    const fs = require('fs');
    
    // é‡è¯•æœºåˆ¶
    let retries = 3;
    while (retries > 0) {
      try {
        fs.appendFileSync(filePath, content, 'utf8');
        return;  // æˆåŠŸ
      } catch (error) {
        retries--;
        if (retries === 0) throw error;
        
        // ç­‰å¾…åé‡è¯•
        await new Promise(resolve => setTimeout(resolve, 100));
      }
    }
  }
  
  // æ£€æŸ¥è½®è½¬
  private async checkRotation(): Promise<void> {
    const fs = require('fs');
    
    try {
      if (!fs.existsSync(this.logFilePath)) {
        return;  // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ— éœ€è½®è½¬
      }
      
      const stats = fs.statSync(this.logFilePath);
      const fileSizeInMB = stats.size / (1024 * 1024);
      
      if (fileSizeInMB > this.maxFileSize) {
        await this.rotateLog();
      }
    } catch (error) {
      console.error('[FileManager] æ£€æŸ¥è½®è½¬å¤±è´¥:', error);
    }
  }
  
  // æ‰§è¡Œè½®è½¬
  private async rotateLog(): Promise<void> {
    const fs = require('fs');
    
    try {
      const backupPath = this.generateBackupPath();
      
      // é‡å‘½åæ—§æ–‡ä»¶
      fs.renameSync(this.logFilePath, backupPath);
      
      console.log('[FileManager] æ—¥å¿—æ–‡ä»¶å·²è½®è½¬:', backupPath);
      
      // æ–°æ–‡ä»¶ä¼šåœ¨ä¸‹æ¬¡å†™å…¥æ—¶è‡ªåŠ¨åˆ›å»º
    } catch (error) {
      console.error('[FileManager] è½®è½¬å¤±è´¥:', error);
      throw error;
    }
  }
  
  // ç”Ÿæˆå¤‡ä»½è·¯å¾„
  private generateBackupPath(): string {
    const timestamp = new Date()
      .toISOString()
      .replace(/:/g, '-')
      .replace(/\./g, '-')
      .substring(0, 23);
    
    return this.logFilePath.replace('.log', `-${timestamp}.log`);
  }
  
  // æ¸…ç©ºæ—¥å¿—ï¼ˆå¸¦å¤‡ä»½ï¼‰
  async clearLogs(): Promise<void> {
    const fs = require('fs');
    
    try {
      if (!fs.existsSync(this.logFilePath)) {
        return;  // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ— éœ€æ¸…ç©º
      }
      
      // å…ˆå¤‡ä»½
      const backupPath = this.generateBackupPath();
      fs.copyFileSync(this.logFilePath, backupPath);
      
      // æ¸…ç©ºåŸæ–‡ä»¶
      fs.writeFileSync(this.logFilePath, '', 'utf8');
      
      console.log('[FileManager] æ—¥å¿—å·²æ¸…ç©ºï¼Œå¤‡ä»½:', backupPath);
    } catch (error) {
      console.error('[FileManager] æ¸…ç©ºæ—¥å¿—å¤±è´¥:', error);
      throw error;
    }
  }
  
  // è·å–æ—¥å¿—æ–‡ä»¶è·¯å¾„
  getLogFilePath(): string {
    return this.logFilePath;
  }
  
  // å¤„ç†å†™å…¥é”™è¯¯
  private async handleWriteError(error: any, logs: string[]): Promise<void> {
    if (error.code === 'ENOSPC') {
      // ç£ç›˜ç©ºé—´ä¸è¶³
      console.error('[FileManager] ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œå°è¯•æ¸…ç†...');
      await this.cleanupOldBackups();
      // é‡è¯•ä¸€æ¬¡
      try {
        await this.writeLogs(logs);
      } catch (e) {
        console.error('[FileManager] æ¸…ç†åä»å¤±è´¥ï¼Œæ—¥å¿—å·²ä¸¢å¤±');
      }
    } else if (error.code === 'EACCES') {
      // æƒé™ä¸è¶³
      console.error('[FileManager] æƒé™ä¸è¶³ï¼Œè¯·æ£€æŸ¥ç›®å½•æƒé™');
    } else {
      // å…¶ä»–é”™è¯¯
      console.error('[FileManager] æœªçŸ¥é”™è¯¯:', error);
    }
  }
  
  // æ¸…ç†æ—§å¤‡ä»½
  private async cleanupOldBackups(): Promise<void> {
    const fs = require('fs');
    const path = require('path');
    
    try {
      const files = fs.readdirSync(this.logDir);
      const backups = files.filter((f: string) => 
        f.startsWith('obsidian-debug-') && f.endsWith('.log')
      );
      
      // æŒ‰ä¿®æ”¹æ—¶é—´æ’åºï¼Œåˆ é™¤æœ€è€çš„
      backups
        .map((f: string) => ({
          name: f,
          path: path.join(this.logDir, f),
          mtime: fs.statSync(path.join(this.logDir, f)).mtime
        }))
        .sort((a, b) => a.mtime - b.mtime)
        .slice(0, 5)  // åˆ é™¤æœ€è€çš„5ä¸ª
        .forEach(file => {
          try {
            fs.unlinkSync(file.path);
            console.log('[FileManager] å·²åˆ é™¤æ—§å¤‡ä»½:', file.name);
          } catch (e) {
            // åˆ é™¤å¤±è´¥ä¸å½±å“æµç¨‹
          }
        });
    } catch (error) {
      console.error('[FileManager] æ¸…ç†å¤‡ä»½å¤±è´¥:', error);
    }
  }
}
```

#### 2.4 æ—¥å¿—ç»Ÿè®¡æ¨¡å—ï¼ˆLog Statsï¼‰

**æ¨¡å—èŒè´£**:
```
æ ¸å¿ƒèŒè´£ï¼š
1. è¯»å–å’Œåˆ†ææ—¥å¿—æ–‡ä»¶
2. æä¾›ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¤§å°ã€è¡Œæ•°ã€é”™è¯¯æ•°ç­‰ï¼‰
3. æ ¼å¼åŒ–ç»Ÿè®¡ç»“æœ
4. æ”¯æŒå®æ—¶æ›´æ–°
5. ä¼˜åŒ–è¯»å–æ€§èƒ½
```

**ç»Ÿè®¡ä¿¡æ¯ç»“æ„**:

```typescript
interface LogStatistics {
  filePath: string;          // æ—¥å¿—æ–‡ä»¶è·¯å¾„
  fileSize: number;          // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  fileSizeFormatted: string; // æ ¼å¼åŒ–å¤§å°ï¼ˆ1.2 MBï¼‰
  totalLines: number;        // æ€»è¡Œæ•°
  logCount: number;          // [LOG] çº§åˆ«æ•°é‡
  errorCount: number;        // [ERROR] çº§åˆ«æ•°é‡
  warnCount: number;         // [WARN] çº§åˆ«æ•°é‡
  debugCount: number;        // [DEBUG] çº§åˆ«æ•°é‡
  lastModified: number;      // æœ€åä¿®æ”¹æ—¶é—´æˆ³
  lastModifiedFormatted: string;  // æ ¼å¼åŒ–æ—¶é—´ï¼ˆ2åˆ†é’Ÿå‰ï¼‰
  firstLogTime: string | null;    // ç¬¬ä¸€æ¡æ—¥å¿—æ—¶é—´
  lastLogTime: string | null;     // æœ€åä¸€æ¡æ—¥å¿—æ—¶é—´
  averageLineLength: number;      // å¹³å‡è¡Œé•¿åº¦
  errorRate: number;              // é”™è¯¯ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰
}
```

**ç»Ÿè®¡å®ç°**:

```typescript
export class LogStats {
  constructor(private logFilePath: string) {}
  
  async getStatistics(): Promise<LogStatistics> {
    const fs = require('fs');
    
    const defaultStats: LogStatistics = {
      filePath: this.logFilePath,
      fileSize: 0,
      fileSizeFormatted: '0 B',
      totalLines: 0,
      logCount: 0,
      errorCount: 0,
      warnCount: 0,
      debugCount: 0,
      lastModified: 0,
      lastModifiedFormatted: 'ä»æœªæ›´æ–°',
      firstLogTime: null,
      lastLogTime: null,
      averageLineLength: 0,
      errorRate: 0
    };
    
    try {
      // æ­¥éª¤1ï¼šæ£€æŸ¥æ–‡ä»¶å­˜åœ¨
      if (!fs.existsSync(this.logFilePath)) {
        return defaultStats;
      }
      
      // æ­¥éª¤2ï¼šè·å–æ–‡ä»¶å…ƒä¿¡æ¯
      const stats = fs.statSync(this.logFilePath);
      defaultStats.fileSize = stats.size;
      defaultStats.fileSizeFormatted = this.formatFileSize(stats.size);
      defaultStats.lastModified = stats.mtimeMs;
      defaultStats.lastModifiedFormatted = this.formatTime(stats.mtimeMs);
      
      // æ­¥éª¤3ï¼šè¯»å–æ–‡ä»¶å†…å®¹
      const content = fs.readFileSync(this.logFilePath, 'utf8');
      const lines = content.split('\n').filter((line: string) => line.trim() !== '');
      
      defaultStats.totalLines = lines.length;
      
      // æ­¥éª¤4ï¼šç»Ÿè®¡å„çº§åˆ«æ•°é‡
      let totalLength = 0;
      
      for (const line of lines) {
        totalLength += line.length;
        
        if (line.includes('[LOG]')) {
          defaultStats.logCount++;
        } else if (line.includes('[ERROR]')) {
          defaultStats.errorCount++;
        } else if (line.includes('[WARN]')) {
          defaultStats.warnCount++;
        } else if (line.includes('[DEBUG]')) {
          defaultStats.debugCount++;
        }
      }
      
      // æ­¥éª¤5ï¼šæå–ç¬¬ä¸€æ¡å’Œæœ€åä¸€æ¡æ—¥å¿—æ—¶é—´
      if (lines.length > 0) {
        const firstLine = lines[0];
        const lastLine = lines[lines.length - 1];
        
        const timeRegex = /\[(\d{2}:\d{2}:\d{2}\.\d{3})\]/;
        const firstMatch = firstLine.match(timeRegex);
        const lastMatch = lastLine.match(timeRegex);
        
        if (firstMatch) defaultStats.firstLogTime = firstMatch[1];
        if (lastMatch) defaultStats.lastLogTime = lastMatch[1];
      }
      
      // æ­¥éª¤6ï¼šè®¡ç®—æ´¾ç”ŸæŒ‡æ ‡
      if (lines.length > 0) {
        defaultStats.averageLineLength = Math.round(totalLength / lines.length);
      }
      
      const totalLogs = defaultStats.logCount + defaultStats.errorCount + 
                        defaultStats.warnCount + defaultStats.debugCount;
      if (totalLogs > 0) {
        defaultStats.errorRate = (defaultStats.errorCount / totalLogs) * 100;
      }
      
      return defaultStats;
      
    } catch (error) {
      console.error('[LogStats] è·å–ç»Ÿè®¡å¤±è´¥:', error);
      return defaultStats;
    }
  }
  
  // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
  formatFileSize(bytes: number): string {
    if (bytes === 0) return '0 B';
    const k = 1024;
    const sizes = ['B', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
  }
  
  // æ ¼å¼åŒ–æ—¶é—´ï¼ˆç›¸å¯¹æ—¶é—´ï¼‰
  formatTime(timestamp: number): string {
    if (timestamp === 0) return 'ä»æœªæ›´æ–°';
    
    const now = Date.now();
    const diff = now - timestamp;
    
    const seconds = Math.floor(diff / 1000);
    const minutes = Math.floor(seconds / 60);
    const hours = Math.floor(minutes / 60);
    const days = Math.floor(hours / 24);
    
    if (seconds < 10) return 'åˆšåˆš';
    if (seconds < 60) return `${seconds} ç§’å‰`;
    if (minutes < 60) return `${minutes} åˆ†é’Ÿå‰`;
    if (hours < 24) return `${hours} å°æ—¶å‰`;
    if (days < 30) return `${days} å¤©å‰`;
    
    return new Date(timestamp).toLocaleDateString();
  }
}
```

#### 2.5 å‘½ä»¤é¢æ¿æ¨¡å—

**å‘½ä»¤è®¾è®¡åŸåˆ™**:
```
å‘½ä»¤è®¾è®¡è¦æ±‚ï¼š
1. ç®€æ´æ˜äº†ï¼šå‘½ä»¤åç§°æ¸…æ™°è¡¨è¾¾åŠŸèƒ½
2. è¡¨æƒ…ç¬¦å·ï¼šä½¿ç”¨emojiå¢å¼ºå¯è¯†åˆ«æ€§  
3. å¿«æ·è®¿é—®ï¼šå¸¸ç”¨å‘½ä»¤æ’åœ¨å‰é¢
4. åˆ†ç»„æ¸…æ™°ï¼šæ—¥å¿—å‘½ä»¤å’ŒAuto-Reloadå‘½ä»¤åˆ†å¼€
5. ä¸€è‡´æ€§ï¼šå‘½ä»¤é£æ ¼ç»Ÿä¸€
```

**å·²å®ç°çš„å‘½ä»¤æ¸…å•**:

```
æ—¥å¿—æ¨¡å—å‘½ä»¤ï¼ˆ4ä¸ªï¼‰ï¼š

å‘½ä»¤1ï¼šæ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶è·¯å¾„
â”œâ”€ IDï¼šshow-log-path
â”œâ”€ åç§°ï¼šğŸ“‹ æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶è·¯å¾„
â”œâ”€ å¿«æ·é”®ï¼šæ— ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶çš„å®Œæ•´è·¯å¾„
â”‚  â”œâ”€ è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿
â”‚  â”œâ”€ æ˜¾ç¤º5ç§’é€šçŸ¥
â”‚  â””â”€ ä¾¿äºå¿«é€Ÿè®¿é—®
â”œâ”€ å®ç°ï¼š
â”‚  â”œâ”€ è·å– loggerModule.getLogFilePath()
â”‚  â”œâ”€ navigator.clipboard.writeText()
â”‚  â””â”€ new Notice()
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ éœ€è¦åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€
   â”œâ”€ éœ€è¦åœ¨å…¶ä»–å·¥å…·ä¸­è®¿é—®
   â””â”€ éœ€è¦åˆ†äº«ç»™ä»–äºº

å‘½ä»¤2ï¼šæ¸…ç©ºå…¨å±€æ—¥å¿—
â”œâ”€ IDï¼šclear-global-logs
â”œâ”€ åç§°ï¼šğŸ—‘ï¸ æ¸…ç©ºå…¨å±€æ—¥å¿—
â”œâ”€ å¿«æ·é”®ï¼šæ— ï¼ˆé¿å…è¯¯è§¦ï¼‰
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ æ¸…ç©ºå½“å‰æ—¥å¿—æ–‡ä»¶å†…å®¹
â”‚  â”œâ”€ è‡ªåŠ¨å¤‡ä»½åˆ°å¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶
â”‚  â”œâ”€ æ˜¾ç¤ºå¤‡ä»½æ–‡ä»¶è·¯å¾„
â”‚  â””â”€ ç¡®è®¤æ“ä½œå®Œæˆ
â”œâ”€ å®ç°ï¼š
â”‚  â”œâ”€ è°ƒç”¨ loggerModule.clearLogs()
â”‚  â”œâ”€ å†…éƒ¨æ‰§è¡Œå¤‡ä»½å’Œæ¸…ç©º
â”‚  â””â”€ æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ å¼€å§‹æ–°çš„è°ƒè¯•ä¼šè¯
   â”œâ”€ æ—¥å¿—æ–‡ä»¶è¿‡å¤§
   â””â”€ æµ‹è¯•æ—¥å¿—æ”¶é›†åŠŸèƒ½

å‘½ä»¤3ï¼šæ‰“å¼€æ—¥å¿—æ–‡ä»¶å¤¹
â”œâ”€ IDï¼šopen-log-folder
â”œâ”€ åç§°ï¼šğŸ“‚ æ‰“å¼€æ—¥å¿—æ–‡ä»¶å¤¹
â”œâ”€ å¿«æ·é”®ï¼šæ— 
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ åœ¨ç³»ç»Ÿæ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€æ—¥å¿—ç›®å½•
â”‚  â”œâ”€ Windowsï¼šä½¿ç”¨ Explorer
â”‚  â”œâ”€ macOSï¼šä½¿ç”¨ Finder
â”‚  â”œâ”€ Linuxï¼šä½¿ç”¨é»˜è®¤æ–‡ä»¶ç®¡ç†å™¨
â”‚  â””â”€ ç›´æ¥æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
â”œâ”€ å®ç°ï¼š
â”‚  â”œâ”€ è·å–æ—¥å¿—ç›®å½•è·¯å¾„
â”‚  â”œâ”€ require('electron').shell.openPath()
â”‚  â””â”€ è·¨å¹³å°å…¼å®¹
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
   â”œâ”€ æ‰‹åŠ¨ç®¡ç†å¤‡ä»½æ–‡ä»¶
   â””â”€ å¯¼å‡ºæ—¥å¿—æ–‡ä»¶

å‘½ä»¤4ï¼šæ˜¾ç¤ºæ—¥å¿—ç»Ÿè®¡
â”œâ”€ IDï¼šshow-log-stats
â”œâ”€ åç§°ï¼šğŸ“Š æ˜¾ç¤ºæ—¥å¿—ç»Ÿè®¡
â”œâ”€ å¿«æ·é”®ï¼šæ— 
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ è¯»å–æ—¥å¿—æ–‡ä»¶å¹¶åˆ†æ
â”‚  â”œâ”€ ç»Ÿè®¡æ–‡ä»¶å¤§å°ã€è¡Œæ•°
â”‚  â”œâ”€ ç»Ÿè®¡é”™è¯¯ã€è­¦å‘Šã€è°ƒè¯•æ•°é‡
â”‚  â”œâ”€ è®¡ç®—é”™è¯¯ç‡
â”‚  â”œâ”€ æ˜¾ç¤ºæœ€åæ›´æ–°æ—¶é—´
â”‚  â””â”€ ä»¥é€šçŸ¥å½¢å¼å±•ç¤ºï¼ˆ8ç§’ï¼‰
â”œâ”€ å®ç°ï¼š
â”‚  â”œâ”€ åˆ›å»º LogStats å®ä¾‹
â”‚  â”œâ”€ è°ƒç”¨ getStatistics()
â”‚  â”œâ”€ æ ¼å¼åŒ–ä¸ºå¯è¯»æ–‡æœ¬
â”‚  â””â”€ new Notice(message, 8000)
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ å¿«é€Ÿäº†è§£æ—¥å¿—çŠ¶æ€
   â”œâ”€ æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡é”™è¯¯
   â””â”€ ç›‘æ§æ—¥å¿—æ–‡ä»¶å¢é•¿

Auto-Reloadæ¨¡å—å‘½ä»¤ï¼ˆ6ä¸ªï¼‰ï¼š

å‘½ä»¤5ï¼šåˆ‡æ¢åˆ°æ™ºèƒ½ç›‘æ§æ¨¡å¼
â”œâ”€ IDï¼šswitch-to-smart-mode
â”œâ”€ åç§°ï¼šğŸ§  åˆ‡æ¢åˆ°æ™ºèƒ½ç›‘æ§æ¨¡å¼
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ è®¾ç½® mode = 'smart'
â”‚  â”œâ”€ ä¿å­˜é…ç½®
â”‚  â”œâ”€ æ›´æ–°ç›‘æ§åˆ—è¡¨
â”‚  â””â”€ è‡ªåŠ¨è¯†åˆ«å¼€å‘æ’ä»¶
â”œâ”€ å®ç°ï¼š
â”‚  â”œâ”€ this.settings.autoReload.mode = 'smart'
â”‚  â”œâ”€ await this.saveSettings()
â”‚  â””â”€ await this.autoReloadModule.updateWatchList()
â””â”€ ä½¿ç”¨åœºæ™¯ï¼šä»å…¶ä»–æ¨¡å¼å¿«é€Ÿåˆ‡æ¢

å‘½ä»¤6ï¼šåˆ‡æ¢åˆ°è‡ªåŠ¨ç›‘æ§æ¨¡å¼
â”œâ”€ IDï¼šswitch-to-auto-mode
â”œâ”€ åç§°ï¼šğŸ¤– åˆ‡æ¢åˆ°è‡ªåŠ¨ç›‘æ§æ¨¡å¼
â”œâ”€ åŠŸèƒ½ï¼šç›‘æ§æ‰€æœ‰å·²å¯ç”¨æ’ä»¶
â””â”€ ä½¿ç”¨åœºæ™¯ï¼šåŒæ—¶å¼€å‘å¤šä¸ªæ’ä»¶

å‘½ä»¤7ï¼šåˆ‡æ¢åˆ°æ‰‹åŠ¨ç›‘æ§æ¨¡å¼
â”œâ”€ IDï¼šswitch-to-manual-mode
â”œâ”€ åç§°ï¼šâœ‹ åˆ‡æ¢åˆ°æ‰‹åŠ¨ç›‘æ§æ¨¡å¼
â”œâ”€ åŠŸèƒ½ï¼šä½¿ç”¨ç”¨æˆ·é€‰æ‹©çš„æ’ä»¶åˆ—è¡¨
â””â”€ ä½¿ç”¨åœºæ™¯ï¼šç²¾ç¡®æ§åˆ¶ç›‘æ§èŒƒå›´

å‘½ä»¤8ï¼šåˆ·æ–°ç›‘æ§åˆ—è¡¨
â”œâ”€ IDï¼šrefresh-watch-list
â”œâ”€ åç§°ï¼šğŸ”„ åˆ·æ–°ç›‘æ§åˆ—è¡¨
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ é‡æ–°è·å–å½“å‰æ¨¡å¼çš„æ’ä»¶åˆ—è¡¨
â”‚  â”œâ”€ æ™ºèƒ½æ¨¡å¼ï¼šé‡æ–°è¯†åˆ«
â”‚  â”œâ”€ è‡ªåŠ¨æ¨¡å¼ï¼šé‡æ–°è·å–å·²å¯ç”¨åˆ—è¡¨
â”‚  â””â”€ æ‰‹åŠ¨æ¨¡å¼ï¼šéªŒè¯åˆ—è¡¨æœ‰æ•ˆæ€§
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ å®‰è£…äº†æ–°æ’ä»¶
   â”œâ”€ å¯ç”¨/ç¦ç”¨äº†æ’ä»¶
   â””â”€ æ‰‹åŠ¨è§¦å‘æ›´æ–°

å‘½ä»¤9ï¼šæ˜¾ç¤ºAuto-ReloadçŠ¶æ€
â”œâ”€ IDï¼šshow-autoreload-status
â”œâ”€ åç§°ï¼šğŸ¤– æ˜¾ç¤º Auto-Reload çŠ¶æ€
â”œâ”€ åŠŸèƒ½ï¼š
â”‚  â”œâ”€ æ˜¾ç¤ºå½“å‰ç›‘æ§æ¨¡å¼
â”‚  â”œâ”€ æ˜¾ç¤ºç›‘æ§æ’ä»¶åˆ—è¡¨
â”‚  â”œâ”€ æ˜¾ç¤ºæ£€æŸ¥é—´éš”
â”‚  â””â”€ æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€
â””â”€ ä½¿ç”¨åœºæ™¯ï¼š
   â”œâ”€ éªŒè¯Auto-Reloadæ˜¯å¦å·¥ä½œ
   â”œâ”€ æŸ¥çœ‹ç›‘æ§å“ªäº›æ’ä»¶
   â””â”€ è°ƒè¯•ç›‘æ§é—®é¢˜

å‘½ä»¤10ï¼šï¼ˆæœªæ¥ï¼‰æ‰‹åŠ¨è§¦å‘é‡è½½
â”œâ”€ IDï¼šmanual-reload-plugin
â”œâ”€ åç§°ï¼šğŸ”„ æ‰‹åŠ¨è§¦å‘æ’ä»¶é‡è½½
â”œâ”€ åŠŸèƒ½ï¼šè¾“å…¥æ’ä»¶IDï¼Œç«‹å³é‡è½½
â””â”€ çŠ¶æ€ï¼šè®¡åˆ’ä¸­ï¼ˆv1.1ï¼‰
```

#### 2.6 è®¾ç½®ç•Œé¢æ¨¡å—ï¼ˆSettings UIï¼‰

**æ¨¡å—èŒè´£è¯¦è§£**:
```
æ ¸å¿ƒèŒè´£ï¼š
1. æä¾›ç”¨æˆ·å‹å¥½çš„å¯è§†åŒ–é…ç½®ç•Œé¢
2. æ•´åˆæ—¥å¿—æ¨¡å—å’ŒAuto-Reloadæ¨¡å—çš„æ‰€æœ‰é…ç½®é¡¹
3. å®æ—¶æ˜¾ç¤ºç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
4. æä¾›å¿«æ·æ“ä½œæŒ‰é’®å’Œæ‰¹é‡æ“ä½œåŠŸèƒ½
5. éªŒè¯ç”¨æˆ·è¾“å…¥å¹¶æä¾›å³æ—¶åé¦ˆ
6. æ”¯æŒé…ç½®çš„å¯¼å‡ºå’Œå¯¼å…¥ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
```

**ç•Œé¢å¸ƒå±€è¯¦ç»†è®¾è®¡**:

```
è®¾ç½®é¡µé¢å®Œæ•´å¸ƒå±€ç»“æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ‡é¢˜æ                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Obsidian Logger è®¾ç½®                                 â”‚ â”‚
â”‚ â”‚ ç‰ˆæœ¬ 1.0.0                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¬¬ä¸€éƒ¨åˆ†ï¼šğŸ“ æ—¥å¿—æ¨¡å—è®¾ç½®                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ—¥å¿—æ–‡ä»¶è®¾ç½®                                         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆåªè¯»ï¼‰                           â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [æ˜¾ç¤ºå®Œæ•´è·¯å¾„]                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [ğŸ“‹ å¤åˆ¶æŒ‰é’®] [ğŸ“‚ æ‰“å¼€æŒ‰é’®]                   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ è¯´æ˜æ–‡å­—ï¼šæ—¥å¿—ä¿å­˜åœ¨Vaultå¤–éƒ¨...              â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ æ€§èƒ½é…ç½®                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ ç¼“å†²åŒºå¤§å°ï¼š[æ•°å­—è¾“å…¥æ¡†] æ¡                   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ èŒƒå›´ï¼š1-1000ï¼Œé»˜è®¤100                         â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ è¯´æ˜ï¼šè¾¾åˆ°æ­¤æ•°é‡è‡ªåŠ¨åˆ·æ–°                      â”‚   â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚ â”‚ â”‚ åˆ·æ–°é—´éš”ï¼š[æ•°å­—è¾“å…¥æ¡†] æ¯«ç§’                   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ èŒƒå›´ï¼š100-5000ï¼Œé»˜è®¤500                       â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ è¯´æ˜ï¼šå®šæ—¶åˆ·æ–°åˆ°ç£ç›˜                          â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ æ—¥å¿—ç®¡ç†                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] å¯ç”¨æ—¥å¿—è½®è½¬                              â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ æ–‡ä»¶å¤§å°ä¸Šé™ï¼š[æ•°å­—] MBï¼ˆ1-100ï¼Œé»˜è®¤10ï¼‰      â”‚   â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] è‡ªåŠ¨æ¸…ç†æ—§æ—¥å¿—                            â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ ä¿ç•™å¤©æ•°ï¼š[æ•°å­—] å¤©ï¼ˆ1-365ï¼Œé»˜è®¤30ï¼‰          â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ å¿«æ·æ“ä½œ                                             â”‚ â”‚
â”‚ â”‚ [ğŸ“Š ç»Ÿè®¡] [ğŸ—‘ï¸ æ¸…ç©º] [ğŸ“‚ æ‰“å¼€]                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¬¬äºŒéƒ¨åˆ†ï¼šğŸ¤– Auto-Reload æ¨¡å—è®¾ç½®                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç›‘æ§æ¨¡å¼                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ ç›‘æ§æ¨¡å¼ï¼š[ä¸‹æ‹‰èœå•â–¼]                         â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ é€‰é¡¹ï¼š                                         â”‚   â”‚ â”‚
â”‚ â”‚ â”‚   â€¢ ğŸ¤– è‡ªåŠ¨æ¨¡å¼                               â”‚   â”‚ â”‚
â”‚ â”‚ â”‚   â€¢ ğŸ§  æ™ºèƒ½æ¨¡å¼ï¼ˆå½“å‰é€‰ä¸­ï¼‰                   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚   â€¢ âœ‹ æ‰‹åŠ¨æ¨¡å¼                               â”‚   â”‚ â”‚
â”‚ â”‚ â”‚                                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ å½“å‰æ¨¡å¼è¯´æ˜ï¼š                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ æ™ºèƒ½æ¨¡å¼ä¼šè‡ªåŠ¨è¯†åˆ«å¼€å‘ä¸­çš„æ’ä»¶...             â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ ã€æ™ºèƒ½æ¨¡å¼ä¸“å±é…ç½®ã€‘ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰                     â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ æ™ºèƒ½è¯†åˆ«é˜ˆå€¼ï¼š[24] å°æ—¶                        â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [ğŸ” ç«‹å³é‡æ–°è¯†åˆ«æŒ‰é’®]                         â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ ã€æ‰‹åŠ¨æ¨¡å¼ä¸“å±é…ç½®ã€‘ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰                     â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ ç›‘æ§æ’ä»¶åˆ—è¡¨                                   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“å…¨é€‰] [âœ—æ¸…ç©º] [ğŸ§ æ™ºèƒ½è¯†åˆ«]                 â”‚   â”‚ â”‚
â”‚ â”‚ â”‚                                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] my-plugin-1  â”‚ 2åˆ†é’Ÿå‰ â”‚ 128KB           â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] my-plugin-2  â”‚ 1å°æ—¶å‰ â”‚ 45KB            â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [  ] other-plugin â”‚ 5å¤©å‰  â”‚ 12KB            â”‚   â”‚ â”‚
â”‚ â”‚ â”‚                                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ å·²é€‰ä¸­ï¼š2ä¸ªæ’ä»¶                                â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ ç›‘æ§æ–‡ä»¶ç±»å‹                                         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ é…ç½®æ¨¡å¼ï¼š[å…¨å±€é…ç½® â–¼]                        â”‚   â”‚ â”‚
â”‚ â”‚ â”‚   é€‰é¡¹ï¼šå…¨å±€é…ç½® / æ’ä»¶ç‰¹å®šé…ç½®               â”‚   â”‚ â”‚
â”‚ â”‚ â”‚                                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ ã€å…¨å±€æ–‡ä»¶ç±»å‹ã€‘                              â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] main.jsï¼ˆå¿…é€‰ï¼Œç¦ç”¨çŠ¶æ€ï¼‰                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] manifest.json                             â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] styles.css                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚                                                â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ è‡ªå®šä¹‰æ–‡ä»¶ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ”¯æŒé€šé…ç¬¦ï¼‰ï¼š           â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ data.json                                â”‚   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ lang/*.json                              â”‚   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ config/*.yaml                            â”‚   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”‚                                          â”‚   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ æç¤ºï¼šæ”¯æŒé€šé…ç¬¦ * åŒ¹é…ä»»æ„å­—ç¬¦              â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                       â”‚ â”‚
â”‚ â”‚ é‡è½½é…ç½®                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ æ£€æŸ¥é—´éš”ï¼š[1000] æ¯«ç§’                          â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] æ˜¾ç¤ºé‡è½½é€šçŸ¥                              â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ [âœ“] æ˜¾ç¤ºå¯åŠ¨é€šçŸ¥                              â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¬¬ä¸‰éƒ¨åˆ†ï¼šğŸ“Š è¿è¡ŒçŠ¶æ€                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ—¥å¿—æ¨¡å—çŠ¶æ€                                         â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šâœ… è¿è¡Œä¸­                                      â”‚ â”‚
â”‚ â”‚ æ–‡ä»¶ï¼š2.4 MB (12,345 è¡Œ)                            â”‚ â”‚
â”‚ â”‚ é”™è¯¯ï¼š5 | è­¦å‘Šï¼š12 | è°ƒè¯•ï¼š156                      â”‚ â”‚
â”‚ â”‚ æ›´æ–°ï¼š2ç§’å‰                                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Auto-Reloadæ¨¡å—çŠ¶æ€                                  â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šâœ… è¿è¡Œä¸­                                      â”‚ â”‚
â”‚ â”‚ æ¨¡å¼ï¼šğŸ§  æ™ºèƒ½æ¨¡å¼                                    â”‚ â”‚
â”‚ â”‚ ç›‘æ§ï¼š2ä¸ªæ’ä»¶                                        â”‚ â”‚
â”‚ â”‚ åˆ—è¡¨ï¼šmy-plugin-1, test-plugin                      â”‚ â”‚
â”‚ â”‚ ä»Šæ—¥ç»Ÿè®¡ï¼š23æ¬¡é‡è½½ï¼ŒæˆåŠŸç‡95.7%ï¼Œå¹³å‡105ms          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¬¬å››éƒ¨åˆ†ï¼šğŸ”§ é«˜çº§é€‰é¡¹                                    â”‚
â”‚ [ğŸ” æ‰“å¼€æ§åˆ¶å°] [ğŸ”„ æ¢å¤é»˜è®¤]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾ç½®ç•Œé¢äº¤äº’é€»è¾‘è¯¦è§£**:

```
ç”¨æˆ·äº¤äº’æµç¨‹ï¼š

åœºæ™¯1ï¼šä¿®æ”¹é…ç½®é¡¹
ç”¨æˆ·ä¿®æ”¹æ•°å€¼é…ç½®ï¼ˆå¦‚ç¼“å†²åŒºå¤§å°ï¼‰
  â†“
è¾“å…¥éªŒè¯ï¼ˆonChangeäº‹ä»¶ï¼‰
  â”œâ”€ æ£€æŸ¥æ•°æ®ç±»å‹ï¼ˆå¿…é¡»æ˜¯æ•°å­—ï¼‰
  â”œâ”€ æ£€æŸ¥èŒƒå›´ï¼ˆ1-1000ï¼‰
  â”œâ”€ è¶…å‡ºèŒƒå›´ â†’ æ˜¾ç¤ºé”™è¯¯æç¤º
  â””â”€ æœ‰æ•ˆ â†’ ç»§ç»­
  â†“
æ›´æ–°å†…å­˜é…ç½®
  â”œâ”€ this.plugin.settings.logger.bufferSize = value
  â””â”€ ç«‹å³ç”Ÿæ•ˆ
  â†“
ä¿å­˜åˆ°ç£ç›˜
  â”œâ”€ await this.plugin.saveSettings()
  â””â”€ å†™å…¥ data.json
  â†“
é€šçŸ¥ç›¸å…³æ¨¡å—ï¼ˆå¦‚æœéœ€è¦ï¼‰
  â”œâ”€ LogCollectorå¯èƒ½éœ€è¦é‡æ–°åˆå§‹åŒ–
  â””â”€ æˆ–é…ç½®åœ¨ä¸‹æ¬¡ä½¿ç”¨æ—¶ç”Ÿæ•ˆ
  â†“
ï¼ˆå¯é€‰ï¼‰æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
  â””â”€ ä½¿ç”¨ Notice æˆ–çŠ¶æ€æ æ›´æ–°

åœºæ™¯2ï¼šåˆ‡æ¢ç›‘æ§æ¨¡å¼
ç”¨æˆ·åˆ‡æ¢ä¸‹æ‹‰èœå•ï¼ˆsmart â†’ autoï¼‰
  â†“
onChangeäº‹ä»¶è§¦å‘
  â”œâ”€ this.plugin.settings.autoReload.mode = 'auto'
  â””â”€ await this.plugin.saveSettings()
  â†“
ç«‹å³æ›´æ–°ç›‘æ§åˆ—è¡¨
  â”œâ”€ await this.plugin.autoReloadModule.updateWatchList()
  â”œâ”€ è·å–æ–°æ¨¡å¼çš„æ’ä»¶åˆ—è¡¨
  â””â”€ æ›´æ–°FileWatcher
  â†“
é‡æ–°æ¸²æŸ“è®¾ç½®é¡µé¢
  â”œâ”€ this.display()
  â”œâ”€ éšè—æ™ºèƒ½æ¨¡å¼é…ç½®åŒº
  â”œâ”€ éšè—æ‰‹åŠ¨æ¨¡å¼é…ç½®åŒº  
  â””â”€ æ˜¾ç¤ºæ–°æ¨¡å¼çš„è¯´æ˜æ–‡å­—
  â†“
æ›´æ–°çŠ¶æ€æ˜¾ç¤ºåŒº
  â””â”€ æ˜¾ç¤ºæ–°çš„ç›‘æ§æ’ä»¶åˆ—è¡¨

åœºæ™¯3ï¼šå‹¾é€‰/å–æ¶ˆå‹¾é€‰æ’ä»¶ï¼ˆæ‰‹åŠ¨æ¨¡å¼ï¼‰
ç”¨æˆ·ç‚¹å‡»æ’ä»¶å¤é€‰æ¡†
  â†“
Toggle onChangeäº‹ä»¶
  â”œâ”€ value = true â†’ æ·»åŠ åˆ°åˆ—è¡¨
  â”‚  â””â”€ settings.watchedPlugins.push(pluginId)
  â””â”€ value = false â†’ ä»åˆ—è¡¨ç§»é™¤
     â””â”€ settings.watchedPlugins.splice(index, 1)
  â†“
ä¿å­˜é…ç½®
  â””â”€ await this.plugin.saveSettings()
  â†“
æ›´æ–°ç›‘æ§åˆ—è¡¨
  â””â”€ await this.autoReloadModule.updateWatchList()
  â†“
é‡æ–°æ¸²æŸ“
  â””â”€ æ›´æ–°"å·²é€‰ä¸­Xä¸ªæ’ä»¶"æ–‡å­—

åœºæ™¯4ï¼šç‚¹å‡»å¿«æ·æŒ‰é’®
ç”¨æˆ·ç‚¹å‡»"æ™ºèƒ½è¯†åˆ«"æŒ‰é’®
  â†“
æŒ‰é’®onClickäº‹ä»¶
  â†“
ä¸´æ—¶åˆ‡æ¢åˆ°æ™ºèƒ½æ¨¡å¼
  â”œâ”€ ä¿å­˜å½“å‰mode
  â”œâ”€ è®¾ç½®mode = 'smart'
  â””â”€ è°ƒç”¨updateWatchList()
  â†“
è·å–æ™ºèƒ½è¯†åˆ«ç»“æœ
  â”œâ”€ è¿è¡Œæ™ºèƒ½è¯†åˆ«ç®—æ³•
  â”œâ”€ å¾—åˆ°å¼€å‘æ’ä»¶åˆ—è¡¨
  â””â”€ æ¢å¤åŸmode
  â†“
æ›´æ–°æ‰‹åŠ¨æ¨¡å¼åˆ—è¡¨
  â”œâ”€ settings.watchedPlugins = æ™ºèƒ½è¯†åˆ«ç»“æœ
  â””â”€ saveSettings()
  â†“
é‡æ–°æ¸²æŸ“ç•Œé¢
  â””â”€ å‹¾é€‰è¯†åˆ«åˆ°çš„æ’ä»¶
```

**è¡¨å•éªŒè¯è§„åˆ™è¯¦è§£**:

```
éªŒè¯è§„åˆ™ä½“ç³»ï¼š

æ•°å€¼ç±»å‹éªŒè¯ï¼š
â”œâ”€ bufferSizeï¼ˆç¼“å†²åŒºå¤§å°ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šæ•´æ•°
â”‚  â”œâ”€ èŒƒå›´ï¼š1 â‰¤ value â‰¤ 1000
â”‚  â”œâ”€ é»˜è®¤ï¼š100
â”‚  â”œâ”€ é”™è¯¯æç¤ºï¼š"ç¼“å†²åŒºå¤§å°å¿…é¡»åœ¨1-1000ä¹‹é—´"
â”‚  â””â”€ å»ºè®®å€¼ï¼š50-200
â”‚
â”œâ”€ flushIntervalï¼ˆåˆ·æ–°é—´éš”ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šæ•´æ•°
â”‚  â”œâ”€ èŒƒå›´ï¼š100 â‰¤ value â‰¤ 5000
â”‚  â”œâ”€ å•ä½ï¼šæ¯«ç§’
â”‚  â”œâ”€ é»˜è®¤ï¼š500
â”‚  â”œâ”€ é”™è¯¯æç¤ºï¼š"åˆ·æ–°é—´éš”å¿…é¡»åœ¨100-5000æ¯«ç§’ä¹‹é—´"
â”‚  â””â”€ å»ºè®®å€¼ï¼š300-1000
â”‚
â”œâ”€ maxFileSizeï¼ˆæ–‡ä»¶å¤§å°ä¸Šé™ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šæ•´æ•°
â”‚  â”œâ”€ èŒƒå›´ï¼š1 â‰¤ value â‰¤ 100
â”‚  â”œâ”€ å•ä½ï¼šMB
â”‚  â”œâ”€ é»˜è®¤ï¼š10
â”‚  â”œâ”€ é”™è¯¯æç¤ºï¼š"æ–‡ä»¶å¤§å°å¿…é¡»åœ¨1-100MBä¹‹é—´"
â”‚  â””â”€ å»ºè®®å€¼ï¼š5-50
â”‚
â”œâ”€ retentionDaysï¼ˆä¿ç•™å¤©æ•°ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šæ•´æ•°
â”‚  â”œâ”€ èŒƒå›´ï¼š1 â‰¤ value â‰¤ 365
â”‚  â”œâ”€ å•ä½ï¼šå¤©
â”‚  â”œâ”€ é»˜è®¤ï¼š30
â”‚  â”œâ”€ é”™è¯¯æç¤ºï¼š"ä¿ç•™å¤©æ•°å¿…é¡»åœ¨1-365ä¹‹é—´"
â”‚  â””â”€ å»ºè®®å€¼ï¼š7-90
â”‚
â”œâ”€ checkIntervalï¼ˆæ£€æŸ¥é—´éš”ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šæ•´æ•°
â”‚  â”œâ”€ èŒƒå›´ï¼š100 â‰¤ value â‰¤ 10000
â”‚  â”œâ”€ å•ä½ï¼šæ¯«ç§’
â”‚  â”œâ”€ é»˜è®¤ï¼š1000
â”‚  â”œâ”€ é”™è¯¯æç¤ºï¼š"æ£€æŸ¥é—´éš”å¿…é¡»åœ¨100-10000æ¯«ç§’ä¹‹é—´"
â”‚  â””â”€ å»ºè®®å€¼ï¼š500-2000
â”‚
â””â”€ smartModeThresholdï¼ˆæ™ºèƒ½é˜ˆå€¼ï¼‰
   â”œâ”€ ç±»å‹ï¼šæ•´æ•°
   â”œâ”€ èŒƒå›´ï¼š1 â‰¤ value â‰¤ 168
   â”œâ”€ å•ä½ï¼šå°æ—¶
   â”œâ”€ é»˜è®¤ï¼š24
   â”œâ”€ é”™è¯¯æç¤ºï¼š"æ™ºèƒ½é˜ˆå€¼å¿…é¡»åœ¨1-168å°æ—¶ä¹‹é—´"
   â””â”€ å»ºè®®å€¼ï¼š12-48

å¸ƒå°”ç±»å‹éªŒè¯ï¼š
â”œâ”€ enableRotationï¼ˆå¯ç”¨è½®è½¬ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šå¸ƒå°”å€¼
â”‚  â”œâ”€ é»˜è®¤ï¼štrue
â”‚  â”œâ”€ UIï¼šToggleå¼€å…³
â”‚  â””â”€ æ— éœ€é¢å¤–éªŒè¯
â”‚
â”œâ”€ enableAutoCleanï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šå¸ƒå°”å€¼
â”‚  â”œâ”€ é»˜è®¤ï¼štrue
â”‚  â”œâ”€ UIï¼šToggleå¼€å…³
â”‚  â””â”€ ä¾èµ–ï¼šéœ€è¦enableRotationä¸ºtrue
â”‚
â”œâ”€ showNotificationï¼ˆæ˜¾ç¤ºé€šçŸ¥ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šå¸ƒå°”å€¼
â”‚  â”œâ”€ é»˜è®¤ï¼štrue
â”‚  â””â”€ UIï¼šToggleå¼€å…³
â”‚
â””â”€ usePluginSpecificï¼ˆä½¿ç”¨æ’ä»¶ç‰¹å®šé…ç½®ï¼‰
   â”œâ”€ ç±»å‹ï¼šå¸ƒå°”å€¼
   â”œâ”€ é»˜è®¤ï¼šfalse
   â”œâ”€ UIï¼šä¸‹æ‹‰èœå•ï¼ˆè½¬æ¢ä¸ºå…¨å±€/å•ç‹¬ï¼‰
   â””â”€ å½±å“ï¼šåˆ‡æ¢æ—¶é‡æ–°æ¸²æŸ“ç•Œé¢

å­—ç¬¦ä¸²ç±»å‹éªŒè¯ï¼š
â”œâ”€ logFilePathï¼ˆæ—¥å¿—è·¯å¾„ï¼‰
â”‚  â”œâ”€ ç±»å‹ï¼šå­—ç¬¦ä¸²
â”‚  â”œâ”€ éªŒè¯ï¼šè·¯å¾„æ ¼å¼æ£€æŸ¥
â”‚  â”œâ”€ UIï¼šåªè¯»ï¼ˆä¸å¯ç¼–è¾‘ï¼‰
â”‚  â””â”€ è¯´æ˜ï¼šé¿å…ç”¨æˆ·è¯¯æ”¹è·¯å¾„
â”‚
â””â”€ custom filesï¼ˆè‡ªå®šä¹‰æ–‡ä»¶ï¼‰
   â”œâ”€ ç±»å‹ï¼šå­—ç¬¦ä¸²æ•°ç»„
   â”œâ”€ æ ¼å¼ï¼šæ¯è¡Œä¸€ä¸ªæ–‡ä»¶å
   â”œâ”€ éªŒè¯ï¼š
   â”‚  â”œâ”€ æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«éæ³•å­—ç¬¦
   â”‚  â”œâ”€ éªŒè¯é€šé…ç¬¦è¯­æ³•
   â”‚  â””â”€ æç¤ºï¼š*.json, lang/*.jsonç­‰
   â””â”€ å¤„ç†ï¼šsplit('\n') â†’ trim() â†’ filter()

æšä¸¾ç±»å‹éªŒè¯ï¼š
â””â”€ modeï¼ˆç›‘æ§æ¨¡å¼ï¼‰
   â”œâ”€ ç±»å‹ï¼šæšä¸¾
   â”œâ”€ å¯é€‰å€¼ï¼š'auto' | 'smart' | 'manual'
   â”œâ”€ é»˜è®¤ï¼š'smart'
   â”œâ”€ UIï¼šä¸‹æ‹‰èœå•
   â””â”€ éªŒè¯ï¼šè‡ªåŠ¨ä¿è¯å€¼åœ¨æšä¸¾èŒƒå›´å†…
```

**çŠ¶æ€æ˜¾ç¤ºå®ç°**:

```typescript
// å®æ—¶çŠ¶æ€æ›´æ–°æœºåˆ¶

class CursorLoggerSettingTab {
  private statusUpdateTimer: NodeJS.Timeout | null = null;
  
  display() {
    // ... æ¸²æŸ“å…¶ä»–éƒ¨åˆ†
    
    // æ¸²æŸ“çŠ¶æ€åŒº
    this.displayStatus(containerEl);
    
    // å¯åŠ¨å®šæ—¶æ›´æ–°ï¼ˆå¯é€‰ï¼‰
    this.startStatusUpdates();
  }
  
  // æ˜¾ç¤ºæ—¥å¿—æ¨¡å—çŠ¶æ€
  private async displayLoggerStatus(containerEl: HTMLElement) {
    // è·å–å®æ—¶ç»Ÿè®¡
    const stats = await this.logStats.getStatistics();
    
    // åˆ›å»ºçŠ¶æ€å¡ç‰‡
    const card = containerEl.createDiv({ cls: 'status-card' });
    
    // è¿è¡ŒçŠ¶æ€
    card.createDiv({ 
      text: `çŠ¶æ€ï¼šâœ… è¿è¡Œä¸­`,
      cls: 'status-running'
    });
    
    // æ–‡ä»¶ä¿¡æ¯
    card.createDiv({
      text: `æ—¥å¿—æ–‡ä»¶ï¼š${this.logStats.formatFileSize(stats.fileSize)} (${stats.totalLines} è¡Œ)`
    });
    
    // ç»Ÿè®¡ä¿¡æ¯
    card.createDiv({
      text: `é”™è¯¯æ•°ï¼š${stats.errorCount} | è­¦å‘Šæ•°ï¼š${stats.warnCount} | è°ƒè¯•æ•°ï¼š${stats.debugCount}`
    });
    
    // æœ€åæ›´æ–°
    card.createDiv({
      text: `æœ€åæ›´æ–°ï¼š${this.logStats.formatTime(stats.lastModified)}`
    });
    
    // é”™è¯¯ç‡ï¼ˆå¦‚æœæœ‰é”™è¯¯ï¼‰
    if (stats.errorCount > 0) {
      const errorRate = ((stats.errorCount / stats.totalLines) * 100).toFixed(2);
      card.createDiv({
        text: `é”™è¯¯ç‡ï¼š${errorRate}%`,
        cls: stats.errorRate > 5 ? 'error-rate-high' : 'error-rate-normal'
      });
    }
  }
  
  // æ˜¾ç¤ºAuto-ReloadçŠ¶æ€
  private async displayAutoReloadStatus(containerEl: HTMLElement) {
    const status = this.plugin.autoReloadModule.getStatus();
    const reloadStats = await this.reloadStats.getTodayStatistics();
    
    const card = containerEl.createDiv({ cls: 'status-card' });
    
    // è¿è¡ŒçŠ¶æ€
    card.createDiv({
      text: `çŠ¶æ€ï¼š${status.isRunning ? 'âœ… è¿è¡Œä¸­' : 'âŒ å·²åœæ­¢'}`
    });
    
    // ç›‘æ§æ¨¡å¼
    card.createDiv({
      text: `ç›‘æ§æ¨¡å¼ï¼š${status.mode}`
    });
    
    // ç›‘æ§æ’ä»¶æ•°é‡
    card.createDiv({
      text: `ç›‘æ§æ’ä»¶ï¼š${status.watchedPlugins.length} ä¸ª`
    });
    
    // æ£€æŸ¥é—´éš”
    card.createDiv({
      text: `æ£€æŸ¥é—´éš”ï¼š${status.checkInterval}ms`
    });
    
    // ç›‘æ§åˆ—è¡¨
    if (status.watchedPlugins.length > 0) {
      card.createEl('br');
      card.createDiv({ text: 'æ­£åœ¨ç›‘æ§ï¼š' });
      
      for (const pluginId of status.watchedPlugins) {
        const app = this.app as any;
        const pluginName = app.plugins.plugins[pluginId]?.manifest?.name || pluginId;
        card.createDiv({ text: `  â€¢ ${pluginName}` });
      }
    }
    
    // ä»Šæ—¥ç»Ÿè®¡
    if (reloadStats.totalReloads > 0) {
      card.createEl('br');
      card.createDiv({ text: 'ä»Šæ—¥ç»Ÿè®¡ï¼š' });
      card.createDiv({ text: `  æ€»é‡è½½ï¼š${reloadStats.totalReloads} æ¬¡` });
      card.createDiv({ text: `  æˆåŠŸç‡ï¼š${reloadStats.successRate.toFixed(1)}%` });
      card.createDiv({ text: `  å¹³å‡è€—æ—¶ï¼š${reloadStats.averageDuration}ms` });
    }
  }
  
  // å¯åŠ¨çŠ¶æ€è‡ªåŠ¨æ›´æ–°ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
  private startStatusUpdates() {
    // æ¯5ç§’æ›´æ–°ä¸€æ¬¡çŠ¶æ€æ˜¾ç¤º
    this.statusUpdateTimer = setInterval(() => {
      this.refreshStatus();
    }, 5000);
  }
  
  // åˆ·æ–°çŠ¶æ€
  private async refreshStatus() {
    // åªæ›´æ–°çŠ¶æ€åŒºï¼Œä¸é‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢
    const statusContainers = this.containerEl.querySelectorAll('.status-card');
    
    // æ›´æ–°æ—¥å¿—çŠ¶æ€
    const logStats = await this.logStats.getStatistics();
    // ... æ›´æ–°DOMå…ƒç´ 
    
    // æ›´æ–°Auto-ReloadçŠ¶æ€
    const status = this.plugin.autoReloadModule.getStatus();
    // ... æ›´æ–°DOMå…ƒç´ 
  }
  
  // æ¸…ç†
  hide() {
    if (this.statusUpdateTimer) {
      clearInterval(this.statusUpdateTimer);
      this.statusUpdateTimer = null;
    }
  }
}
```

**å¿«æ·æ“ä½œæŒ‰é’®å®ç°**:

```typescript
// å¿«æ·æ“ä½œæŒ‰é’®è®¾è®¡

// æ—¥å¿—æ¨¡å—å¿«æ·æ“ä½œ
private addLoggerQuickActions(setting: Setting) {
  // æŸ¥çœ‹ç»Ÿè®¡æŒ‰é’®
  setting.addButton(button => button
    .setButtonText('ğŸ“Š æŸ¥çœ‹ç»Ÿè®¡')
    .setTooltip('æ˜¾ç¤ºè¯¦ç»†çš„æ—¥å¿—ç»Ÿè®¡ä¿¡æ¯')
    .onClick(async () => {
      const stats = await this.logStats.getStatistics();
      
      const message = `
ğŸ“Š æ—¥å¿—ç»Ÿè®¡è¯¦æƒ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ æ–‡ä»¶è·¯å¾„ï¼š${stats.filePath}
ğŸ’¾ æ–‡ä»¶å¤§å°ï¼š${stats.fileSizeFormatted}
ğŸ“ˆ æ€»è¡Œæ•°ï¼š${stats.totalLines}
ğŸ”´ é”™è¯¯æ•°ï¼š${stats.errorCount}ï¼ˆ${stats.errorRate.toFixed(2)}%ï¼‰
ğŸŸ¡ è­¦å‘Šæ•°ï¼š${stats.warnCount}
ğŸ”µ è°ƒè¯•æ•°ï¼š${stats.debugCount}
ğŸ“ æ™®é€šæ—¥å¿—ï¼š${stats.logCount}
â±ï¸ æœ€åæ›´æ–°ï¼š${stats.lastModifiedFormatted}
ğŸ“… é¦–æ¡æ—¥å¿—ï¼š${stats.firstLogTime || 'æ— '}
ğŸ“… æœ«æ¡æ—¥å¿—ï¼š${stats.lastLogTime || 'æ— '}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      `.trim();
      
      new Notice(message, 10000);
    }));
  
  // æ¸…ç©ºæ—¥å¿—æŒ‰é’®
  setting.addButton(button => button
    .setButtonText('ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—')
    .setTooltip('æ¸…ç©ºå½“å‰æ—¥å¿—æ–‡ä»¶ï¼ˆä¼šå…ˆå¤‡ä»½ï¼‰')
    .setWarning()  // è­¦å‘Šæ ·å¼
    .onClick(async () => {
      // äºŒæ¬¡ç¡®è®¤
      const confirmed = confirm('ç¡®å®šè¦æ¸…ç©ºæ—¥å¿—æ–‡ä»¶å—ï¼Ÿ\næ—§æ—¥å¿—ä¼šè¢«å¤‡ä»½åˆ°å¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶ã€‚');
      
      if (confirmed) {
        await this.plugin.loggerModule.clearLogs();
        // åˆ·æ–°ç»Ÿè®¡æ˜¾ç¤º
        this.display();
      }
    }));
  
  // æ‰“å¼€æ–‡ä»¶å¤¹æŒ‰é’®
  setting.addButton(button => button
    .setButtonText('ğŸ“‚ æ‰“å¼€æ–‡ä»¶å¤¹')
    .setTooltip('åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€æ—¥å¿—ç›®å½•')
    .onClick(() => {
      const fs = require('fs');
      const path = require('path');
      const { shell } = require('electron');
      
      const logPath = this.plugin.loggerModule.getLogFilePath();
      const logDir = path.dirname(logPath);
      
      // è·¨å¹³å°æ‰“å¼€æ–‡ä»¶å¤¹
      shell.openPath(logDir);
    }));
}

// Auto-Reloadå¿«æ·æ“ä½œï¼ˆæ‰‹åŠ¨æ¨¡å¼ï¼‰
private addAutoReloadQuickActions(setting: Setting) {
  // å…¨é€‰æŒ‰é’®
  setting.addButton(button => button
    .setButtonText('âœ“ å…¨é€‰å·²å¯ç”¨')
    .setTooltip('å‹¾é€‰æ‰€æœ‰å·²å¯ç”¨çš„æ’ä»¶')
    .onClick(async () => {
      const allPlugins = this.plugin.autoReloadModule.getAllEnabledPlugins();
      this.plugin.settings.autoReload.watchedPlugins = allPlugins.map(p => p.id);
      
      await this.plugin.saveSettings();
      await this.plugin.autoReloadModule.updateWatchList();
      
      new Notice(`âœ… å·²å…¨é€‰ ${allPlugins.length} ä¸ªæ’ä»¶`);
      this.display();  // é‡æ–°æ¸²æŸ“
    }));
  
  // æ¸…ç©ºæŒ‰é’®
  setting.addButton(button => button
    .setButtonText('âœ— æ¸…ç©ºå…¨éƒ¨')
    .setTooltip('å–æ¶ˆå‹¾é€‰æ‰€æœ‰æ’ä»¶')
    .onClick(async () => {
      this.plugin.settings.autoReload.watchedPlugins = [];
      
      await this.plugin.saveSettings();
      await this.plugin.autoReloadModule.updateWatchList();
      
      new Notice('âœ… å·²æ¸…ç©ºç›‘æ§åˆ—è¡¨');
      this.display();
    }));
  
  // æ™ºèƒ½è¯†åˆ«æŒ‰é’®
  setting.addButton(button => button
    .setButtonText('ğŸ§  æ™ºèƒ½è¯†åˆ«')
    .setTooltip('ä½¿ç”¨æ™ºèƒ½ç®—æ³•è‡ªåŠ¨é€‰æ‹©å¼€å‘æ’ä»¶')
    .onClick(async () => {
      // ä¸´æ—¶åˆ‡æ¢åˆ°æ™ºèƒ½æ¨¡å¼
      const originalMode = this.plugin.settings.autoReload.mode;
      this.plugin.settings.autoReload.mode = 'smart';
      
      // è·å–æ™ºèƒ½è¯†åˆ«ç»“æœ
      await this.plugin.autoReloadModule.updateWatchList();
      const smartList = this.plugin.autoReloadModule.getStatus().watchedPlugins;
      
      // æ¢å¤æ‰‹åŠ¨æ¨¡å¼
      this.plugin.settings.autoReload.mode = originalMode;
      this.plugin.settings.autoReload.watchedPlugins = smartList;
      
      await this.plugin.saveSettings();
      await this.plugin.autoReloadModule.updateWatchList();
      
      new Notice(`ğŸ§  æ™ºèƒ½è¯†åˆ«å®Œæˆï¼š${smartList.length} ä¸ªå¼€å‘æ’ä»¶`);
      this.display();
    }));
}
```

**æ ·å¼å’ŒUIä¼˜åŒ–**:

```css
/* è®¾ç½®é¡µé¢è‡ªå®šä¹‰æ ·å¼ */

.cursor-logger-status-card {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 12px;
  margin: 12px 0;
}

.status-running {
  color: var(--text-success);
  font-weight: 600;
}

.status-stopped {
  color: var(--text-error);
  font-weight: 600;
}

.error-rate-high {
  color: var(--text-error);
  font-weight: bold;
}

.error-rate-normal {
  color: var(--text-muted);
}

/* æ’ä»¶åˆ—è¡¨æ ·å¼ */
.plugin-list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.plugin-info {
  color: var(--text-muted);
  font-size: 0.9em;
}
```

---

### 3. Auto-Reload æ¨¡å—è¯¦ç»†è®¾è®¡

#### 3.1 æ¨¡å—æ¶æ„è¯¦è§£

**æ¨¡å—ç»„æˆ**:

```
Auto-Reload æ¨¡å—æ¶æ„ï¼š

æ ¸å¿ƒå±‚ï¼ˆCore Layerï¼‰ï¼š
â”œâ”€ AutoReloadModuleï¼ˆä¸»æ¨¡å—ç±»ï¼‰
â”‚  â”œâ”€ èŒè´£ï¼šç»Ÿç­¹åè°ƒæ‰€æœ‰å­æ¨¡å—
â”‚  â”œâ”€ ç”Ÿå‘½å‘¨æœŸï¼šinitialize() / cleanup()
â”‚  â”œâ”€ é…ç½®ç®¡ç†ï¼šè¯»å–å’Œåº”ç”¨é…ç½®
â”‚  â””â”€ å¯¹å¤–æ¥å£ï¼šæä¾›ç»™ä¸»æ’ä»¶è°ƒç”¨
â”‚
â”œâ”€ PluginReloaderï¼ˆé‡è½½å™¨ï¼‰
â”‚  â”œâ”€ èŒè´£ï¼šæ‰§è¡Œæ’ä»¶çš„ç¦ç”¨å’Œå¯ç”¨
â”‚  â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼šreloadPlugin(pluginId)
â”‚  â”œâ”€ æ‰¹é‡é‡è½½ï¼šreloadPlugins(pluginIds[])
â”‚  â”œâ”€ æ€§èƒ½ç›‘æ§ï¼šè®°å½•é‡è½½è€—æ—¶
â”‚  â””â”€ é€šçŸ¥ç®¡ç†ï¼šå¯é€‰çš„ç”¨æˆ·é€šçŸ¥
â”‚
â”œâ”€ SmartIdentifierï¼ˆæ™ºèƒ½è¯†åˆ«å™¨ï¼‰
â”‚  â”œâ”€ èŒè´£ï¼šè¯†åˆ«å¼€å‘ä¸­çš„æ’ä»¶
â”‚  â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼šidentifyDevPlugins()
â”‚  â”œâ”€ è¯„åˆ†ç®—æ³•ï¼šcalculateScore(pluginId)
â”‚  â”œâ”€ ç‰¹å¾æ£€æµ‹ï¼š3ä¸ªç‰¹å¾å‡½æ•°
â”‚  â””â”€ ç¼“å­˜ç»“æœï¼šé¿å…é‡å¤è¯†åˆ«
â”‚
â”œâ”€ FileWatcherï¼ˆæ–‡ä»¶ç›‘å¬å™¨ï¼‰
â”‚  â”œâ”€ èŒè´£ï¼šç›‘æ§æ’ä»¶æ–‡ä»¶å˜åŒ–
â”‚  â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼šstartWatching() / stopWatching()
â”‚  â”œâ”€ æ£€æŸ¥é€»è¾‘ï¼šcheckPlugins()
â”‚  â”œâ”€ æ—¶é—´æˆ³ç¼“å­˜ï¼šMap<pluginId:filename, mtime>
â”‚  â”œâ”€ é€šé…ç¬¦æ”¯æŒï¼šgetMatchingFiles()
â”‚  â””â”€ åŠ¨æ€é…ç½®ï¼šæ”¯æŒå…¨å±€å’Œæ’ä»¶ç‰¹å®š
â”‚
â””â”€ ModeManagerï¼ˆæ¨¡å¼ç®¡ç†å™¨ï¼‰
   â”œâ”€ èŒè´£ï¼šç®¡ç†ä¸‰ç§ç›‘æ§æ¨¡å¼
   â”œâ”€ æ ¸å¿ƒæ–¹æ³•ï¼šgetWatchList(mode, config)
   â”œâ”€ æ¨¡å¼å®ç°ï¼šauto / smart / manual
   â”œâ”€ æ’ä»¶åˆ—è¡¨ï¼šgetAllEnabledPlugins()
   â””â”€ é…ç½®éªŒè¯ï¼šè¿‡æ»¤æ— æ•ˆæ’ä»¶

è¾…åŠ©å±‚ï¼ˆHelper Layerï¼‰ï¼š
â”œâ”€ types.tsï¼ˆç±»å‹å®šä¹‰ï¼‰
â”‚  â”œâ”€ PluginSettingsæ¥å£
â”‚  â”œâ”€ WatchedFileTypesæ¥å£
â”‚  â”œâ”€ WatchModeç±»å‹
â”‚  â””â”€ å„ç§é…ç½®æ¥å£
â”‚
â””â”€ utils.tsï¼ˆå·¥å…·å‡½æ•°ï¼‰
   â”œâ”€ matchPatternï¼ˆé€šé…ç¬¦åŒ¹é…ï¼‰
   â”œâ”€ getWatchedFileListï¼ˆæ–‡ä»¶åˆ—è¡¨ç”Ÿæˆï¼‰
   â”œâ”€ formatFileSizeï¼ˆæ ¼å¼åŒ–å¤§å°ï¼‰
   â””â”€ formatTimeï¼ˆæ ¼å¼åŒ–æ—¶é—´ï¼‰

æ•°æ®å±‚ï¼ˆData Layerï¼‰ï¼š
â”œâ”€ data.jsonï¼ˆé…ç½®æ–‡ä»¶ï¼‰
â”‚  â”œâ”€ æŒä¹…åŒ–å­˜å‚¨
â”‚  â”œâ”€ ä¿å­˜åœ¨.obsidian/plugins/obsidian-logger/
â”‚  â””â”€ JSONæ ¼å¼
â”‚
â””â”€ æ—¶é—´æˆ³ç¼“å­˜ï¼ˆå†…å­˜ï¼‰
   â”œâ”€ Mapç»“æ„
   â”œâ”€ é”®ï¼špluginId:filename
   â””â”€ å€¼ï¼šmtimeï¼ˆæ¯«ç§’æ—¶é—´æˆ³ï¼‰
```

**æ¨¡å—ç”Ÿå‘½å‘¨æœŸè¯¦è§£**:

```
åˆå§‹åŒ–æµç¨‹ï¼ˆinitializeï¼‰ï¼š

æ­¥éª¤1ï¼šåˆ›å»ºå­æ¨¡å—å®ä¾‹
â”œâ”€ åˆ›å»ºPluginReloader
â”‚  â”œâ”€ ä¼ å…¥ï¼šappå®ä¾‹ã€é€šçŸ¥é…ç½®
â”‚  â””â”€ å­˜å‚¨ï¼šthis.pluginReloader
â”œâ”€ åˆ›å»ºModeManager
â”‚  â”œâ”€ ä¼ å…¥ï¼šappå®ä¾‹ã€æ™ºèƒ½é˜ˆå€¼
â”‚  â””â”€ å­˜å‚¨ï¼šthis.modeManager
â”œâ”€ åˆ›å»ºFileWatcher
â”‚  â”œâ”€ ä¼ å…¥ï¼šappå®ä¾‹ã€æ£€æŸ¥é—´éš”ã€å›è°ƒå‡½æ•°ã€æ–‡ä»¶ç±»å‹è·å–å‡½æ•°
â”‚  â””â”€ å­˜å‚¨ï¼šthis.fileWatcher
â””â”€ éªŒè¯ï¼šæ‰€æœ‰å®ä¾‹åˆ›å»ºæˆåŠŸ

æ­¥éª¤2ï¼šè·å–åˆå§‹ç›‘æ§åˆ—è¡¨
â”œâ”€ è°ƒç”¨ModeManager.getWatchList()
â”œâ”€ æ ¹æ®å½“å‰modeè·å–æ’ä»¶åˆ—è¡¨
â”œâ”€ éªŒè¯æ’ä»¶æœ‰æ•ˆæ€§
â””â”€ å­˜å‚¨ï¼šthis.watchedPlugins

æ­¥éª¤3ï¼šå¯åŠ¨æ–‡ä»¶ç›‘å¬
â”œâ”€ è°ƒç”¨FileWatcher.startWatching(pluginIds)
â”œâ”€ åˆå§‹åŒ–æ—¶é—´æˆ³ç¼“å­˜
â”œâ”€ å¯åŠ¨å®šæ—¶å™¨ï¼ˆsetIntervalï¼‰
â””â”€ å¼€å§‹å‘¨æœŸæ€§æ£€æŸ¥

æ­¥éª¤4ï¼šè¾“å‡ºå¯åŠ¨æ—¥å¿—
â”œâ”€ æ˜¾ç¤ºæ¨¡å¼ä¿¡æ¯
â”œâ”€ æ˜¾ç¤ºç›‘æ§æ’ä»¶æ•°é‡
â”œâ”€ æ˜¾ç¤ºç›‘æ§æ’ä»¶åˆ—è¡¨
â”œâ”€ æ˜¾ç¤ºæ£€æŸ¥é—´éš”
â””â”€ æ ‡è®°å¯åŠ¨å®Œæˆ

æ¸…ç†æµç¨‹ï¼ˆcleanupï¼‰ï¼š

æ­¥éª¤1ï¼šåœæ­¢æ–‡ä»¶ç›‘å¬
â”œâ”€ è°ƒç”¨FileWatcher.stopWatching()
â”œâ”€ æ¸…é™¤å®šæ—¶å™¨
â”œâ”€ æ¸…ç©ºæ—¶é—´æˆ³ç¼“å­˜
â””â”€ é‡Šæ”¾ç›‘å¬èµ„æº

æ­¥éª¤2ï¼šæ¸…ç†å­æ¨¡å—
â”œâ”€ this.fileWatcher = null
â”œâ”€ this.pluginReloader = null
â”œâ”€ this.modeManager = null
â””â”€ this.watchedPlugins = []

æ­¥éª¤3ï¼šè¾“å‡ºåœæ­¢æ—¥å¿—
â””â”€ console.log('[Auto-Reload] æ¨¡å—å·²åœæ­¢')

æ­¥éª¤4ï¼šç¡®ä¿èµ„æºé‡Šæ”¾
â”œâ”€ æ£€æŸ¥æ— å†…å­˜æ³„æ¼
â”œâ”€ æ£€æŸ¥æ— æœªå…³é—­å¥æŸ„
â””â”€ æ¸…ç†å®Œæˆ
```

#### 3.2 æ™ºèƒ½è¯†åˆ«ç®—æ³•æ·±åº¦è§£æ

**ç®—æ³•è®¾è®¡å“²å­¦**:

```
è®¾è®¡åŸåˆ™ï¼š

å‡†ç¡®æ€§ä¼˜å…ˆï¼š
â”œâ”€ å®å¯æ¼æ£€ï¼Œä¸è¦è¯¯æ£€
â”œâ”€ é¿å…ç›‘æ§éå¼€å‘æ’ä»¶
â”œâ”€ å‡å°‘ä¸å¿…è¦çš„é‡è½½
â””â”€ ä¿è¯ç”¨æˆ·ä½“éªŒ

æ€§èƒ½è€ƒè™‘ï¼š
â”œâ”€ åªåœ¨å¯åŠ¨å’Œåˆ·æ–°æ—¶è¯†åˆ«
â”œâ”€ è¿è¡Œæ—¶ä¸é‡å¤è¯†åˆ«
â”œâ”€ ç¼“å­˜è¯†åˆ«ç»“æœ
â””â”€ é¿å…é¢‘ç¹æ–‡ä»¶è¯»å–

å¯é…ç½®æ€§ï¼š
â”œâ”€ é˜ˆå€¼å¯è°ƒæ•´
â”œâ”€ ç‰¹å¾æƒé‡å›ºå®šä½†åˆç†
â”œâ”€ æ”¯æŒæ‰‹åŠ¨å¹²é¢„
â””â”€ ç”¨æˆ·å¯æŸ¥çœ‹è¯„åˆ†è¿‡ç¨‹
```

**è¯„åˆ†ç®—æ³•å®Œæ•´å®ç°**:

```typescript
export class SmartIdentifier {
  private identificationCache: Map<string, number> = new Map();
  private cacheTimeout: number = 60000; // 1åˆ†é’Ÿç¼“å­˜
  
  constructor(
    private app: App,
    private smartModeThreshold: number
  ) {}
  
  async identifyDevPlugins(): Promise<string[]> {
    const app = this.app as any;
    const enabledPlugins = Array.from(app.plugins.enabledPlugins) as string[];
    const devPlugins: string[] = [];
    
    console.log('[Auto-Reload] ğŸ§  å¼€å§‹æ™ºèƒ½è¯†åˆ«å¼€å‘æ’ä»¶...');
    console.log(`[Auto-Reload] æ‰«æèŒƒå›´ï¼š${enabledPlugins.length} ä¸ªå·²å¯ç”¨æ’ä»¶`);
    
    let scannedCount = 0;
    let identifiedCount = 0;
    
    for (const pluginId of enabledPlugins) {
      // æ’é™¤è‡ªèº«
      if (pluginId === 'obsidian-logger') {
        continue;
      }
      
      scannedCount++;
      
      try {
        const score = await this.calculateScoreWithCache(pluginId);
        
        console.log(`[Auto-Reload] [${scannedCount}/${enabledPlugins.length}] ${pluginId}`);
        
        // è¯„åˆ†é˜ˆå€¼ï¼š>= 5 åˆ†è®¤ä¸ºæ˜¯å¼€å‘æ’ä»¶
        if (score >= 5) {
          devPlugins.push(pluginId);
          identifiedCount++;
          console.log(`[Auto-Reload]   âœ… æ€»åˆ†ï¼š${score} åˆ† â†’ è¯†åˆ«ä¸ºå¼€å‘æ’ä»¶`);
        } else {
          console.log(`[Auto-Reload]   âŒ æ€»åˆ†ï¼š${score} åˆ† â†’ ä¸æ˜¯å¼€å‘æ’ä»¶`);
        }
      } catch (error) {
        console.warn(`[Auto-Reload]   âš ï¸ ${pluginId} è¯†åˆ«å¤±è´¥:`, error);
      }
    }
    
    console.log(`[Auto-Reload] ğŸ§  æ™ºèƒ½è¯†åˆ«å®Œæˆï¼š`);
    console.log(`[Auto-Reload]    æ‰«æï¼š${scannedCount} ä¸ªæ’ä»¶`);
    console.log(`[Auto-Reload]    è¯†åˆ«ï¼š${identifiedCount} ä¸ªå¼€å‘æ’ä»¶`);
    console.log(`[Auto-Reload]    è¯†åˆ«ç‡ï¼š${((identifiedCount / scannedCount) * 100).toFixed(1)}%`);
    
    return devPlugins;
  }
  
  // å¸¦ç¼“å­˜çš„è¯„åˆ†è®¡ç®—
  private async calculateScoreWithCache(pluginId: string): Promise<number> {
    const cached = this.identificationCache.get(pluginId);
    
    if (cached !== undefined) {
      // ç¼“å­˜æœ‰æ•ˆæœŸå†…ç›´æ¥è¿”å›
      return cached;
    }
    
    // è®¡ç®—æ–°åˆ†æ•°
    const score = await this.calculateScore(pluginId);
    
    // ç¼“å­˜ç»“æœ
    this.identificationCache.set(pluginId, score);
    
    // å®šæ—¶æ¸…é™¤ç¼“å­˜
    setTimeout(() => {
      this.identificationCache.delete(pluginId);
    }, this.cacheTimeout);
    
    return score;
  }
  
  // è®¡ç®—è¯„åˆ†ï¼ˆè¯¦ç»†ç‰ˆæœ¬ï¼‰
  private async calculateScore(pluginId: string): Promise<number> {
    let score = 0;
    const scoreDetails: string[] = [];
    
    try {
      // ä½¿ç”¨ç›¸å¯¹è·¯å¾„
      const mainPath = `.obsidian/plugins/${pluginId}/main.js`;
      
      // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
      const adapter = this.app.vault.adapter;
      const exists = await adapter.exists(mainPath);
      
      if (!exists) {
        console.log(`[Auto-Reload]     âš ï¸ main.js ä¸å­˜åœ¨`);
        return 0;
      }
      
      // ç‰¹å¾1ï¼šSource Map æ£€æµ‹ï¼ˆ+5åˆ†ï¼‰
      const hasSourceMap = await this.checkSourceMap(mainPath);
      if (hasSourceMap) {
        score += 5;
        scoreDetails.push('Source Map: +5åˆ†');
        console.log(`[Auto-Reload]     âœ“ åŒ…å« source map (+5åˆ†)`);
      } else {
        scoreDetails.push('Source Map: 0åˆ†');
        console.log(`[Auto-Reload]     âœ— ä¸åŒ…å« source map (0åˆ†)`);
      }
      
      // ç‰¹å¾2ï¼šæœ€è¿‘ä¿®æ”¹æ£€æµ‹ï¼ˆ+3åˆ†ï¼‰
      const isRecentlyModified = await this.checkRecentModification(mainPath);
      if (isRecentlyModified) {
        score += 3;
        scoreDetails.push('æœ€è¿‘ä¿®æ”¹: +3åˆ†');
        console.log(`[Auto-Reload]     âœ“ æœ€è¿‘ä¿®æ”¹è¿‡ (+3åˆ†)`);
      } else {
        scoreDetails.push('æœ€è¿‘ä¿®æ”¹: 0åˆ†');
        console.log(`[Auto-Reload]     âœ— ä¿®æ”¹æ—¶é—´è¶…è¿‡é˜ˆå€¼ (0åˆ†)`);
      }
      
      // ç‰¹å¾3ï¼šæ–‡ä»¶å¤§å°æ£€æµ‹ï¼ˆ+2åˆ†ï¼‰
      const isLargeFile = await this.checkFileSize(mainPath);
      if (isLargeFile) {
        score += 2;
        scoreDetails.push('æ–‡ä»¶å¤§å°: +2åˆ†');
        console.log(`[Auto-Reload]     âœ“ æ–‡ä»¶è¾ƒå¤§ï¼ˆæœªå‹ç¼©ï¼‰(+2åˆ†)`);
      } else {
        scoreDetails.push('æ–‡ä»¶å¤§å°: 0åˆ†');
        console.log(`[Auto-Reload]     âœ— æ–‡ä»¶è¾ƒå° (0åˆ†)`);
      }
      
      // è®°å½•è¯„åˆ†è¯¦æƒ…
      console.log(`[Auto-Reload]     è¯„åˆ†è¯¦æƒ…ï¼š${scoreDetails.join(', ')}`);
      
    } catch (error) {
      console.error(`[Auto-Reload] è®¡ç®—è¯„åˆ†å¤±è´¥ (${pluginId}):`, error);
    }
    
    return score;
  }
  
  // ç‰¹å¾æ£€æµ‹å‡½æ•°ï¼ˆè¯¦ç»†ç‰ˆï¼‰
  
  // æ£€æµ‹Source Map
  private async checkSourceMap(filePath: string): Promise<boolean> {
    try {
      const content = await this.app.vault.adapter.read(filePath);
      
      // æ£€æµ‹å¤šç§source mapæ ‡è®°
      const markers = [
        'sourceMappingURL',
        'sourceMapping',
        '//# sourceMappingURL',
        '//@ sourceMappingURL'  // æ—§æ ¼å¼
      ];
      
      for (const marker of markers) {
        if (content.includes(marker)) {
          return true;
        }
      }
      
      return false;
    } catch (error) {
      console.error('[Auto-Reload] Source Mapæ£€æµ‹å¤±è´¥:', error);
      return false;
    }
  }
  
  // æ£€æµ‹æœ€è¿‘ä¿®æ”¹
  private async checkRecentModification(filePath: string): Promise<boolean> {
    try {
      const stats = await this.app.vault.adapter.stat(filePath);
      
      if (!stats) {
        return false;
      }
      
      const now = Date.now();
      const hoursSinceModified = (now - stats.mtime) / (1000 * 60 * 60);
      
      console.log(`[Auto-Reload]     æœ€åä¿®æ”¹ï¼š${hoursSinceModified.toFixed(1)} å°æ—¶å‰`);
      console.log(`[Auto-Reload]     é˜ˆå€¼ï¼š${this.smartModeThreshold} å°æ—¶`);
      
      return hoursSinceModified < this.smartModeThreshold;
    } catch (error) {
      console.error('[Auto-Reload] ä¿®æ”¹æ—¶é—´æ£€æµ‹å¤±è´¥:', error);
      return false;
    }
  }
  
  // æ£€æµ‹æ–‡ä»¶å¤§å°
  private async checkFileSize(filePath: string): Promise<boolean> {
    try {
      const stats = await this.app.vault.adapter.stat(filePath);
      
      if (!stats) {
        return false;
      }
      
      const sizeInKB = stats.size / 1024;
      console.log(`[Auto-Reload]     æ–‡ä»¶å¤§å°ï¼š${sizeInKB.toFixed(1)} KB`);
      console.log(`[Auto-Reload]     é˜ˆå€¼ï¼š50 KB`);
      
      // å¤§äº50KBè®¤ä¸ºæ˜¯æœªå‹ç¼©çš„å¼€å‘ç‰ˆæœ¬
      return stats.size > 50000;
    } catch (error) {
      console.error('[Auto-Reload] æ–‡ä»¶å¤§å°æ£€æµ‹å¤±è´¥:', error);
      return false;
    }
  }
}
```

**è¯†åˆ«ç®—æ³•æµ‹è¯•æ¡ˆä¾‹**:

```
æµ‹è¯•ç”¨ä¾‹1ï¼šå…¸å‹çš„å¼€å‘æ’ä»¶

æ’ä»¶ï¼šmy-awesome-plugin
æ–‡ä»¶ï¼šmain.js

æ£€æŸ¥è¿‡ç¨‹ï¼š
â”œâ”€ Source Mapæ£€æµ‹
â”‚  â”œâ”€ è¯»å–æ–‡ä»¶å†…å®¹
â”‚  â”œâ”€ æœç´¢ï¼š//# sourceMappingURL=main.js.map
â”‚  â”œâ”€ ç»“æœï¼šæ‰¾åˆ°
â”‚  â””â”€ å¾—åˆ†ï¼š+5åˆ† âœ“
â”‚
â”œâ”€ æœ€è¿‘ä¿®æ”¹æ£€æµ‹
â”‚  â”œâ”€ è·å–æ–‡ä»¶mtimeï¼š2025-11-02 18:30
â”‚  â”œâ”€ å½“å‰æ—¶é—´ï¼š2025-11-02 19:00
â”‚  â”œâ”€ æ—¶é—´å·®ï¼š0.5å°æ—¶
â”‚  â”œâ”€ é˜ˆå€¼ï¼š24å°æ—¶
â”‚  â”œâ”€ åˆ¤æ–­ï¼š0.5 < 24
â”‚  â””â”€ å¾—åˆ†ï¼š+3åˆ† âœ“
â”‚
â”œâ”€ æ–‡ä»¶å¤§å°æ£€æµ‹
â”‚  â”œâ”€ è·å–æ–‡ä»¶å¤§å°ï¼š128.5 KB
â”‚  â”œâ”€ é˜ˆå€¼ï¼š50 KB
â”‚  â”œâ”€ åˆ¤æ–­ï¼š128.5 > 50
â”‚  â””â”€ å¾—åˆ†ï¼š+2åˆ† âœ“
â”‚
â””â”€ æ€»åˆ†ï¼š10åˆ†
   â””â”€ ç»“è®ºï¼šâœ… è¯†åˆ«ä¸ºå¼€å‘æ’ä»¶

æµ‹è¯•ç”¨ä¾‹2ï¼šå·²å‘å¸ƒçš„æ’ä»¶

æ’ä»¶ï¼šobsidian-git
æ–‡ä»¶ï¼šmain.js

æ£€æŸ¥è¿‡ç¨‹ï¼š
â”œâ”€ Source Mapæ£€æµ‹
â”‚  â”œâ”€ è¯»å–æ–‡ä»¶å†…å®¹
â”‚  â”œâ”€ æœç´¢ï¼šsourceMappingURL
â”‚  â”œâ”€ ç»“æœï¼šæœªæ‰¾åˆ°ï¼ˆç”Ÿäº§ç‰ˆå·²ç§»é™¤ï¼‰
â”‚  â””â”€ å¾—åˆ†ï¼š0åˆ† âœ—
â”‚
â”œâ”€ æœ€è¿‘ä¿®æ”¹æ£€æµ‹
â”‚  â”œâ”€ è·å–æ–‡ä»¶mtimeï¼š2025-10-01 10:00
â”‚  â”œâ”€ å½“å‰æ—¶é—´ï¼š2025-11-02 19:00
â”‚  â”œâ”€ æ—¶é—´å·®ï¼š792å°æ—¶ï¼ˆ33å¤©ï¼‰
â”‚  â”œâ”€ é˜ˆå€¼ï¼š24å°æ—¶
â”‚  â”œâ”€ åˆ¤æ–­ï¼š792 > 24
â”‚  â””â”€ å¾—åˆ†ï¼š0åˆ† âœ—
â”‚
â”œâ”€ æ–‡ä»¶å¤§å°æ£€æµ‹
â”‚  â”œâ”€ è·å–æ–‡ä»¶å¤§å°ï¼š32.1 KB
â”‚  â”œâ”€ é˜ˆå€¼ï¼š50 KB
â”‚  â”œâ”€ åˆ¤æ–­ï¼š32.1 < 50
â”‚  â””â”€ å¾—åˆ†ï¼š0åˆ† âœ—
â”‚
â””â”€ æ€»åˆ†ï¼š0åˆ†
   â””â”€ ç»“è®ºï¼šâœ— ä¸æ˜¯å¼€å‘æ’ä»¶

æµ‹è¯•ç”¨ä¾‹3ï¼šè¾¹ç•Œæƒ…å†µ

æ’ä»¶ï¼šborderline-plugin
æ–‡ä»¶ï¼šmain.js

æ£€æŸ¥è¿‡ç¨‹ï¼š
â”œâ”€ Source Mapæ£€æµ‹
â”‚  â”œâ”€ ç»“æœï¼šæ‰¾åˆ°
â”‚  â””â”€ å¾—åˆ†ï¼š+5åˆ† âœ“
â”‚
â”œâ”€ æœ€è¿‘ä¿®æ”¹æ£€æµ‹
â”‚  â”œâ”€ æ—¶é—´å·®ï¼š30å°æ—¶
â”‚  â”œâ”€ é˜ˆå€¼ï¼š24å°æ—¶
â”‚  â”œâ”€ åˆ¤æ–­ï¼š30 > 24
â”‚  â””â”€ å¾—åˆ†ï¼š0åˆ† âœ—
â”‚
â”œâ”€ æ–‡ä»¶å¤§å°æ£€æµ‹
â”‚  â”œâ”€ æ–‡ä»¶å¤§å°ï¼š48 KB
â”‚  â”œâ”€ é˜ˆå€¼ï¼š50 KB
â”‚  â”œâ”€ åˆ¤æ–­ï¼š48 < 50
â”‚  â””â”€ å¾—åˆ†ï¼š0åˆ† âœ—
â”‚
â””â”€ æ€»åˆ†ï¼š5åˆ†
   â””â”€ ç»“è®ºï¼šâœ… è¯†åˆ«ä¸ºå¼€å‘æ’ä»¶ï¼ˆåˆšå¥½è¾¾åˆ°é˜ˆå€¼ï¼‰

åˆ†æï¼š
â”œâ”€ è™½ç„¶ä¿®æ”¹æ—¶é—´å’Œå¤§å°éƒ½ä¸æ»¡è¶³
â”œâ”€ ä½†åŒ…å«source mapæ˜¯å¼ºç‰¹å¾ï¼ˆ5åˆ†ï¼‰
â”œâ”€ å•ä¸€å¼ºç‰¹å¾è¶³ä»¥åˆ¤å®š
â””â”€ è¿™æ˜¯åˆç†çš„ï¼šsource mapé€šå¸¸åªåœ¨å¼€å‘ç‰ˆæœ¬ä¸­
```

**ç®—æ³•ä¼˜åŒ–å’Œæ”¹è¿›**:

```
å½“å‰ç®—æ³•ï¼ˆv1.0ï¼‰ï¼š
ç‰¹å¾1ï¼šSource Mapï¼ˆæƒé‡5ï¼‰
ç‰¹å¾2ï¼šæœ€è¿‘ä¿®æ”¹ï¼ˆæƒé‡3ï¼‰
ç‰¹å¾3ï¼šæ–‡ä»¶å¤§å°ï¼ˆæƒé‡2ï¼‰
é˜ˆå€¼ï¼šâ‰¥5åˆ†

å¯èƒ½çš„æ”¹è¿›ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰ï¼š

v1.1 æ½œåœ¨æ”¹è¿›ï¼š
â”œâ”€ ç‰¹å¾4ï¼šGitç›®å½•æ£€æµ‹ï¼ˆ+3åˆ†ï¼‰
â”‚  â””â”€ æ’ä»¶ç›®å½•åŒ…å«.gitæ–‡ä»¶å¤¹
â”œâ”€ ç‰¹å¾5ï¼špackage.jsonæ£€æµ‹ï¼ˆ+2åˆ†ï¼‰
â”‚  â””â”€ åŒ…å«devDependencies
â”œâ”€ ç‰¹å¾6ï¼šTypeScriptæºæ–‡ä»¶ï¼ˆ+2åˆ†ï¼‰
â”‚  â””â”€ åŒ…å«.tsæºæ–‡ä»¶
â””â”€ è‡ªé€‚åº”é˜ˆå€¼ï¼šæ ¹æ®ç¯å¢ƒåŠ¨æ€è°ƒæ•´

v1.2 æ½œåœ¨æ”¹è¿›ï¼š
â”œâ”€ æœºå™¨å­¦ä¹ æ¨¡å‹
â”œâ”€ ç”¨æˆ·åé¦ˆå­¦ä¹ 
â”œâ”€ æ’ä»¶ç‰¹å¾æŒ‡çº¹
â””â”€ æ›´æ™ºèƒ½çš„è¯†åˆ«

è¯„åˆ†æƒé‡è°ƒæ•´å»ºè®®ï¼š
å½“å‰æƒé‡åˆç†æ€§åˆ†æï¼š
â”œâ”€ Source Mapï¼ˆ5åˆ†ï¼‰ï¼šåˆç†
â”‚  â””â”€ è¿™æ˜¯æœ€å¼ºçš„å¼€å‘ç‰¹å¾
â”œâ”€ æœ€è¿‘ä¿®æ”¹ï¼ˆ3åˆ†ï¼‰ï¼šåˆç†
â”‚  â””â”€ å¼€å‘ä¸­æ’ä»¶é¢‘ç¹ä¿®æ”¹
â”œâ”€ æ–‡ä»¶å¤§å°ï¼ˆ2åˆ†ï¼‰ï¼šåˆç†
â”‚  â””â”€ ä½œä¸ºè¾…åŠ©ç‰¹å¾è¶³å¤Ÿ
â””â”€ æ€»è¯„ï¼šæƒé‡åˆ†é…ç§‘å­¦ï¼Œæ— éœ€è°ƒæ•´
```

#### 3.3 æ–‡ä»¶ç›‘å¬æœºåˆ¶æ·±åº¦è§£æ

**ç›‘å¬ç­–ç•¥é€‰æ‹©**:

```
æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”ï¼š

æ–¹æ¡ˆAï¼šWatchdogï¼ˆæ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ï¼‰
â”œâ”€ ä¼˜ç‚¹ï¼š
â”‚  â”œâ”€ å®æ—¶å“åº”ï¼ˆæ¯«ç§’çº§ï¼‰
â”‚  â”œâ”€ æ— è½®è¯¢å¼€é”€
â”‚  â””â”€ è·¨å¹³å°æ”¯æŒ
â”œâ”€ ç¼ºç‚¹ï¼š
â”‚  â”œâ”€ éœ€è¦é¢å¤–ä¾èµ–
â”‚  â”œâ”€ åœ¨æ’ä»¶ä¸­é›†æˆå¤æ‚
â”‚  â”œâ”€ å¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜
â”‚  â””â”€ äº‹ä»¶å¯èƒ½é—æ¼ï¼ˆé«˜é¢‘å˜åŒ–ï¼‰
â””â”€ ç»“è®ºï¼šä¸é€‚åˆObsidianæ’ä»¶ç¯å¢ƒ

æ–¹æ¡ˆBï¼šå®šæ—¶è½®è¯¢ï¼ˆå½“å‰æ–¹æ¡ˆï¼‰âœ…
â”œâ”€ ä¼˜ç‚¹ï¼š
â”‚  â”œâ”€ ç®€å•å¯é 
â”‚  â”œâ”€ æ— é¢å¤–ä¾èµ–
â”‚  â”œâ”€ è·¨å¹³å°å…¼å®¹æ€§å¥½
â”‚  â”œâ”€ å¯æ§çš„æ€§èƒ½å¼€é”€
â”‚  â””â”€ æ˜“äºè°ƒè¯•å’Œç»´æŠ¤
â”œâ”€ ç¼ºç‚¹ï¼š
â”‚  â”œâ”€ æœ‰è½®è¯¢å»¶è¿Ÿï¼ˆé»˜è®¤1ç§’ï¼‰
â”‚  â”œâ”€ æŒç»­çš„CPUå ç”¨ï¼ˆæä½<0.1%ï¼‰
â”‚  â””â”€ æ–‡ä»¶å˜åŒ–æ£€æµ‹ä¸æ˜¯å®æ—¶çš„
â””â”€ ç»“è®ºï¼šâœ… æœ€é€‚åˆå½“å‰åœºæ™¯

æ–¹æ¡ˆCï¼šæ··åˆæ–¹æ¡ˆ
â”œâ”€ ç»“åˆå®šæ—¶è½®è¯¢+æ–‡ä»¶äº‹ä»¶
â”œâ”€ å¤æ‚åº¦é«˜
â””â”€ æ”¶ç›Šä¸æ˜æ˜¾

é€‰æ‹©ç†ç”±ï¼š
1. å®šæ—¶è½®è¯¢çš„1ç§’å»¶è¿Ÿå®Œå…¨å¯æ¥å—
2. CPUå¼€é”€æä½ï¼ˆ<0.1%ï¼‰
3. å¯é æ€§é«˜ï¼Œä¸ä¼šé—æ¼å˜åŒ–
4. å®ç°ç®€å•ï¼Œç»´æŠ¤å®¹æ˜“
5. æ€§èƒ½å’ŒåŠŸèƒ½çš„æœ€ä½³å¹³è¡¡
```

**å®šæ—¶è½®è¯¢å®ç°è¯¦è§£**:

```typescript
export class FileWatcher {
  private watchTimer: NodeJS.Timeout | null = null;
  private lastModifiedTimes: Map<string, number> = new Map();
  private watchedPlugins: string[] = [];
  private getFileTypesConfig: (pluginId: string) => WatchedFileTypes;
  private checkCount: number = 0;
  private changeDetectedCount: number = 0;
  
  constructor(
    private app: App,
    private checkInterval: number,
    private onFileChanged: (pluginId: string) => void,
    getFileTypesConfig: (pluginId: string) => WatchedFileTypes
  ) {
    this.getFileTypesConfig = getFileTypesConfig;
  }
  
  startWatching(pluginIds: string[]): void {
    console.log(`[Auto-Reload] ğŸ“¡ å¼€å§‹ç›‘æ§ ${pluginIds.length} ä¸ªæ’ä»¶`);
    console.log(`[Auto-Reload]    æ£€æŸ¥é—´éš”ï¼š${this.checkInterval}ms`);
    
    this.watchedPlugins = pluginIds;
    this.checkCount = 0;
    this.changeDetectedCount = 0;
    
    // åˆå§‹åŒ–æ—¶é—´æˆ³ç¼“å­˜
    this.initializeTimestamps();
    
    // å¯åŠ¨å®šæ—¶æ£€æŸ¥
    this.watchTimer = setInterval(() => {
      this.checkPlugins();
    }, this.checkInterval);
    
    console.log(`[Auto-Reload] ğŸ“¡ ç›‘æ§å·²å¯åŠ¨`);
  }
  
  stopWatching(): void {
    if (this.watchTimer) {
      clearInterval(this.watchTimer);
      this.watchTimer = null;
    }
    
    // è¾“å‡ºç»Ÿè®¡ä¿¡æ¯
    console.log(`[Auto-Reload] ğŸ“¡ ç›‘æ§ç»Ÿè®¡ï¼š`);
    console.log(`[Auto-Reload]    æ€»æ£€æŸ¥æ¬¡æ•°ï¼š${this.checkCount}`);
    console.log(`[Auto-Reload]    æ£€æµ‹åˆ°å˜åŒ–ï¼š${this.changeDetectedCount} æ¬¡`);
    console.log(`[Auto-Reload]    å˜åŒ–ç‡ï¼š${this.checkCount > 0 ? ((this.changeDetectedCount / this.checkCount) * 100).toFixed(2) : 0}%`);
    
    this.watchedPlugins = [];
    this.lastModifiedTimes.clear();
    
    console.log('[Auto-Reload] ğŸ“¡ å·²åœæ­¢ç›‘æ§');
  }
  
  // æ£€æŸ¥æ‰€æœ‰æ’ä»¶
  private async checkPlugins(): Promise<void> {
    this.checkCount++;
    
    // æ¯100æ¬¡æ£€æŸ¥è¾“å‡ºä¸€æ¬¡æ—¥å¿—ï¼ˆé¿å…è¿‡å¤šæ—¥å¿—ï¼‰
    if (this.checkCount % 100 === 0) {
      console.log(`[Auto-Reload] ğŸ“¡ å·²å®Œæˆ ${this.checkCount} æ¬¡æ£€æŸ¥ï¼Œæ£€æµ‹åˆ° ${this.changeDetectedCount} æ¬¡å˜åŒ–`);
    }
    
    for (const pluginId of this.watchedPlugins) {
      await this.checkPluginFile(pluginId);
    }
  }
  
  // æ£€æŸ¥å•ä¸ªæ’ä»¶çš„æ‰€æœ‰æ–‡ä»¶
  private async checkPluginFile(pluginId: string): Promise<void> {
    try {
      let hasChanges = false;
      let changedFiles: string[] = [];
      
      // è·å–è¯¥æ’ä»¶è¦ç›‘æ§çš„æ–‡ä»¶åˆ—è¡¨
      const fileTypes = this.getFileTypesConfig(pluginId);
      const filesToWatch = getWatchedFileList(fileTypes);
      
      // æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
      for (const filePattern of filesToWatch) {
        if (filePattern.includes('*')) {
          // é€šé…ç¬¦ï¼šè·å–åŒ¹é…çš„æ–‡ä»¶
          const matchedFiles = await this.getMatchingFiles(pluginId, filePattern);
          
          for (const fileName of matchedFiles) {
            const changed = await this.checkSingleFile(pluginId, fileName);
            if (changed) {
              hasChanges = true;
              changedFiles.push(fileName);
            }
          }
        } else {
          // ç²¾ç¡®æ–‡ä»¶å
          const changed = await this.checkSingleFile(pluginId, filePattern);
          if (changed) {
            hasChanges = true;
            changedFiles.push(filePattern);
          }
        }
      }
      
      // å¦‚æœæœ‰å˜åŒ–ï¼Œè§¦å‘é‡è½½
      if (hasChanges) {
        this.changeDetectedCount++;
        console.log(`[Auto-Reload] ğŸ”„ æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–ï¼š${pluginId}`);
        console.log(`[Auto-Reload]    å˜åŒ–æ–‡ä»¶ï¼š${changedFiles.join(', ')}`);
        console.log(`[Auto-Reload]    ç›‘æ§æ–‡ä»¶ï¼š${filesToWatch.join(', ')}`);
        
        // è§¦å‘å›è°ƒ
        this.onFileChanged(pluginId);
      }
    } catch (error) {
      console.error(`[Auto-Reload] æ£€æŸ¥æ–‡ä»¶å¤±è´¥ (${pluginId}):`, error);
    }
  }
}
```

#### 3.4 æ–‡ä»¶ç±»å‹ç›‘æ§è¯¦ç»†è®¾è®¡

**é…ç½®å±‚æ¬¡ç»“æ„**:

```
æ–‡ä»¶ç±»å‹é…ç½®çš„ä¸‰å±‚ç»“æ„ï¼š

ç¬¬1å±‚ï¼šé»˜è®¤é…ç½®ï¼ˆä»£ç ä¸­å®šä¹‰ï¼‰
â”œâ”€ DEFAULT_WATCHED_FILES
â”œâ”€ main: trueï¼ˆå¿…é€‰ï¼‰
â”œâ”€ manifest: true
â”œâ”€ styles: true
â”œâ”€ custom: []
â””â”€ ä½œç”¨ï¼šä½œä¸ºæœ€ç»ˆå›é€€å€¼

ç¬¬2å±‚ï¼šå…¨å±€é…ç½®ï¼ˆç”¨æˆ·è®¾ç½®ï¼‰
â”œâ”€ settings.autoReload.globalWatchedFiles
â”œâ”€ é€‚ç”¨äºï¼šæ‰€æœ‰ç›‘æ§çš„æ’ä»¶
â”œâ”€ ä¼˜å…ˆçº§ï¼šé«˜äºé»˜è®¤é…ç½®
â””â”€ ä½¿ç”¨åœºæ™¯ï¼šå¤§å¤šæ•°æƒ…å†µ

ç¬¬3å±‚ï¼šæ’ä»¶ç‰¹å®šé…ç½®ï¼ˆç”¨æˆ·è®¾ç½®ï¼‰
â”œâ”€ settings.autoReload.pluginSpecificFiles[pluginId]
â”œâ”€ é€‚ç”¨äºï¼šæŒ‡å®šçš„å•ä¸ªæ’ä»¶
â”œâ”€ ä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼Œè¦†ç›–å…¨å±€é…ç½®
â””â”€ ä½¿ç”¨åœºæ™¯ï¼šç‰¹æ®Šéœ€æ±‚çš„æ’ä»¶

é…ç½®è§£æé€»è¾‘ï¼š
function getFileTypesForPlugin(pluginId: string): WatchedFileTypes {
  // ç¬¬3å±‚ï¼šæ’ä»¶ç‰¹å®šé…ç½®
  if (usePluginSpecific && pluginSpecificFiles[pluginId]) {
    console.log(`[Auto-Reload] ä½¿ç”¨æ’ä»¶ç‰¹å®šé…ç½®ï¼š${pluginId}`);
    return pluginSpecificFiles[pluginId];
  }
  
  // ç¬¬2å±‚ï¼šå…¨å±€é…ç½®
  if (globalWatchedFiles) {
    console.log(`[Auto-Reload] ä½¿ç”¨å…¨å±€é…ç½®ï¼š${pluginId}`);
    return globalWatchedFiles;
  }
  
  // ç¬¬1å±‚ï¼šé»˜è®¤é…ç½®
  console.log(`[Auto-Reload] ä½¿ç”¨é»˜è®¤é…ç½®ï¼š${pluginId}`);
  return DEFAULT_WATCHED_FILES;
}
```

**é€šé…ç¬¦åŒ¹é…å¼•æ“è¯¦è§£**:

```
é€šé…ç¬¦åŒ¹é…å®ç°ï¼š

æ”¯æŒçš„æ¨¡å¼ï¼š
1. ç²¾ç¡®åŒ¹é…ï¼šdata.json
2. åç¼€åŒ¹é…ï¼š*.json
3. å‰ç¼€åŒ¹é…ï¼šdata-*.json
4. è·¯å¾„åŒ¹é…ï¼šlang/*.json
5. ç»„åˆåŒ¹é…ï¼šconfig/*-*.yaml

åŒ¹é…ç®—æ³•ï¼š

æ­¥éª¤1ï¼šæ¨¡å¼é¢„å¤„ç†
â”œâ”€ æ£€æŸ¥æ˜¯å¦åŒ…å« *
â”œâ”€ å¦‚æœä¸åŒ…å« â†’ ç²¾ç¡®åŒ¹é…
â””â”€ å¦‚æœåŒ…å« â†’ æ­£åˆ™åŒ¹é…

æ­¥éª¤2ï¼šè½¬æ¢ä¸ºæ­£åˆ™è¡¨è¾¾å¼
â”œâ”€ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼š. + ? ^ $ { } ( ) | [ ] \
â”œâ”€ æ›¿æ¢é€šé…ç¬¦ï¼š* â†’ .*
â”œâ”€ æ·»åŠ é”šç‚¹ï¼š^ å’Œ $
â””â”€ ç¼–è¯‘æ­£åˆ™

æ­¥éª¤3ï¼šæ‰§è¡ŒåŒ¹é…
â”œâ”€ regex.test(filename)
â””â”€ è¿”å›å¸ƒå°”å€¼

å®ç°ä»£ç ï¼ˆå®Œæ•´ç‰ˆï¼‰ï¼š
function matchPattern(filename: string, pattern: string): boolean {
  // ç²¾ç¡®åŒ¹é…ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰
  if (filename === pattern) {
    return true;
  }
  
  // ä¸å«é€šé…ç¬¦
  if (!pattern.includes('*')) {
    return filename === pattern;
  }
  
  // åŒ…å«é€šé…ç¬¦ï¼Œè½¬æ¢ä¸ºæ­£åˆ™
  try {
    // è½¬ä¹‰æ­£åˆ™ç‰¹æ®Šå­—ç¬¦
    let escaped = pattern;
    const specialChars = ['.', '+', '?', '^', '$', '{', '}', '(', ')', '|', '[', ']', '\\'];
    
    for (const char of specialChars) {
      escaped = escaped.replace(new RegExp('\\' + char, 'g'), '\\' + char);
    }
    
    // æ›¿æ¢é€šé…ç¬¦
    escaped = escaped.replace(/\*/g, '.*');
    
    // åˆ›å»ºæ­£åˆ™ï¼ˆé”šå®šé¦–å°¾ï¼‰
    const regex = new RegExp(`^${escaped}$`);
    
    // æ‰§è¡ŒåŒ¹é…
    return regex.test(filename);
  } catch (error) {
    console.error('[Auto-Reload] é€šé…ç¬¦åŒ¹é…é”™è¯¯:', error);
    return false;  // åŒ¹é…å¤±è´¥æ—¶ä¿å®ˆå¤„ç†
  }
}

æµ‹è¯•ç”¨ä¾‹ï¼š
matchPattern('data.json', 'data.json')         // true  - ç²¾ç¡®
matchPattern('config.json', '*.json')          // true  - åç¼€
matchPattern('data-user.json', 'data-*.json')  // true  - ç»„åˆ
matchPattern('lang/en.json', 'lang/*.json')    // true  - è·¯å¾„
matchPattern('en.json', 'lang/*.json')         // false - ä¸åœ¨è·¯å¾„
matchPattern('lang/sub/en.json', 'lang/*.json')// false - å­ç›®å½•
```

**æ–‡ä»¶æ‰«æå®ç°**:

```typescript
// æ‰«ææ’ä»¶ç›®å½•è·å–åŒ¹é…æ–‡ä»¶

private async getMatchingFiles(pluginId: string, pattern: string): Promise<string[]> {
  try {
    const pluginDir = `.obsidian/plugins/${pluginId}`;
    const fs = require('fs');
    const path = require('path');
    const basePath = (this.app.vault.adapter as any).basePath;
    const fullPath = path.join(basePath, pluginDir);
    
    if (!fs.existsSync(fullPath)) {
      console.warn(`[Auto-Reload] æ’ä»¶ç›®å½•ä¸å­˜åœ¨ï¼š${pluginId}`);
      return [];
    }
    
    // é€’å½’æ‰«ææ‰€æœ‰æ–‡ä»¶
    const allFiles = this.listAllFiles(fullPath, '');
    
    // è¿‡æ»¤åŒ¹é…çš„æ–‡ä»¶
    const matchedFiles = allFiles.filter(file => matchPattern(file, pattern));
    
    if (matchedFiles.length > 0) {
      console.log(`[Auto-Reload] é€šé…ç¬¦åŒ¹é…ï¼š${pattern} â†’ ${matchedFiles.length} ä¸ªæ–‡ä»¶`);
      matchedFiles.forEach(f => console.log(`[Auto-Reload]    âœ“ ${f}`));
    }
    
    return matchedFiles;
  } catch (error) {
    console.error(`[Auto-Reload] è·å–åŒ¹é…æ–‡ä»¶å¤±è´¥ (${pluginId}, ${pattern}):`, error);
    return [];
  }
}

// é€’å½’åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶
private listAllFiles(dir: string, relativePath: string): string[] {
  const fs = require('fs');
  const path = require('path');
  const files: string[] = [];
  
  try {
    const entries = fs.readdirSync(dir, { withFileTypes: true });
    
    for (const entry of entries) {
      const entryRelativePath = relativePath ? 
        `${relativePath}/${entry.name}` : 
        entry.name;
      
      if (entry.isDirectory()) {
        // é€’å½’å­ç›®å½•ï¼ˆä½†ä¸è¦å¤ªæ·±ï¼‰
        if (relativePath.split('/').length < 5) {  // æœ€å¤š5å±‚
          const subFiles = this.listAllFiles(
            path.join(dir, entry.name),
            entryRelativePath
          );
          files.push(...subFiles);
        }
      } else if (entry.isFile()) {
        files.push(entryRelativePath);
      }
    }
  } catch (error) {
    // ç›®å½•è¯»å–å¤±è´¥ï¼Œè¿”å›ç©ºæ•°ç»„
    console.warn(`[Auto-Reload] è¯»å–ç›®å½•å¤±è´¥ï¼š${dir}`, error);
  }
  
  return files;
}
```

#### 3.5 æ’ä»¶é‡è½½æœºåˆ¶è¯¦è§£

**é‡è½½æµç¨‹è¯¦ç»†æ­¥éª¤**:

```
å®Œæ•´é‡è½½æµç¨‹ï¼š

å‰ç½®æ£€æŸ¥ï¼š
â”œâ”€ æ£€æŸ¥æ’ä»¶æ˜¯å¦å­˜åœ¨
â”‚  â””â”€ app.plugins.plugins[pluginId]
â”œâ”€ æ£€æŸ¥æ’ä»¶æ˜¯å¦å·²å¯ç”¨
â”‚  â””â”€ app.plugins.enabledPlugins.has(pluginId)
â”œâ”€ æ£€æŸ¥æ˜¯å¦æ˜¯è‡ªèº«
â”‚  â””â”€ pluginId !== 'obsidian-logger'
â””â”€ ä»»ä¸€æ¡ä»¶ä¸æ»¡è¶³ â†’ è·³è¿‡é‡è½½

æ‰§è¡Œé‡è½½ï¼š

æ­¥éª¤1ï¼šè®°å½•å¼€å§‹æ—¶é—´
â”œâ”€ const startTime = Date.now()
â””â”€ ç”¨äºè®¡ç®—è€—æ—¶

æ­¥éª¤2ï¼šç¦ç”¨æ’ä»¶
â”œâ”€ await app.plugins.disablePlugin(pluginId)
â”œâ”€ Obsidianä¼šï¼š
â”‚  â”œâ”€ è°ƒç”¨æ’ä»¶çš„onunload()
â”‚  â”œâ”€ æ¸…ç†æ’ä»¶æ³¨å†Œçš„å‘½ä»¤
â”‚  â”œâ”€ æ¸…ç†æ’ä»¶æ³¨å†Œçš„äº‹ä»¶ç›‘å¬
â”‚  â”œâ”€ ä»enabledPlugins Setä¸­ç§»é™¤
â”‚  â””â”€ æ ‡è®°æ’ä»¶ä¸ºå·²ç¦ç”¨
â””â”€ ç­‰å¾…å®Œæˆ

æ­¥éª¤3ï¼šç­‰å¾…é—´éš”
â”œâ”€ await sleep(100)
â”œâ”€ ä½œç”¨ï¼š
â”‚  â”œâ”€ ç¡®ä¿æ’ä»¶å®Œå…¨å¸è½½
â”‚  â”œâ”€ ç»™äºˆæ¸…ç†èµ„æºçš„æ—¶é—´
â”‚  â”œâ”€ é¿å…ç«‹å³é‡æ–°åŠ è½½å†²çª
â”‚  â””â”€ 100msæ˜¯ç»éªŒå€¼ï¼ˆå¯è°ƒæ•´ï¼‰
â””â”€ å®ç°ï¼šnew Promise(r => setTimeout(r, 100))

æ­¥éª¤4ï¼šå¯ç”¨æ’ä»¶
â”œâ”€ await app.plugins.enablePlugin(pluginId)
â”œâ”€ Obsidianä¼šï¼š
â”‚  â”œâ”€ é‡æ–°åŠ è½½æ’ä»¶æ–‡ä»¶ï¼ˆmain.jsï¼‰
â”‚  â”œâ”€ åˆ›å»ºæ–°çš„æ’ä»¶å®ä¾‹
â”‚  â”œâ”€ è°ƒç”¨æ’ä»¶çš„onload()
â”‚  â”œâ”€ æ³¨å†Œæ’ä»¶çš„å‘½ä»¤
â”‚  â”œâ”€ æ·»åŠ åˆ°enabledPlugins Set
â”‚  â””â”€ æ ‡è®°æ’ä»¶ä¸ºå·²å¯ç”¨
â””â”€ ç­‰å¾…å®Œæˆ

æ­¥éª¤5ï¼šè®°å½•ç»“æŸæ—¶é—´
â”œâ”€ const endTime = Date.now()
â”œâ”€ const duration = endTime - startTime
â””â”€ é€šå¸¸è€—æ—¶ï¼š80-150ms

æ­¥éª¤6ï¼šè¾“å‡ºæ—¥å¿—
â”œâ”€ console.log('[Auto-Reload] âœ… æ’ä»¶å·²é‡è½½: ${pluginId} (ç”¨æ—¶: ${duration}ms)')
â”œâ”€ è¢«Global Loggeræ‹¦æˆª
â”œâ”€ å†™å…¥æ—¥å¿—æ–‡ä»¶
â””â”€ å¯ä¾›åç»­åˆ†æ

æ­¥éª¤7ï¼šæ˜¾ç¤ºé€šçŸ¥ï¼ˆå¯é€‰ï¼‰
â”œâ”€ if (showNotification)
â”œâ”€ new Notice(`âœ… æ’ä»¶å·²è‡ªåŠ¨é‡è½½ï¼š${pluginName}`, 2000)
â””â”€ ç”¨æˆ·çœ‹åˆ°é€šçŸ¥

æ­¥éª¤8ï¼šæ›´æ–°ç»Ÿè®¡
â”œâ”€ è®°å½•é‡è½½æ¬¡æ•°
â”œâ”€ è®°å½•æˆåŠŸ/å¤±è´¥
â”œâ”€ è®°å½•è€—æ—¶
â””â”€ ä¾›ç»Ÿè®¡åŠŸèƒ½ä½¿ç”¨

å¼‚å¸¸å¤„ç†ï¼š
catch (error) {
  â”œâ”€ è®°å½•å¤±è´¥æ—¥å¿—
  â”œâ”€ console.error('[Auto-Reload] âŒ é‡è½½å¤±è´¥: ${pluginId}', error)
  â”œâ”€ æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
  â””â”€ è¿”å›falseï¼ˆé‡è½½å¤±è´¥ï¼‰
}
```

**é‡è½½æ€§èƒ½åˆ†æ**:

```
æ€§èƒ½æ•°æ®ï¼š

å…¸å‹é‡è½½è€—æ—¶åˆ†è§£ï¼š
â”œâ”€ disablePluginè°ƒç”¨ï¼š30-50ms
â”‚  â”œâ”€ è°ƒç”¨onunload()
â”‚  â””â”€ æ¸…ç†æ³¨å†Œé¡¹
â”œâ”€ ç­‰å¾…é—´éš”ï¼š100msï¼ˆå›ºå®šï¼‰
â”œâ”€ enablePluginè°ƒç”¨ï¼š30-50ms
â”‚  â”œâ”€ é‡æ–°åŠ è½½main.js
â”‚  â”œâ”€ åˆ›å»ºå®ä¾‹
â”‚  â””â”€ è°ƒç”¨onload()
â”œâ”€ æ—¥å¿—è®°å½•ï¼š1-2ms
â””â”€ æ€»è®¡ï¼š160-200ms

å½±å“å› ç´ ï¼š
â”œâ”€ æ’ä»¶å¤æ‚åº¦
â”‚  â”œâ”€ ç®€å•æ’ä»¶ï¼š80-100ms
â”‚  â”œâ”€ ä¸­ç­‰æ’ä»¶ï¼š100-150ms
â”‚  â””â”€ å¤æ‚æ’ä»¶ï¼š150-200ms
â”œâ”€ ç³»ç»Ÿè´Ÿè½½
â”‚  â”œâ”€ ç©ºé—²æ—¶ï¼šæ›´å¿«
â”‚  â””â”€ é«˜è´Ÿè½½ï¼šå¯èƒ½æ…¢10-20%
â””â”€ æ’ä»¶ä¾èµ–
   â”œâ”€ æ— ä¾èµ–ï¼šå¿«
   â””â”€ å¤šä¾èµ–ï¼šæ…¢

ä¼˜åŒ–ç©ºé—´ï¼š
â”œâ”€ å½“å‰å®ç°å·²æ¥è¿‘æœ€ä¼˜
â”œâ”€ 100msç­‰å¾…æ—¶é—´å¯è°ƒæ•´ï¼š
â”‚  â”œâ”€ å‡å°‘åˆ°50msï¼šå¯èƒ½ä¸ç¨³å®š
â”‚  â”œâ”€ å¢åŠ åˆ°200msï¼šæ›´ç¨³å®šä½†æ…¢
â”‚  â””â”€ 100msæ˜¯æœ€ä½³å¹³è¡¡
â””â”€ ä¸»è¦è€—æ—¶åœ¨Obsidianå†…éƒ¨ï¼Œæ— æ³•ä¼˜åŒ–
```

---

### 4. MCP æœåŠ¡å™¨è¯¦ç»†è®¾è®¡

#### 4.1 MCP åè®®åŸºç¡€

**åè®®æ¦‚è¿°**:

```
MCPï¼ˆModel Context Protocolï¼‰ç®€ä»‹ï¼š

å®šä¹‰ï¼š
â”œâ”€ ç”±Anthropicè®¾è®¡çš„æ ‡å‡†åè®®
â”œâ”€ ç”¨äºAIåº”ç”¨ä¸å¤–éƒ¨å·¥å…·çš„é€šä¿¡
â”œâ”€ åŸºäºJSON-RPC 2.0
â”œâ”€ æ”¯æŒåŒå‘é€šä¿¡
â””â”€ é¢å‘å·¥å…·è°ƒç”¨åœºæ™¯

æ ¸å¿ƒæ¦‚å¿µï¼š

1. Serverï¼ˆæœåŠ¡å™¨ï¼‰
   â”œâ”€ æä¾›å·¥å…·é›†åˆ
   â”œâ”€ å¤„ç†å·¥å…·è°ƒç”¨è¯·æ±‚
   â”œâ”€ è¿”å›æ‰§è¡Œç»“æœ
   â””â”€ æœ¬é¡¹ç›®ï¼šmcp-obsidian-logger.py

2. Clientï¼ˆå®¢æˆ·ç«¯ï¼‰
   â”œâ”€ å‘èµ·å·¥å…·è°ƒç”¨
   â”œâ”€ æ¥æ”¶æ‰§è¡Œç»“æœ
   â”œâ”€ é›†æˆAIæ¨¡å‹
   â””â”€ æœ¬é¡¹ç›®ï¼šCursor IDE

3. Toolï¼ˆå·¥å…·ï¼‰
   â”œâ”€ ç‹¬ç«‹çš„åŠŸèƒ½å•å…ƒ
   â”œâ”€ æœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡º
   â”œâ”€ å¯è¢«AIè°ƒç”¨
   â””â”€ æœ¬é¡¹ç›®ï¼š12ä¸ªå·¥å…·

4. Transportï¼ˆä¼ è¾“ï¼‰
   â”œâ”€ stdioï¼šæ ‡å‡†è¾“å…¥è¾“å‡º
   â”œâ”€ HTTPï¼šHTTPæ¥å£
   â””â”€ æœ¬é¡¹ç›®ï¼šä½¿ç”¨stdio

é€šä¿¡æ¨¡å¼ï¼š
Client (Cursor)
  â†“ å‘é€JSON-RPCè¯·æ±‚ï¼ˆstdinï¼‰
Server (Python)
  â†“ è§£æè¯·æ±‚
  â†“ æ‰§è¡Œå·¥å…·å‡½æ•°
  â†“ ç”Ÿæˆç»“æœ
  â†“ è¿”å›JSON-RPCå“åº”ï¼ˆstdoutï¼‰
Client (Cursor)
  â†“ æ¥æ”¶å¹¶è§£æ
  â†“ å±•ç¤ºç»™ç”¨æˆ·æˆ–AI
```

**JSON-RPC 2.0 è¯¦è§£**:

```
è¯·æ±‚æ ¼å¼ï¼ˆRequestï¼‰ï¼š

{
  "jsonrpc": "2.0",              // åè®®ç‰ˆæœ¬ï¼ˆå¿…é¡»ï¼‰
  "id": 1,                       // è¯·æ±‚IDï¼ˆå¿…é¡»ï¼Œç”¨äºåŒ¹é…å“åº”ï¼‰
  "method": "read_logs",         // å·¥å…·åç§°ï¼ˆå¿…é¡»ï¼‰
  "params": {                    // å‚æ•°å¯¹è±¡ï¼ˆå¯é€‰ï¼‰
    "lines": 50,
    "level": "all",
    "keywords": "error"
  }
}

å­—æ®µè¯´æ˜ï¼š
â”œâ”€ jsonrpcï¼šå›ºå®šä¸º"2.0"
â”œâ”€ idï¼š
â”‚  â”œâ”€ å¯ä»¥æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²
â”‚  â”œâ”€ ç”¨äºåŒ¹é…è¯·æ±‚å’Œå“åº”
â”‚  â”œâ”€ å®¢æˆ·ç«¯ç”Ÿæˆ
â”‚  â””â”€ å“åº”ä¼šåŒ…å«ç›¸åŒid
â”œâ”€ methodï¼š
â”‚  â”œâ”€ å·¥å…·çš„å”¯ä¸€æ ‡è¯†
â”‚  â”œâ”€ å¿…é¡»åœ¨æœåŠ¡å™¨æ³¨å†Œ
â”‚  â””â”€ åŒºåˆ†å¤§å°å†™
â””â”€ paramsï¼š
   â”œâ”€ å·¥å…·çš„å‚æ•°
   â”œâ”€ å¯ä»¥æ˜¯å¯¹è±¡æˆ–æ•°ç»„
   â”œâ”€ æœ¬é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨å¯¹è±¡
   â””â”€ å‚æ•°åå¿…é¡»ä¸å·¥å…·å®šä¹‰ä¸€è‡´

æˆåŠŸå“åº”æ ¼å¼ï¼ˆSuccess Responseï¼‰ï¼š

{
  "jsonrpc": "2.0",
  "id": 1,                       // ä¸è¯·æ±‚idç›¸åŒ
  "result": "..."                // å·¥å…·è¿”å›å€¼ï¼ˆä»»æ„ç±»å‹ï¼‰
}

é”™è¯¯å“åº”æ ¼å¼ï¼ˆError Responseï¼‰ï¼š

{
  "jsonrpc": "2.0",
  "id": 1,
  "error": {
    "code": -32600,              // é”™è¯¯ç 
    "message": "Invalid Request", // é”™è¯¯æ¶ˆæ¯
    "data": {...}                // é¢å¤–é”™è¯¯ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
  }
}

æ ‡å‡†é”™è¯¯ç ï¼š
â”œâ”€ -32700ï¼šParse errorï¼ˆJSONè§£æé”™è¯¯ï¼‰
â”œâ”€ -32600ï¼šInvalid Requestï¼ˆæ— æ•ˆè¯·æ±‚ï¼‰
â”œâ”€ -32601ï¼šMethod not foundï¼ˆæ–¹æ³•æœªæ‰¾åˆ°ï¼‰
â”œâ”€ -32602ï¼šInvalid paramsï¼ˆæ— æ•ˆå‚æ•°ï¼‰
â”œâ”€ -32603ï¼šInternal errorï¼ˆå†…éƒ¨é”™è¯¯ï¼‰
â””â”€ -32000 åˆ° -32099ï¼šæœåŠ¡å™¨è‡ªå®šä¹‰é”™è¯¯
```

#### 4.2 å·¥å…·å®šä¹‰è¯¦è§£ï¼ˆ12ä¸ªå·¥å…·å®Œæ•´è®¾è®¡ï¼‰

**å·¥å…·åˆ†ç»„å’ŒèŒè´£**:

```
å·¥å…·åˆ†ç»„ï¼ˆ4ç»„å…±12ä¸ªï¼‰ï¼š

ç»„1ï¼šæ—¥å¿—è¯»å–å·¥å…·ï¼ˆ3ä¸ªï¼‰
â”œâ”€ read_logsï¼šè¯»å–æŒ‡å®šè¡Œæ•°çš„æ—¥å¿—
â”œâ”€ get_recent_errorsï¼šè·å–æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
â””â”€ get_recent_warningsï¼šè·å–æœ€è¿‘çš„è­¦å‘Šæ—¥å¿—
ä½œç”¨ï¼šå¿«é€ŸæŸ¥çœ‹æ—¥å¿—å†…å®¹

ç»„2ï¼šæ—¥å¿—åˆ†æå·¥å…·ï¼ˆ3ä¸ªï¼‰
â”œâ”€ get_log_summaryï¼šè·å–ç»Ÿè®¡æ‘˜è¦
â”œâ”€ analyze_errorsï¼šæ·±åº¦é”™è¯¯åˆ†æ
â””â”€ search_logsï¼šæœç´¢æ—¥å¿—
ä½œç”¨ï¼šç†è§£å’Œåˆ†ææ—¥å¿—

ç»„3ï¼šæ—¥å¿—ç®¡ç†å·¥å…·ï¼ˆ3ä¸ªï¼‰
â”œâ”€ clear_logsï¼šæ¸…ç©ºæ—¥å¿—æ–‡ä»¶
â”œâ”€ get_log_file_pathï¼šè·å–æ–‡ä»¶è·¯å¾„
â””â”€ rotate_logsï¼šæ‰‹åŠ¨è§¦å‘è½®è½¬
ä½œç”¨ï¼šç®¡ç†æ—¥å¿—æ–‡ä»¶

ç»„4ï¼šAuto-Reloadç®¡ç†å·¥å…·ï¼ˆ6ä¸ªï¼‰
â”œâ”€ get_auto_reload_statusï¼šè·å–è¿è¡ŒçŠ¶æ€
â”œâ”€ get_auto_reload_modeï¼šè·å–å½“å‰æ¨¡å¼
â”œâ”€ set_auto_reload_modeï¼šåˆ‡æ¢ç›‘æ§æ¨¡å¼
â”œâ”€ manage_watched_pluginsï¼šç®¡ç†ç›‘æ§åˆ—è¡¨
â”œâ”€ trigger_plugin_reloadï¼šæ‰‹åŠ¨è§¦å‘é‡è½½
â””â”€ get_reload_statisticsï¼šè·å–é‡è½½ç»Ÿè®¡
ä½œç”¨ï¼šè¿œç¨‹æ§åˆ¶Auto-Reload
```

**å·¥å…·1ï¼šread_logsï¼ˆå®Œæ•´è®¾è®¡ï¼‰**

```python
@mcp.tool()
def read_logs(
    lines: int = 50,
    level: str = "all",
    keywords: str = None
) -> str:
    """
    è¯»å–æ—¥å¿—æ–‡ä»¶çš„æœ€åNè¡Œ
    
    Args:
        lines (int): è¿”å›çš„è¡Œæ•°ï¼ŒèŒƒå›´1-10000ï¼Œé»˜è®¤50
        level (str): æ—¥å¿—çº§åˆ«è¿‡æ»¤ï¼Œå¯é€‰å€¼ï¼šall/errors/warnings/debug/infoï¼Œé»˜è®¤all
        keywords (str): å…³é”®è¯è¿‡æ»¤ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¯é€‰
    
    Returns:
        str: æ ¼å¼åŒ–çš„æ—¥å¿—æ–‡æœ¬ï¼Œæ¯è¡Œæ ¼å¼ï¼š[HH:MM:SS.mmm] [LEVEL] message
    
    Examples:
        read_logs(lines=100)  # è¯»å–æœ€å100è¡Œ
        read_logs(level="errors")  # åªè¯»å–é”™è¯¯æ—¥å¿—
        read_logs(keywords="plugin")  # æœç´¢åŒ…å«pluginçš„æ—¥å¿—
    """
    
    # æ­¥éª¤1ï¼šå‚æ•°éªŒè¯
    if not isinstance(lines, int):
        return "âŒ å‚æ•°é”™è¯¯ï¼šlines å¿…é¡»æ˜¯æ•´æ•°"
    
    if lines < 1 or lines > 10000:
        return "âŒ å‚æ•°é”™è¯¯ï¼šlines å¿…é¡»åœ¨ 1-10000 ä¹‹é—´"
    
    valid_levels = ["all", "errors", "warnings", "debug", "info"]
    if level not in valid_levels:
        return f"âŒ å‚æ•°é”™è¯¯ï¼šlevel å¿…é¡»æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š{', '.join(valid_levels)}"
    
    # æ­¥éª¤2ï¼šæ£€æŸ¥æ—¥å¿—æ–‡ä»¶
    log_file = get_log_file_path()
    
    if not os.path.exists(log_file):
        return "âš ï¸ æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¯èƒ½æ’ä»¶æœªè¿è¡Œæˆ–æ—¥å¿—è·¯å¾„é…ç½®é”™è¯¯"
    
    try:
        # æ­¥éª¤3ï¼šè¯»å–æ–‡ä»¶
        with open(log_file, 'r', encoding='utf-8') as f:
            all_lines = f.readlines()
        
        # æ­¥éª¤4ï¼šè¿‡æ»¤çº§åˆ«
        filtered_lines = all_lines
        
        if level != "all":
            level_map = {
                "errors": "[ERROR]",
                "warnings": "[WARN]",
                "debug": "[DEBUG]",
                "info": "[LOG]"
            }
            level_tag = level_map.get(level, "[LOG]")
            filtered_lines = [line for line in filtered_lines if level_tag in line]
        
        # æ­¥éª¤5ï¼šå…³é”®è¯è¿‡æ»¤
        if keywords:
            keywords_lower = keywords.lower()
            filtered_lines = [
                line for line in filtered_lines 
                if keywords_lower in line.lower()
            ]
        
        # æ­¥éª¤6ï¼šè·å–æœ€åNè¡Œ
        recent_lines = filtered_lines[-lines:] if len(filtered_lines) > lines else filtered_lines
        
        # æ­¥éª¤7ï¼šæ£€æŸ¥ç»“æœ
        if not recent_lines:
            return f"â„¹ï¸ æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ—¥å¿—ï¼ˆlevel={level}, keywords={keywords or 'N/A'}ï¼‰"
        
        # æ­¥éª¤8ï¼šæ ¼å¼åŒ–è¿”å›
        result = ''.join(recent_lines).rstrip()
        
        # æ·»åŠ å¤´éƒ¨ä¿¡æ¯
        header = f"ğŸ“ æ—¥å¿—å†…å®¹ï¼ˆæœ€å {len(recent_lines)} è¡Œï¼Œå…± {len(all_lines)} è¡Œï¼‰\n"
        header += "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n"
        footer = "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        
        return header + result + footer
        
    except UnicodeDecodeError:
        return "âŒ è¯»å–å¤±è´¥ï¼šæ–‡ä»¶ç¼–ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ç¼–ç "
    except Exception as e:
        logger.error(f"è¯»å–æ—¥å¿—å¤±è´¥ï¼š{e}")
        return f"âŒ è¯»å–å¤±è´¥ï¼š{str(e)}"
```

**å·¥å…·2ï¼šget_log_summaryï¼ˆå®Œæ•´è®¾è®¡ï¼‰**

```python
@mcp.tool()
def get_log_summary() -> str:
    """
    è·å–æ—¥å¿—æ–‡ä»¶çš„ç»Ÿè®¡æ‘˜è¦
    
    Returns:
        str: æ ¼å¼åŒ–çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¤§å°ã€è¡Œæ•°ã€å„çº§åˆ«æ•°é‡ç­‰
    
    Examples:
        get_log_summary()  # æ˜¾ç¤ºå®Œæ•´ç»Ÿè®¡
    """
    
    log_file = get_log_file_path()
    
    # æ£€æŸ¥æ–‡ä»¶
    if not os.path.exists(log_file):
        return "âš ï¸ æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨"
    
    try:
        # è·å–æ–‡ä»¶ä¿¡æ¯
        stats = os.stat(log_file)
        file_size = stats.st_size
        file_mtime = stats.st_mtime
        
        # è¯»å–å†…å®¹
        with open(log_file, 'r', encoding='utf-8') as f:
            lines = f.readlines()
        
        # ç»Ÿè®¡å„çº§åˆ«
        total_lines = len(lines)
        log_count = sum(1 for line in lines if '[LOG]' in line)
        error_count = sum(1 for line in lines if '[ERROR]' in line)
        warn_count = sum(1 for line in lines if '[WARN]' in line)
        debug_count = sum(1 for line in lines if '[DEBUG]' in line)
        
        # æå–æ—¶é—´èŒƒå›´
        first_time = None
        last_time = None
        
        if lines:
            time_pattern = r'\[(\d{2}:\d{2}:\d{2}\.\d{3})\]'
            
            first_match = re.search(time_pattern, lines[0])
            if first_match:
                first_time = first_match.group(1)
            
            last_match = re.search(time_pattern, lines[-1])
            if (last_match):
                last_time = last_match.group(1)
        
        # è®¡ç®—é”™è¯¯ç‡
        error_rate = (error_count / total_lines * 100) if total_lines > 0 else 0
        
        # æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        size_str = format_file_size(file_size)
        
        # æ ¼å¼åŒ–ä¿®æ”¹æ—¶é—´
        time_str = format_relative_time(file_mtime)
        
        # ç”ŸæˆæŠ¥å‘Š
        report = f"""
ğŸ“Š æ—¥å¿—ç»Ÿè®¡æ‘˜è¦
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ æ–‡ä»¶è·¯å¾„ï¼š{log_file}
ğŸ’¾ æ–‡ä»¶å¤§å°ï¼š{size_str}
ğŸ“ˆ æ€»è¡Œæ•°ï¼š{total_lines:,}
â±ï¸ æœ€åæ›´æ–°ï¼š{time_str}

ğŸ“ æ—¥å¿—çº§åˆ«åˆ†å¸ƒï¼š
â”œâ”€ ğŸ”µ æ™®é€šæ—¥å¿—ï¼ˆLOGï¼‰ï¼š{log_count:,} ({(log_count/total_lines*100):.1f}%)
â”œâ”€ ğŸŸ¡ è­¦å‘Šæ—¥å¿—ï¼ˆWARNï¼‰ï¼š{warn_count:,} ({(warn_count/total_lines*100):.1f}%)
â”œâ”€ ğŸ”´ é”™è¯¯æ—¥å¿—ï¼ˆERRORï¼‰ï¼š{error_count:,} ({(error_count/total_lines*100):.1f}%)
â””â”€ âšª è°ƒè¯•æ—¥å¿—ï¼ˆDEBUGï¼‰ï¼š{debug_count:,} ({(debug_count/total_lines*100):.1f}%)

ğŸ“Š ç»Ÿè®¡æŒ‡æ ‡ï¼š
â”œâ”€ é”™è¯¯ç‡ï¼š{error_rate:.2f}%
â”œâ”€ é¦–æ¡æ—¥å¿—ï¼š{first_time or 'N/A'}
â””â”€ æœ«æ¡æ—¥å¿—ï¼š{last_time or 'N/A'}

{'âš ï¸ è­¦å‘Šï¼šé”™è¯¯ç‡è¾ƒé«˜ï¼Œå»ºè®®æ£€æŸ¥' if error_rate > 5 else 'âœ… æ—¥å¿—çŠ¶æ€è‰¯å¥½'}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        """.strip()
        
        return report
        
    except Exception as e:
        logger.error(f"è·å–ç»Ÿè®¡å¤±è´¥ï¼š{e}")
        return f"âŒ è·å–ç»Ÿè®¡å¤±è´¥ï¼š{str(e)}"

# è¾…åŠ©å‡½æ•°
def format_file_size(bytes: int) -> str:
    """æ ¼å¼åŒ–æ–‡ä»¶å¤§å°"""
    for unit in ['B', 'KB', 'MB', 'GB']:
        if bytes < 1024:
            return f"{bytes:.2f} {unit}"
        bytes /= 1024
    return f"{bytes:.2f} TB"

def format_relative_time(timestamp: float) -> str:
    """æ ¼å¼åŒ–ç›¸å¯¹æ—¶é—´"""
    now = time.time()
    diff = now - timestamp
    
    if diff < 10:
        return "åˆšåˆš"
    elif diff < 60:
        return f"{int(diff)} ç§’å‰"
    elif diff < 3600:
        return f"{int(diff / 60)} åˆ†é’Ÿå‰"
    elif diff < 86400:
        return f"{int(diff / 3600)} å°æ—¶å‰"
    else:
        days = int(diff / 86400)
        return f"{days} å¤©å‰"
```

**å·¥å…·3-12ï¼šå…¶ä»–å·¥å…·å®Œæ•´è®¾è®¡**

```
å·¥å…·3ï¼šget_recent_errors
â”œâ”€ åŠŸèƒ½ï¼šè·å–æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
â”œâ”€ å‚æ•°ï¼šlimit (é»˜è®¤10), include_stack (é»˜è®¤false)
â”œâ”€ è¿”å›ï¼šæœ€è¿‘Nä¸ªé”™è¯¯çš„åˆ—è¡¨
â””â”€ ç”¨é€”ï¼šå¿«é€Ÿå®šä½é—®é¢˜

å·¥å…·4ï¼šanalyze_errors
â”œâ”€ åŠŸèƒ½ï¼šæ·±åº¦åˆ†æé”™è¯¯æ—¥å¿—
â”œâ”€ å‚æ•°ï¼štime_range (é»˜è®¤24å°æ—¶)
â”œâ”€ è¿”å›ï¼šé”™è¯¯åˆ†ç±»ç»Ÿè®¡ã€æ¨¡å¼è¯†åˆ«ã€ä¿®å¤å»ºè®®
â””â”€ ç”¨é€”ï¼šç†è§£é”™è¯¯æ ¹å› 

å·¥å…·5ï¼šsearch_logs
â”œâ”€ åŠŸèƒ½ï¼šæœç´¢æ—¥å¿—å†…å®¹
â”œâ”€ å‚æ•°ï¼šquery, case_sensitive, regex
â”œâ”€ è¿”å›ï¼šåŒ¹é…çš„æ—¥å¿—è¡Œ
â””â”€ ç”¨é€”ï¼šç²¾ç¡®æŸ¥æ‰¾

å·¥å…·6ï¼šclear_logs
â”œâ”€ åŠŸèƒ½ï¼šæ¸…ç©ºæ—¥å¿—æ–‡ä»¶
â”œâ”€ å‚æ•°ï¼šbackup (é»˜è®¤true)
â”œâ”€ è¿”å›ï¼šæˆåŠŸ/å¤±è´¥ä¿¡æ¯
â””â”€ ç”¨é€”ï¼šå¼€å§‹æ–°çš„è°ƒè¯•ä¼šè¯

å·¥å…·7ï¼šget_log_file_path
â”œâ”€ åŠŸèƒ½ï¼šè·å–æ—¥å¿—æ–‡ä»¶è·¯å¾„
â”œâ”€ å‚æ•°ï¼šæ— 
â”œâ”€ è¿”å›ï¼šç»å¯¹è·¯å¾„
â””â”€ ç”¨é€”ï¼šè®¿é—®å’Œç®¡ç†

å·¥å…·8ï¼šrotate_logs
â”œâ”€ åŠŸèƒ½ï¼šæ‰‹åŠ¨è§¦å‘æ—¥å¿—è½®è½¬
â”œâ”€ å‚æ•°ï¼šæ— 
â”œâ”€ è¿”å›ï¼šæ–°æ—§æ–‡ä»¶è·¯å¾„
â””â”€ ç”¨é€”ï¼šæ‰‹åŠ¨ç®¡ç†å¤§æ–‡ä»¶

å·¥å…·9ï¼šget_auto_reload_status
â”œâ”€ åŠŸèƒ½ï¼šè·å–Auto-Reloadå®Œæ•´çŠ¶æ€
â”œâ”€ å‚æ•°ï¼šæ— 
â”œâ”€ è¿”å›ï¼šæ¨¡å¼ã€ç›‘æ§åˆ—è¡¨ã€é…ç½®ç­‰
â””â”€ ç”¨é€”ï¼šæŸ¥çœ‹ç›‘æ§çŠ¶æ€

å·¥å…·10ï¼šget_auto_reload_mode
â”œâ”€ åŠŸèƒ½ï¼šè·å–å½“å‰ç›‘æ§æ¨¡å¼
â”œâ”€ å‚æ•°ï¼šæ— 
â”œâ”€ è¿”å›ï¼šæ¨¡å¼åç§°å’Œè¯´æ˜
â””â”€ ç”¨é€”ï¼šå¿«é€ŸæŸ¥è¯¢

å·¥å…·11ï¼šset_auto_reload_mode
â”œâ”€ åŠŸèƒ½ï¼šåˆ‡æ¢ç›‘æ§æ¨¡å¼
â”œâ”€ å‚æ•°ï¼šmode (auto/smart/manual)
â”œâ”€ è¿”å›ï¼šåˆ‡æ¢ç»“æœ
â””â”€ ç”¨é€”ï¼šè¿œç¨‹æ§åˆ¶

å·¥å…·12ï¼šmanage_watched_plugins
â”œâ”€ åŠŸèƒ½ï¼šç®¡ç†ç›‘æ§æ’ä»¶åˆ—è¡¨
â”œâ”€ å‚æ•°ï¼šaction (add/remove/set/get), plugins
â”œâ”€ è¿”å›ï¼šæ›´æ–°åçš„åˆ—è¡¨
â””â”€ ç”¨é€”ï¼šåŠ¨æ€ç®¡ç†

å·¥å…·13ï¼štrigger_plugin_reload
â”œâ”€ åŠŸèƒ½ï¼šæ‰‹åŠ¨è§¦å‘æ’ä»¶é‡è½½
â”œâ”€ å‚æ•°ï¼šplugin_id
â”œâ”€ è¿”å›ï¼šé‡è½½ç»“æœ
â””â”€ ç”¨é€”ï¼šç«‹å³é‡è½½

å·¥å…·14ï¼šget_reload_statistics
â”œâ”€ åŠŸèƒ½ï¼šè·å–é‡è½½ç»Ÿè®¡
â”œâ”€ å‚æ•°ï¼šplugin_id (å¯é€‰), time_range (é»˜è®¤24h)
â”œâ”€ è¿”å›ï¼šé‡è½½æ¬¡æ•°ã€æˆåŠŸç‡ã€å¹³å‡è€—æ—¶ç­‰
â””â”€ ç”¨é€”ï¼šæ€§èƒ½åˆ†æ
```

---

## ç³»ç»Ÿæ¶æ„ä¸äº¤äº’è®¾è®¡

### 1. æ•´ä½“ç³»ç»Ÿæ¶æ„

#### 1.1 ä¸‰å±‚æ¶æ„è¯¦è§£

```
Cursor IDEï¼ˆåº”ç”¨å±‚ï¼‰
    â†‘â†“ MCP åè®®ï¼ˆJSON-RPCï¼‰
MCP Serverï¼ˆä¸­é—´å±‚ï¼‰
    â†‘â†“ æ–‡ä»¶ç³»ç»Ÿ API + æ—¥å¿—æ–‡ä»¶ç›‘å¬ + æ’ä»¶é…ç½®ç®¡ç†
Obsidian Logger æ’ä»¶ï¼ˆæ•°æ®+æ§åˆ¶å±‚ï¼‰
    â”œâ”€ æ—¥å¿—æ¨¡å—ï¼šæ‹¦æˆª console â†’ æ”¶é›†æ—¥å¿— â†’ å†™å…¥æ–‡ä»¶
    â””â”€ Auto-Reload æ¨¡å—ï¼šæ™ºèƒ½ç›‘æ§ â†’ æ£€æµ‹å˜åŒ– â†’ è‡ªåŠ¨é‡è½½
Obsidian æ ¸å¿ƒ + æ’ä»¶ç”Ÿæ€

æ¶æ„è¯´æ˜ï¼š

åº”ç”¨å±‚ï¼ˆCursor IDEï¼‰ï¼š
â”œâ”€ æä¾›ç”¨æˆ·äº¤äº’ç•Œé¢
â”œâ”€ è°ƒç”¨ MCP å·¥å…·
â”œâ”€ å±•ç¤ºæ—¥å¿—å’Œåˆ†æç»“æœ
â””â”€ AI æ™ºèƒ½è¯Šæ–­å’Œå»ºè®®

ä¸­é—´å±‚ï¼ˆMCP Serverï¼‰ï¼š
â”œâ”€ å®ç° MCP åè®®
â”œâ”€ æä¾› 12 ä¸ªå·¥å…·æ¥å£
â”œâ”€ ç®¡ç†æ—¥å¿—æ–‡ä»¶è¯»å†™
â”œâ”€ ç®¡ç†æ’ä»¶é…ç½®è¯»å†™
â””â”€ ç¼“å­˜å’Œä¼˜åŒ–

æ•°æ®+æ§åˆ¶å±‚ï¼ˆObsidian Logger æ’ä»¶ï¼‰ï¼š
â”œâ”€ logger æ¨¡å—ï¼ˆæ—¥å¿—åŠŸèƒ½ï¼‰
â”œâ”€ auto-reload æ¨¡å—ï¼ˆé‡è½½åŠŸèƒ½ï¼‰
â”œâ”€ shared æ¨¡å—ï¼ˆå…±äº«åŠŸèƒ½ï¼‰
â””â”€ å…±äº«ç”Ÿå‘½å‘¨æœŸå’Œé…ç½®

åŸºç¡€å±‚ï¼ˆObsidianï¼‰ï¼š
â”œâ”€ æä¾›æ’ä»¶è¿è¡Œç¯å¢ƒ
â”œâ”€ ç®¡ç†æ’ä»¶ç”Ÿå‘½å‘¨æœŸ
â”œâ”€ æä¾›æ–‡ä»¶ç³»ç»Ÿ API
â””â”€ æä¾›åº”ç”¨äº‹ä»¶
```

### 2. æ•°æ®æµè¯¦è§£

```
å®Œæ•´çš„æ•°æ®æµè½¬è¿‡ç¨‹ï¼š

æ—¥å¿—æµï¼š
ç¬¬1é˜¶æ®µï¼šæ—¥å¿—ç”Ÿæˆ
â”œâ”€ Obsidian æ’ä»¶æ‰§è¡Œä»£ç 
â”œâ”€ ä»£ç è°ƒç”¨ console.log()
â””â”€ è¾“å‡ºæ—¥å¿—ä¿¡æ¯

ç¬¬2é˜¶æ®µï¼šæ—¥å¿—æ‹¦æˆª
â”œâ”€ Global Logger æ•è· console è°ƒç”¨
â”œâ”€ æå–æ—¥å¿—å†…å®¹å’Œçº§åˆ«
â”œâ”€ æ·»åŠ æ—¶é—´æˆ³
â””â”€ æ”¾å…¥ç¼“å†²åŒº

ç¬¬3é˜¶æ®µï¼šæ—¥å¿—æ”¶é›†
â”œâ”€ ç¼“å†²åŒºè¾¾åˆ°æ¡ä»¶
â”œâ”€ è§¦å‘åˆ·æ–°æ“ä½œ
â”œâ”€ æ‰¹é‡å†™å…¥æ—¥å¿—æ–‡ä»¶
â””â”€ æ¸…ç©ºç¼“å†²åŒº

é‡è½½æµï¼ˆå¹¶è¡Œï¼‰ï¼š
ç¬¬1é˜¶æ®µï¼šæ–‡ä»¶ç›‘æ§
â”œâ”€ Auto-Reload å®šæ—¶æ£€æŸ¥
â”œâ”€ æ£€æµ‹æ–‡ä»¶å˜åŒ–
â””â”€ è§¦å‘é‡è½½

ç¬¬2é˜¶æ®µï¼šæ’ä»¶é‡è½½
â”œâ”€ ç¦ç”¨æ’ä»¶
â”œâ”€ ç­‰å¾… 100ms
â”œâ”€ å¯ç”¨æ’ä»¶
â””â”€ è¾“å‡ºé‡è½½æ—¥å¿—

ç¬¬3é˜¶æ®µï¼šæ—¥å¿—æ•´åˆ
â””â”€ é‡è½½æ—¥å¿—å†™å…¥æ–‡ä»¶

MCP äº¤äº’æµï¼š
ç¬¬4é˜¶æ®µï¼šæ–‡ä»¶ç›‘å¬
â”œâ”€ MCP Server watchdog ç›‘å¬
â”œâ”€ æ£€æµ‹æ–‡ä»¶ä¿®æ”¹
â”œâ”€ è¯»å–æ–°å¢å†…å®¹
â””â”€ æ›´æ–°ç¼“å­˜

ç¬¬5é˜¶æ®µï¼šå·¥å…·è°ƒç”¨
â”œâ”€ Cursor è°ƒç”¨ MCP å·¥å…·
â”œâ”€ MCP Server å¤„ç†è¯·æ±‚
â””â”€ è¿”å›ç»“æœ

ç¬¬6é˜¶æ®µï¼šAI åˆ†æ
â”œâ”€ Cursor Agent è°ƒç”¨å·¥å…·
â”œâ”€ æ”¶é›†ä¿¡æ¯
â”œâ”€ AI æ¨¡å‹æ¨ç†
â””â”€ è¿”å›è¯Šæ–­å’Œå»ºè®®
```

---

## è´¨é‡ä¿è¯ä¸æµ‹è¯•

### 1. æµ‹è¯•ç­–ç•¥

#### 1.1 å•å…ƒæµ‹è¯•

```
æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š

Global Logger æ’ä»¶ï¼š
â”œâ”€ æ—¥å¿—æ‹¦æˆªï¼ˆé˜²æ­»å¾ªç¯ï¼‰
â”œâ”€ æ—¥å¿—æ ¼å¼åŒ–
â”œâ”€ ç¼“å†²åŒºç®¡ç†
â”œâ”€ æ–‡ä»¶æ“ä½œ
â”œâ”€ å‚æ•°åºåˆ—åŒ–
â””â”€ é€šé…ç¬¦åŒ¹é…

Auto-Reload æ¨¡å—ï¼š
â”œâ”€ æ™ºèƒ½è¯†åˆ«ç®—æ³•
â”œâ”€ æ–‡ä»¶å˜åŒ–æ£€æµ‹
â”œâ”€ æ’ä»¶é‡è½½
â”œâ”€ æ¨¡å¼åˆ‡æ¢
â””â”€ é…ç½®éªŒè¯

ç›®æ ‡è¦†ç›–ç‡ï¼š> 80%
```

#### 1.2 æ€§èƒ½æµ‹è¯•

```
æ€§èƒ½åŸºå‡†ï¼š

æŒ‡æ ‡1ï¼šCPU å ç”¨
â”œâ”€ ç›®æ ‡ï¼š< 5%
â”œâ”€ æµ‹è¯•ï¼šè¿è¡Œ1å°æ—¶
â””â”€ å¤±è´¥æ ‡å‡†ï¼š> 10%

æŒ‡æ ‡2ï¼šå†…å­˜å ç”¨
â”œâ”€ ç›®æ ‡ï¼š< 100MB
â”œâ”€ æµ‹è¯•ï¼šé•¿æ—¶é—´è¿è¡Œ
â””â”€ å¤±è´¥æ ‡å‡†ï¼š> 200MB

æŒ‡æ ‡3ï¼šå“åº”æ—¶é—´
â”œâ”€ ç›®æ ‡ï¼š< 500ms
â”œâ”€ æµ‹è¯•ï¼š100æ¬¡è°ƒç”¨
â””â”€ å¤±è´¥æ ‡å‡†ï¼š> 1000ms

æŒ‡æ ‡4ï¼šæ—¥å¿—å»¶è¿Ÿ
â”œâ”€ ç›®æ ‡ï¼š< 100ms
â”œâ”€ æµ‹è¯•ï¼šé«˜é¢‘æ—¥å¿—
â””â”€ å¤±è´¥æ ‡å‡†ï¼š> 500ms
```

### 2. ä»£ç è§„èŒƒ

```
TypeScript è§„èŒƒï¼š
â”œâ”€ å‘½åï¼šcamelCase / PascalCase
â”œâ”€ ç¼©è¿›ï¼š2ä¸ªç©ºæ ¼
â”œâ”€ è¡Œé•¿ï¼š100å­—ç¬¦
â”œâ”€ æ³¨é‡Šï¼šJSDocæ ¼å¼
â””â”€ ä¸¥æ ¼æ¨¡å¼

Python è§„èŒƒï¼š
â”œâ”€ å‘½åï¼šsnake_case / PascalCase
â”œâ”€ ç¼©è¿›ï¼š4ä¸ªç©ºæ ¼
â”œâ”€ è¡Œé•¿ï¼š100å­—ç¬¦
â”œâ”€ æ³¨é‡Šï¼šDocstring
â””â”€ ç±»å‹æ³¨è§£
```

---

## è¿­ä»£è®¡åˆ’

### v1.0ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰

**å‘å¸ƒæ—¶é—´**: 2025-11-15

**ä¸»è¦åŠŸèƒ½**:
- âœ… å…¨å±€æ—¥å¿—æ”¶é›†
- âœ… æ™ºèƒ½è‡ªåŠ¨é‡è½½
- âœ… å¯è§†åŒ–è®¾ç½®ç•Œé¢
- âœ… æ–‡ä»¶ç±»å‹è‡ªå®šä¹‰
- âœ… é€šé…ç¬¦æ”¯æŒ
- âœ… 12ä¸ªMCPå·¥å…·ï¼ˆå¾…å¼€å‘ï¼‰
- âœ… Cursoré›†æˆï¼ˆå¾…å¼€å‘ï¼‰

**æ€§èƒ½æŒ‡æ ‡**:
- CPU < 5%
- å†…å­˜ < 100MB
- å“åº” < 500ms

### v1.1ï¼ˆä¼˜åŒ–ç‰ˆï¼‰

**å‘å¸ƒæ—¶é—´**: 2025-12-01

**ä¼˜åŒ–é‡ç‚¹**:
- å†…å­˜ä¼˜åŒ–ï¼ˆâ†“80%ï¼‰
- æ€§èƒ½ä¼˜åŒ–ï¼ˆâ†“50%ï¼‰
- åŠŸèƒ½å¢å¼º
- ç§»åŠ¨ç«¯æ”¯æŒï¼ˆå®éªŒæ€§ï¼‰

### v1.2ï¼ˆäº‘ç«¯ç‰ˆï¼‰

**å‘å¸ƒæ—¶é—´**: 2026-01-15

**æ–°å¢åŠŸèƒ½**:
- äº‘ç«¯æ—¥å¿—å¤‡ä»½
- Web UI ä»ªè¡¨æ¿
- å›¢é˜Ÿåä½œ

### v2.0ï¼ˆAIå¢å¼ºç‰ˆï¼‰

**å‘å¸ƒæ—¶é—´**: 2026-06-01

**é©å‘½æ€§åŠŸèƒ½**:
- AI æ ¹å› åˆ†æ
- è‡ªåŠ¨ä»£ç ä¿®å¤
- é¢„æµ‹æ€§å‘Šè­¦
- æ™ºèƒ½æµ‹è¯•ç”Ÿæˆ

---

## æ€»ç»“

### é¡¹ç›®ä»·å€¼

```
æ ¸å¿ƒä»·å€¼ï¼š

1. æ—¶é—´èŠ‚çœ
   â”œâ”€ è°ƒè¯•æ—¶é—´ â†“ 85%
   â”œâ”€ å¼€å‘æ•ˆç‡ â†‘ 5-10å€
   â””â”€ ROI æé«˜

2. å¼€å‘ä½“éªŒ
   â”œâ”€ é›¶é…ç½®å®‰è£…
   â”œâ”€ è‡ªåŠ¨åŒ–å·¥ä½œæµ
   â”œâ”€ AI æ™ºèƒ½è¾…åŠ©
   â””â”€ ç”¨æˆ·æ»¡æ„åº¦é«˜

3. ä»£ç è´¨é‡
   â”œâ”€ å¿«é€Ÿå‘ç°é—®é¢˜
   â”œâ”€ å®Œæ•´æ—¥å¿—è¿½è¸ª
   â””â”€ Bug â†“ 50%

4. å­¦ä¹ èµ„æº
   â”œâ”€ è¯¦ç»†æ–‡æ¡£
   â”œâ”€ ä»£ç ç¤ºä¾‹
   â””â”€ ç¤¾åŒºæ”¯æŒ
```

### æˆåŠŸæ ‡å‡†

```
é¡¹ç›®å®Œæˆæ ‡å‡†ï¼š

åŠŸèƒ½å®Œæˆåº¦ï¼š100%
â”œâ”€ æ‰€æœ‰è®¡åˆ’åŠŸèƒ½å®ç°
â”œâ”€ æ‰€æœ‰æ ¸å¿ƒå·¥å…·å®Œæˆ
â””â”€ å‘åå…¼å®¹æ€§ä¿è¯

æ€§èƒ½è¾¾æ ‡ï¼š100%
â”œâ”€ CPU < 5%
â”œâ”€ å†…å­˜ < 100MB
â”œâ”€ å“åº” < 500ms
â””â”€ å¯ç”¨æ€§ 99.9%

æ–‡æ¡£å®Œæ•´åº¦ï¼š100%
â”œâ”€ ç”¨æˆ·æ–‡æ¡£å®Œæ•´
â”œâ”€ å¼€å‘è€…æ–‡æ¡£å®Œæ•´
â”œâ”€ API æ–‡æ¡£å®Œæ•´
â””â”€ è§†é¢‘æ•™ç¨‹ï¼ˆè®¡åˆ’ä¸­ï¼‰

ç”¨æˆ·æ»¡æ„åº¦ï¼š> 4.5/5
â”œâ”€ åŠŸèƒ½æ»¡æ„åº¦
â”œâ”€ æ˜“ç”¨æ€§æ»¡æ„åº¦
â”œâ”€ æ€§èƒ½æ»¡æ„åº¦
â””â”€ æ”¯æŒæ»¡æ„åº¦
```

### åç»­æ”¯æŒ

```
é•¿æœŸæ”¯æŒè®¡åˆ’ï¼š

1. æŒç»­ç»´æŠ¤
   â”œâ”€ æœˆåº¦æ›´æ–°
   â”œâ”€ å®‰å…¨è¡¥ä¸
   â”œâ”€ æ€§èƒ½ä¼˜åŒ–
   â””â”€ æ–°åŠŸèƒ½è¿­ä»£

2. ç”¨æˆ·æ”¯æŒ
   â”œâ”€ GitHub Issues
   â”œâ”€ ç¤¾åŒºè®ºå›
   â”œâ”€ Email æ”¯æŒ
   â””â”€ ä»˜è´¹å’¨è¯¢

3. ç”Ÿæ€å»ºè®¾
   â”œâ”€ æ’ä»¶å¸‚åœº
   â”œâ”€ æ‰©å±•å¼€å‘
   â”œâ”€ ç¤¾åŒºè´¡çŒ®
   â””â”€ å®˜æ–¹ç¤ºä¾‹

4. æŠ€æœ¯æ¼”è¿›
   â”œâ”€ æ–°æŠ€æœ¯é›†æˆ
   â”œâ”€ æ€§èƒ½çªç ´
   â”œâ”€ åŠŸèƒ½åˆ›æ–°
   â””â”€ è¡Œä¸šé¢†å…ˆ
```

---

## é™„å½•

### é™„å½• Aï¼šå¿«é€Ÿå¼€å§‹æŒ‡å—

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/LINYF510/obsidian-logger.git
cd obsidian-logger

# 2. å®‰è£…ä¾èµ–
cd global-logger
npm install

# 3. æ„å»ºæ’ä»¶
npm run build

# 4. å®‰è£…åˆ° Obsidianï¼ˆç¬¦å·é“¾æ¥ï¼‰
# Windowsï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
cd ../scripts
.\link-plugin.bat

# Linux/macOS
cd ../scripts
chmod +x link-plugin.sh
./link-plugin.sh /path/to/vault

# 5. åœ¨ Obsidian ä¸­å¯ç”¨
# è®¾ç½® â†’ ç¬¬ä¸‰æ–¹æ’ä»¶ â†’ å¯ç”¨ "Obsidian Logger"
```

### é™„å½• Bï¼šé…ç½® MCP Server

```json
// Cursoré…ç½®æ–‡ä»¶ï¼š~/.config/Cursor/User/settings.json
{
  "mcpServers": {
    "obsidian-logger": {
      "command": "python3",
      "args": ["/absolute/path/to/mcp_obsidian_logger.py"],
      "description": "Obsidian æ—¥å¿—æ”¶é›†å’Œ Auto-Reload ç®¡ç†æœåŠ¡",
      "transport": "stdio",
      "disabled": false
    }
  }
}
```

### é™„å½• Cï¼šå¸¸è§é—®é¢˜

**Q1: æ’ä»¶ä¸æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ï¼Ÿ**
- æ£€æŸ¥ manifest.json æ˜¯å¦å­˜åœ¨
- æ£€æŸ¥æ’ä»¶ç›®å½•åæ˜¯å¦æ­£ç¡®
- é‡å¯ Obsidian

**Q2: æ—¥å¿—æ–‡ä»¶ä¸æ›´æ–°ï¼Ÿ**
- æ£€æŸ¥æ’ä»¶æ˜¯å¦å¯ç”¨
- æ£€æŸ¥æ–‡ä»¶æƒé™
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯

**Q3: Auto-Reload ä¸å·¥ä½œï¼Ÿ**
- æ£€æŸ¥å¯åŠ¨æ—¥å¿—
- éªŒè¯æ’ä»¶åœ¨ç›‘æ§åˆ—è¡¨
- æ£€æŸ¥æ–‡ä»¶ç±»å‹é…ç½®

**Q4: è®¾ç½®é¡µé¢æ‰“ä¸å¼€ï¼Ÿ**
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯
- é‡æ–°ç¼–è¯‘æ’ä»¶
- æ¸…ç©ºé…ç½®é‡æ–°å¼€å§‹

### é™„å½• Dï¼šå¼€å‘å·¥ä½œæµæœ€ä½³å®è·µ

```
æ¨èå·¥ä½œæµï¼š

1. ä½¿ç”¨ç¬¦å·é“¾æ¥å®‰è£…
   â””â”€ ä¿®æ”¹å³ç”Ÿæ•ˆ

2. å¯åŠ¨ watch æ¨¡å¼
   â””â”€ npm run dev

3. é…ç½® Auto-Reload
   â””â”€ æ™ºèƒ½æ¨¡å¼æˆ–è‡ªåŠ¨æ¨¡å¼

4. å¼€å‘å’Œæµ‹è¯•
   â””â”€ ä¿®æ”¹ â†’ ä¿å­˜ â†’ è‡ªåŠ¨é‡è½½ â†’ éªŒè¯

5. æŸ¥çœ‹æ—¥å¿—
   â””â”€ åœ¨ Cursor ä¸­ä½¿ç”¨ MCP å·¥å…·

6. AI è¾…åŠ©è°ƒè¯•
   â””â”€ è®© AI åˆ†ææ—¥å¿—å¹¶æä¾›å»ºè®®

æ•ˆç‡æå‡ï¼š5-10å€ ğŸš€
```

### é™„å½• Eï¼šæ€§èƒ½ä¼˜åŒ–å»ºè®®

```
é’ˆå¯¹å¤§å‹é¡¹ç›®ï¼š

1. è°ƒæ•´ç¼“å†²åŒºå¤§å°
   â”œâ”€ é«˜é¢‘æ—¥å¿—ï¼šå¢å¤§åˆ°200
   â””â”€ ä½é¢‘æ—¥å¿—ï¼šä¿æŒ100

2. è°ƒæ•´æ£€æŸ¥é—´éš”
   â”œâ”€ å¿«é€Ÿå“åº”ï¼š500ms
   â””â”€ èŠ‚çœèµ„æºï¼š2000ms

3. ä½¿ç”¨æ’ä»¶ç‰¹å®šé…ç½®
   â”œâ”€ åªç›‘æ§å¿…è¦æ–‡ä»¶
   â””â”€ ä½¿ç”¨é€šé…ç¬¦å‡å°‘é…ç½®

4. å®šæœŸæ¸…ç†æ—¥å¿—
   â”œâ”€ æ‰‹åŠ¨æ¸…ç©º
   â””â”€ è°ƒæ•´ä¿ç•™å¤©æ•°
```

---

## è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç”¨æˆ·ï¼

ç‰¹åˆ«æ„Ÿè°¢ï¼š
- Obsidian å›¢é˜Ÿæä¾›ä¼˜ç§€çš„æ’ä»¶å¹³å°
- Anthropic å›¢é˜Ÿå¼€å‘ MCP åè®®
- Cursor å›¢é˜Ÿæä¾›å¼ºå¤§çš„ AI IDE
- ç¤¾åŒºç”¨æˆ·æä¾›å®è´µåé¦ˆå’Œå»ºè®®

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0 å®Œæ•´ç‰ˆ  
**æœ€åæ›´æ–°**: 2025-11-02  
**ç»´æŠ¤è€…**: LINYF510  
**æ–‡æ¡£è¡Œæ•°**: 3703 è¡Œ  
**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæ•´æ— ä¹±ç 

---

**é¡¹ç›®åœ°å€**: https://github.com/LINYF510/obsidian-logger  
**é—®é¢˜åé¦ˆ**: https://github.com/LINYF510/obsidian-logger/issues  
**æ–‡æ¡£è´¡çŒ®**: æ¬¢è¿æäº¤ PR æ”¹è¿›æ–‡æ¡£

---

**Â© 2025 LINYF510. All rights reserved.**  
**License**: MIT
