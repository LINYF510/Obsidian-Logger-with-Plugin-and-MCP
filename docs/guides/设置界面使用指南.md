# Obsidian Cursor Logger 设置界面使用指南

**更新日期**: 2025-11-02  
**版本**: v1.0

---

## 📖 快速开始

### 打开设置页面

1. 打开 Obsidian
2. 进入 **设置 → 第三方插件**
3. 找到 **Obsidian Cursor Logger**
4. 点击设置图标（齿轮）⚙️

---

## 📝 日志模块设置

### 日志文件路径

**功能**: 显示日志文件的保存位置

**操作**:
- 📋 **复制**: 点击复制按钮，路径会复制到剪贴板
- 📂 **打开**: 点击打开按钮，在文件管理器中打开日志目录

**路径说明**: 日志文件默认保存在 vault 外部的 `obsidian-logger` 目录，避免被 Obsidian 备份。

### 性能配置

**缓冲区大小**:
- 范围：1-1000 条
- 默认：100 条
- 说明：达到此数量时自动刷新到磁盘
- 建议：50-200 条

**刷新间隔**:
- 范围：100-5000 毫秒
- 默认：500 毫秒
- 说明：定时刷新日志到磁盘的间隔
- 建议：300-1000 毫秒

### 日志管理

**启用日志轮转**:
- 默认：开启
- 说明：文件超过指定大小时自动创建备份

**文件大小上限**:
- 范围：1-100 MB
- 默认：10 MB
- 说明：触发日志轮转的文件大小

### 快捷操作

- 📊 **查看统计**: 显示日志文件的统计信息
- 🗑️ **清空日志**: 清空日志文件（会先备份）
- 📂 **打开文件夹**: 在文件管理器中打开日志目录

---

## 🤖 Auto-Reload 模块设置

### 监控模式

**三种模式**：

#### 🧠 智能模式（推荐）
- **说明**: 自动识别开发中的插件
- **识别特征**:
  - 包含 source map
  - 最近被修改
  - 文件较大（未压缩）
- **适合**: 大多数开发场景

#### 🤖 自动模式
- **说明**: 监控所有已启用的插件
- **适合**: 同时开发多个插件

#### ✋ 手动模式
- **说明**: 用户手动选择要监控的插件
- **适合**: 精确控制，专业开发

### 智能模式配置

**智能识别阈值**:
- 范围：1-168 小时（7天）
- 默认：24 小时
- 说明：文件在此时间内被修改则认为是开发版本

**立即重新识别**:
- 点击按钮手动触发智能识别
- 更新监控列表

### 手动模式配置

**插件列表**:
- 显示所有已启用的插件
- 勾选要监控的插件
- 实时更新监控列表

**快捷操作**:
- ✓ **全选已启用**: 勾选所有插件
- ✗ **清空全部**: 取消所有勾选
- 🧠 **智能识别**: 使用智能算法自动勾选

### 监控文件类型设置 ⭐

**配置模式**:

#### 全局配置（默认）
- 所有插件使用相同的文件类型设置
- 简单易用

**配置项**:
- ✓ **main.js**: 必选，不可取消
- ☑ **manifest.json**: 插件配置文件
- ☑ **styles.css**: 插件样式文件
- 📝 **自定义文件**: 支持通配符

**自定义文件示例**:
```
data.json
lang/en.json
lang/*.json
config/*.yaml
```

**通配符说明**:
- `*` 匹配任意字符
- `*.json` 匹配所有 JSON 文件
- `lang/*.json` 匹配 lang 目录下的所有 JSON 文件

#### 插件特定配置
- 为每个监控的插件单独设置文件类型
- 覆盖全局配置
- 适合特殊需求

**使用方法**:
1. 切换到"插件特定配置"模式
2. 为每个插件启用"使用特定配置"
3. 单独设置要监听的文件类型

### 重载配置

**检查间隔**:
- 范围：100-10000 毫秒
- 默认：1000 毫秒
- 说明：扫描插件文件变化的时间间隔
- 建议：500-2000 毫秒

**显示重载通知**:
- 默认：开启
- 说明：插件重载时显示 Obsidian 通知

**显示启动通知**:
- 默认：开启
- 说明：Auto-Reload 启动时在控制台显示详细信息

---

## 📊 运行状态

### 日志模块状态

实时显示：
- ✅ 运行状态
- 📁 文件大小和行数
- 🔴 错误/警告/调试数量
- ⏱️ 最后更新时间

### Auto-Reload 模块状态

实时显示：
- ✅ 运行状态
- 🧠 当前监控模式
- 📊 监控插件数量
- ⏱️ 检查间隔
- 📋 监控插件列表
- 📈 今日统计（重载次数、成功率、平均耗时）

---

## 🔧 高级选项

### 开发者工具
- 🔍 **打开控制台**: 打开 Obsidian 开发者控制台查看详细日志

### 恢复默认设置
- 🔄 **恢复默认**: 将所有配置恢复为默认值
- ⚠️ **警告**: 需要确认，会清除所有自定义配置

---

## 💡 使用技巧

### 技巧 1：为不同项目使用不同配置

如果同时开发多个插件，它们可能需要监控不同的文件：

```
my-plugin（数据驱动）:
  ✓ main.js
  ✓ manifest.json
  ✗ styles.css
  自定义：data.json, lang/*.json

another-plugin（UI 插件）:
  ✓ main.js
  ✗ manifest.json
  ✓ styles.css
  自定义：icons/*.svg
```

**操作**:
1. 切换到"插件特定配置"模式
2. 为每个插件启用特定配置
3. 单独设置文件类型

### 技巧 2：使用通配符监控目录

如果插件有多个配置文件在同一目录：

```
自定义文件：
lang/*.json      → 监控所有语言文件
config/*.yaml    → 监控所有配置文件
data/*.json      → 监控所有数据文件
```

### 技巧 3：临时调整检查间隔

开发时如果觉得重载太频繁或太慢：

- **太频繁**: 增加检查间隔（1000ms → 2000ms）
- **太慢**: 减少检查间隔（1000ms → 500ms）

### 技巧 4：关闭重载通知

如果觉得通知打扰：

- 取消"显示重载通知"
- 日志仍会记录，只是不显示弹窗

---

## 🐛 故障排查

### 问题：设置不生效

**症状**: 修改设置后没有变化

**解决方案**:
1. 检查配置是否保存（应该自动保存）
2. 尝试刷新监控列表（命令面板）
3. 重新加载插件

### 问题：自定义文件不工作

**症状**: 修改自定义文件后不触发重载

**检查清单**:
- [ ] 文件名是否正确（区分大小写）
- [ ] 通配符语法是否正确
- [ ] 文件是否在插件目录下
- [ ] 监控列表是否包含该插件

**测试方法**:
```
在控制台执行：
const plugin = app.plugins.plugins['obsidian-cursor-logger'];
const config = plugin.settings.autoReload.globalWatchedFiles;
console.log('监控文件:', config);
```

### 问题：通配符不匹配

**症状**: 使用通配符但文件变化未检测

**常见错误**:
- ❌ `*json` （缺少点）→ 应该是 `*.json`
- ❌ `lang/*` （不包含扩展名）→ 应该是 `lang/*.json`

**测试匹配**:
```
在控制台执行：
const { matchPattern } = await import('./shared/utils');
console.log(matchPattern('lang/en.json', 'lang/*.json'));  // 应该返回 true
```

---

## ✅ 验收清单

- [ ] 可以打开设置页面
- [ ] 所有配置项都能修改
- [ ] 修改立即保存
- [ ] 模式切换正常
- [ ] 插件列表显示正确
- [ ] 文件类型配置生效
- [ ] 自定义文件工作
- [ ] 通配符匹配正确
- [ ] 状态实时更新
- [ ] 统计信息准确

---

**维护者**: LINYF510  
**最后更新**: 2025-11-02

